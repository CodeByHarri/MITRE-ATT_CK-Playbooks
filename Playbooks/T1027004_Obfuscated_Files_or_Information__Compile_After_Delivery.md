# Obfuscated_Files_or_Information:_Compile_After_Delivery - T1027004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1027.004 |
| MITRE Sub-TTP | T1027.004 |
| Name | Obfuscated Files or Information: Compile After Delivery |
| Log Sources to Investigate | ['Endpoint Detection and Response (EDR) solutions to monitor file creations and modifications for unusual file types like source code files (e.g., .cs, .cpp) being compiled.', 'Windows Event Logs, particularly for process creation events (Event ID 4688) involving compilers such as ilasm.exe, csc.exe, or gcc.exe.', 'File integrity monitoring systems to detect changes to source code files or suspicious recompilation activity.', 'Network traffic logs or web proxy logs if the delivery of suspicious source code is occurring via emails or downloaded from suspicious domains.', 'Antivirus/anti-malware logs for alerts on attempts to execute compiled files that were flagged as suspicious or malicious.'] |
| Key Indicators | ['Presence of uncompiled source code delivered to user directories, especially in uncommon paths.', 'Execution of compilers like ilasm.exe, csc.exe, or GCC/MinGW unexpectedly.', 'Unrecognized executable binary generation shortly after the receipt of source code files.', 'Unusual encoding or encryption patterns within files received via email or downloads.', 'Files with misleading extensions or formats not native to the operating system receiving them.'] |
| Questions for Analysis | ['Is there an alert of a compiler process (ilasm.exe, csc.exe, or gcc.exe) executing on a user system unexpectedly?', 'Does the delivery method of the uncompiled code align with known phishing campaigns?', 'Has there been a recent influx of files with extensions like .cs, .cpp, or other source code formats?', 'Are files being compiled from uncommon or suspicious directories?'] |
| Decision for Escalation | ['Escalate to Tier 2 if the source code execution is confirmed without a legitimate user operation.', 'Escalate if there are multiple indicators of compromise (IOCs) suggesting the presence of compiled malicious payloads.', 'Escalate if network logs indicate communication with known Command and Control (C2) infrastructure following the compilation.'] |
| Additional Analysis Steps for L1 | ['Verify the legitimacy of the source files delivered. Check the hash values against known threat databases.', 'Correlate the source code delivery with any active email phishing alerts, focusing on links or attachments.', 'Check the timing of file compilation relative to the initial delivery to ascertain if automated scripting is involved.'] |
| T2 Analyst Actions | ['Conduct a deeper forensic examination of affected systems to trace back the origin of source code files.', 'Analyze compiled binaries for malicious signatures or behaviors using sandbox environments.', 'Investigate any relationships between the source code and suspicious communications or data exfiltration attempts.'] |
| Containment and Further Analysis | ['Isolate the affected host systems to prevent further spread or exfiltration of data.', 'Revoke or reset access credentials used on the compromised systems.', 'Perform a thorough security audit of email gateways and web proxies to identify potential vectors for future similar attacks.', 'Work with development and IT teams to ensure legitimate source code files are secured and adequately monitored.'] |
