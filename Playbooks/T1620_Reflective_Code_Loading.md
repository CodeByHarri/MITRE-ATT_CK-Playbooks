# Reflective_Code_Loading - T1620

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1620 |
| MITRE Sub-TTP | T1620 |
| Name | Reflective Code Loading |
| Log Sources to Investigate | To investigate the Reflective Code Loading technique (T1620), focus on logs that can provide visibility into in-memory code execution and unexpected process behaviors. Key log sources include:<br>1. **Process Monitoring Logs**: Provides details on process creation and termination. Look for processes executing without corresponding file paths.<br>2. **PowerShell Logs (Event ID 4104)**: Capture script block logs that can indicate potential abuse of methods like Assembly.Load().<br>3. **Memory Inspection Tools**: Such as Volatility or Memoryze, to identify anomalous in-memory objects and handles.<br>4. **ETW (Event Tracing for Windows)**: Monitor module loads and in-memory execution using providers focused on the .NET runtime or libraries like ntdll.dll.<br>5. **EDR Solutions**: Use Endpoint Detection and Response tools to detect anomalous behavior or unrecognized loaded modules in processes.<br>6. **Network Traffic Logs**: Identify unusual network activity that might indicate payload retrieval or C2 communication related to reflective code execution. |
| Key Indicators | 1. **Anomalous Process Execution**: Processes executing without associated disk artifacts or with unexpected command line arguments.<br>2. **PowerShell Abnormal Usage**: Use of Assembly.Load() or other reflective methods without typical PowerShell activity.<br>3. **Memory Artifacts**: Unexplained in-memory modules or codes detected via memory analysis tools.<br>4. **Network Abnormalities**: Suspicious outbound connections, potentially for C2 communications.<br>5. **Unrecognized Code Loads**: Presence of unrecognized or unexpectedly unsigned code modules in legitimate processes. |
| Questions for Analysis | 1. Does the detected activity align with known legitimate use cases for reflective loading within the environment?<br>2. Are there corresponding artifacts or file indicators on disk?<br>3. Is there a deviation from typical process execution patterns or monitored baseline behaviors?<br>4. Does the network traffic correspond with known malicious patterns or established baselines?<br>5. Is the use of functions like Assembly.Load() in PowerShell consistent with typical usage by administrators? |
| Decision for Escalation | Escalate to Tier 2 if:<br>1. Reflective code loading activity is detected in sensitive or high-risk processes.<br>2. Anomalous memory patterns are observed in critical systems.<br>3. There's evidence of malicious intent, such as outbound connections to suspicious domains/IPs.<br>4. Unable to justify the activity with legitimate use cases after initial analysis.<br>5. Involvement of processes that handle sensitive data or infrastructure components. |
| Additional Analysis Steps for L1 | 1. Validate the legitimacy of the process by correlating with installed software or admin activities.<br>2. Use process creation logs to trace the origin of the suspicious activity.<br>3. Analyze existing PowerShell logs to understand the context of script execution.<br>4. Conduct initial memory snapshot analysis if tools like Volatility are accessible.<br>5. Review network logs for any concurrent suspicious activities. |
| T2 Analyst Actions | 1. Perform deeper memory analysis to confirm the presence of reflective code.<br>2. Cross-reference suspicious activities with threat intelligence feeds for known indicators.<br>3. Analyze the source and destination of any associated network traffic for patterns.<br>4. Review historical data for repeated instances or patterns of the behavior.<br>5. Collaborate with IT teams to correlate any changes in software distribution or patch management. |
| Containment and Further Analysis | 1. Isolate affected systems to prevent further compromise or data exfiltration.<br>2. Engage with IT to conduct further forensic imaging and detailed memory analysis.<br>3. Identify and remediate the source of the code or method used for reflective loading.<br>4. Implement enhanced monitoring for similar activities across the organization.<br>5. Update threat detection rules in EDR or SIEM to better capture future attempts. |
