# System_Service_Discovery - T1007

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1007 |
| MITRE Sub-TTP | T1007 |
| Name | System Service Discovery |
| Log Sources to Investigate | Examine logs from endpoint detection and response (EDR) tools for command line arguments, specifically focusing on commands like 'sc query', 'tasklist /svc', 'systemctl --type=service', and 'net start'. Review Windows Event Logs, particularly Security and System logs (Event IDs 4688 for process creation and 7045 for new service installation). On Linux systems, analyze Syslog, especially for suspicious service-related activities. Utilize network traffic logs to detect anomalous outbound connections that may occur post-discovery. |
| Key Indicators | Look for execution of service discovery commands ('sc query', 'tasklist /svc', 'systemctl --type=service', 'net start'). Unusual execution times for these commands (e.g., outside business hours) or from unexpected users/systems may indicate suspicious activity. Detect unusual volumes of service-related queries that deviate from the baseline. Identify commands executed with elevated privileges in an unauthorized manner. |
| Questions for Analysis | Did the commands for service discovery originate from a known application or user? Are these commands consistent with expected user activity and business hours? Is there a corresponding alert indicating lateral movement or further compromise (e.g., new services installed following the discovery phase)? Are there any anomalies in the network traffic related to the machine executing these commands? |
| Decision for Escalation | Escalate to Tier 2 if the source of the commands cannot be immediately attributed to legitimate business operations. Escalate if combined with other suspicious activities, such as the creation of new services or unusual network connections. Also, escalate if the activity originates from critical assets or involves sensitive accounts. |
| Additional Analysis Steps for L1 | Correlate the identified activities with any recent changes or maintenance activities. Review user activity logs for any context around the execution of these commands. Verify the accounts and associated roles involved in issuing these commands. Check for any recent access or login attempts that could indicate unauthorized access. |
| T2 Analyst Actions | Investigate further by examining the timeline of events leading up to and following the discovery commands. Use advanced threat intelligence tools to cross-reference IOCs with known malicious patterns. Conduct memory analysis if necessary to identify memory-resident malware. Review recent vulnerability scans and patch histories on impacted systems. |
| Containment and Further Analysis | Apply immediate containment by isolating impacted systems from the network if compromise is suspected. Consider disabling accounts involved in executing the suspicious commands until investigation concludes. Conduct a comprehensive review of installed services to ensure that no unauthorized services have been established. Monitor the system for further access attempts or outbound traffic indicative of data exfiltration. |
