# Masquerading:_Masquerade_File_Type - T1036008

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1036.008 |
| MITRE Sub-TTP | T1036.008 |
| Name | Masquerading: Masquerade File Type |
| Log Sources to Investigate | File access logs, particularly where files are transferred to or from the network. Security information and event management (SIEM) logs can be invaluable, especially those capturing file creation and modification events on user endpoints or servers. Antivirus and endpoint detection and response (EDR) logs are crucial, especially for alerts indicating unusual file behavior. Cloud storage access logs, if applicable, should be examined for abnormal file activity. Examples include Windows Event Logs (File System), network traffic logs showing file transfers (e.g., FTP, HTTP requests), and any application logs showing file handling operations. |
| Key Indicators | Files with extensions typically associated with non-executable types (such as .txt, .jpg, .gif), but which are involved in activities typically linked to executables (such as being loaded as DLLs or executed as scripts). Changes to file signatures that do not match the listed extension. Polyglot file usage, where files are identified behaving differently depending on access context or execution environment. Files downloaded from unusual or untrusted sources with suspicious file formats. |
| Questions for Analysis | Is the file extension consistent with legitimate software and content used within the organization? Has there been a recent increase in file extension agreement failures in logs? Are there any known vulnerabilities associated with the file type being masqueraded? Has the file been transferred from a known or repeated suspicious source? |
| Decision for Escalation | Escalate to Tier 2 if the file signature does not match the file extension and if the file has been executed or involved in any active process indicative of system changes. Escalation is also necessary if similar activity has been observed across multiple user endpoints or network locations, indicating a potential widespread tactic. |
| Additional Analysis Steps for L1 | Verify file hashes against known malware databases. Check recent network activity to identify sources and destinations associated with the suspicious file. Investigate recent access logs for any anomalous behavior such as unusual access times, locations, or file modifications. Review antivirus logs for any alerts related to the flagged file. |
| T2 Analyst Actions | Conduct deeper inspection of the flagged file using static and dynamic analysis tools to understand its behavior. Correlate the activities with other security alerts to determine if this file is part of a larger attack. Analyze network flows to identify any secondary payloads or commands issued by the suspicious file. |
| Containment and Further Analysis | Isolate the affected endpoint(s) to prevent further spread of potential malware. Block file hash or signature across security tools to prevent execution. Engage digital forensics to conduct a comprehensive analysis of the file to determine its origin and capabilities. Consider leveraging a sandbox environment to observe the file's behavior in a controlled setting for additional insights. |
