# Boot_or_Logon_Autostart_Execution:_Authentication_Package - T1547002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1547.002 |
| MITRE Sub-TTP | T1547.002 |
| Name | Boot or Logon Autostart Execution: Authentication Package |
| Log Sources to Investigate | Investigate Windows Security Event Logs, particularly events related to the loading of authentication packages (e.g., Event ID 4611 - LSA was loaded). Monitor changes in the registry related to LSA authentication packages using Sysmon with Event IDs 12 (Registry object added or changed) or 13 (Registry object deleted). Utilize Windows Registry Access logs to detect modifications in the HKLM\SYSTEM\CurrentControlSet\Control\Lsa path. Also, monitor application and system logs for unusual DLL executions at boot or logon time. |
| Key Indicators | Presence of unusual or non-standard DLLs referenced in the HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Authentication Packages registry key. Unexpected modifications to the LSA registry keys, especially outside of normal administrative or system maintenance times. Unrecognized DLL loading events during system boot, specifically tied to LSA processes. |
| Questions for Analysis | 1. Does the DLL referenced in the Authentication Packages registry key match known, legitimate entries for your enterprise environment?<br>2. Are there any recent changes in system configurations or updates that might explain the registry modification?<br>3. Has this DLL been executed recently, and if so, what process is responsible? 4. Are there any related suspicious activities in the same timeframe, such as unauthorized user accounts or failed logon attempts? |
| Decision for Escalation | Escalate to Tier 2 if the DLL in question is not recognized or appears suspicious (i.e., not digitally signed or known to be malicious). Escalate if there are corroborating indicators of compromise such as unusual user account activity or related malware detections. Also, escalate if there is a lack of reasonable explanation for the registry changes following preliminary checks. |
| Additional Analysis Steps for L1 | Verify the hash of the DLL against threat intelligence sources and known file reputation services like VirusTotal. Check the file path and ownership of the DLL for anomalies. Analyze user account activities related to the time the DLL was executed. Document all findings and attempt to correlate any other system events that suggest malicious behavior. |
| T2 Analyst Actions | Perform deeper static and dynamic analysis on the DLL if deemed suspicious. Examine other systems within the same network segment for similar registry or file modifications. Utilize advanced threat detection tools to search for patterns or signatures of known threats associated with the DLL or similar techniques. Engage Incident Response (IR) team if a broader compromise is detected. |
| Containment and Further Analysis | Remove suspicious or malicious DLLs from the registry key and ensure known, good configurations are restored. Isolate affected systems to prevent further execution and spread of potentially malicious code. Conduct a full malware scan on the affected system, and analyze captured network traffic for lateral movement indicators. Consider implementing additional monitoring to detect future unauthorized changes to critical registry keys and processes. |
