# Inhibit_System_Recovery - T1490

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Impact |
| MITRE TTP | T1490 |
| MITRE Sub-TTP | T1490 |
| Name | Inhibit System Recovery |
| Log Sources to Investigate | To investigate the T1490 - Inhibit System Recovery activity, the following log sources should be analyzed: <br><br>1. **Windows Event Logs**: Check for events associated with the execution of utilities like vssadmin.exe, wbadmin.exe, and bcdedit.exe. Look for specific event IDs related to execution and privilege escalation.<br>   - Security logs for command execution with elevated privileges (Event ID 4688).<br>   - Application logs for errors that may indicate failed recovery service attempts.<br><br>2. **File Access Logs**: Analyze access and modification logs in system directories where recovery tools and backup files are stored.<br><br>3. **PowerShell Logs**: Any suspicious PowerShell activity, especially those targeting system recovery settings or snapshot deletions.<br>   - Look for event codes 4103 and 4104 for executed scripts.<br><br>4. **System Configuration and Boot Logs**: Check configurations related to boot and recovery processes, focusing on logs from bcdeedit activities.<br><br>5. **Cloud environments**: Monitor cloud audit logs for changes in snapshot configurations, deletion of backups, or altered versioning policies. |
| Key Indicators | Key indicators for T1490 include:<br><br>1. Execution of system modification commands such as 'vssadmin delete shadows /all /quiet', 'wbadmin delete catalog -quiet', or 'bcdedit /set recoveryenabled no'.<br>2. Unexplained deletion of recovery points or restoration settings on both endpoints and network devices.<br>3. Deactivation of Windows Recovery Environment using 'REAgentC.exe'.<br>4. Unexpected removal of online backups or cloud storage snapshots.<br>5. Abnormal access to backup directories by non-administrative users or service accounts. |
| Questions for Analysis | 1. Has there been recent use of administrative tools like vssadmin, wbadmin, or diskshadow that coincide with unexpected system behavior?<br>2. Were these commands executed by a legitimate administrator or through suspicious accounts?<br>3. Is there a pattern of access to backup directories or recovery policies by unfamiliar processes or scripts?<br>4. Are there any corresponding alerts from other security controls indicating compromise?<br>5. Has there been unauthorized account access in cloud services where recovery and backup data are housed? |
| Decision for Escalation | Escalate to Tier 2 if:<br><br>1. Commands related to system recovery inhibition (e.g., vssadmin, diskshadow) were executed without known change request or administrator context.<br>2. There is concurrent suspicious activity, such as lateral movement or privilege escalation signals, along with recovery-inhibit attempts.<br>3. Evidence of widespread impact, such as multiple hosts affected, or significant alterations in cloud backup configurations.<br>4. Any attempt identified in the deletion or disabling of critical recovery features without plausible explanation. |
| Additional Analysis Steps for L1 | 1. Correlate suspect command execution logs with user activity and times to understand context.<br>2. Verify whether the commands executed match against any scheduled or planned maintenance.<br>3. Review logs for any previous signs of compromise or unauthorized access consistent with TTPs<br>4. Check for any alerts or indicators from other systems or tools that may provide corroborating data. |
| T2 Analyst Actions | 1. Conduct a detailed forensic analysis of affected systems, looking for remnants of tools/scripts used to alter or delete recovery settings.<br>2. Analyze network traffic for indications of data exfiltration or communication with C2 servers contemporaneous with the identified activities.<br>3. Review and correlate identity and access management logs to validate access credentials.<br>4. Engage with cloud security tools to check for unauthorized modifications or deletions of backup policies and versions. |
| Containment and Further Analysis | 1. Isolate affected systems to prevent further damage or spread of malicious activity.<br>2. Restore from known good backups if recovery features were disabled or destroyed.<br>3. Reinforce endpoint recovery settings and permissions to prevent unauthorized alterations.<br>4. Implement additional monitoring rules for tools and commands used in system recovery inhibition.<br>5. Work with relevant cloud service providers to ensure that backup and recovery data are securely configured and validated. |
