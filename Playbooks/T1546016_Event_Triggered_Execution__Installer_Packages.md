# Event_Triggered_Execution:_Installer_Packages - T1546016

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1546.016 |
| MITRE Sub-TTP | T1546.016 |
| Name | Event Triggered Execution: Installer Packages |
| Log Sources to Investigate | To investigate T1546.016, examine the following log sources: <br>1. Application Installation Logs: Check macOS 'install.log' or 'system.log' for installation activities and script executions, and Windows Event Log (specifically MSI logs) for installer events.<br>2. Script Execution Logs: Monitor macOS Unified Logs or Linux 'auth.log' and 'syslog' for suspicious script execution events.<br>3. File Integrity Monitoring Logs: Use FIM solutions to track changes to known installer directories or script files, such as '/var/lib/dpkg/info/' on Linux.<br>4. Process Creation Logs: Security Event logs (4624, 4688) for tracking new process creations that correlate with installer executions.<br>5. Endpoint Detection and Response (EDR): Assess telemetry for abnormal processes or behaviors linked with installer executions.<br>Example log entries might include references to '.msi', 'preinst', 'postinst', 'prerm', 'postrm', or 'postinstall'. |
| Key Indicators | Key indicators for this TTP include:<br>1. Unexpected script executions following the installation of an application, especially those requiring elevated privileges.<br>2. Unusual modifications to installation scripts or packaged resources that are not consistent with their legitimate purpose.<br>3. Execution of known malicious binaries or components (e.g., Launch Daemon) post-installation.<br>4. Anomalous behavior detected by EDR related to installer script execution.<br>5. Abnormal network activity originating from processes related to installer scripts. |
| Questions for Analysis | 1. Was the installer sourced from a legitimate or trusted provider?<br>2. Do the scripts executed during or after installation match expected legitimate behaviors?<br>3. Are there elevated privilege requirements that seem unnecessary for the application being installed?<br>4. Has similar behavior been detected on other systems, suggesting a widespread issue?<br>5. Are there any known vulnerabilities or exploits related to the installer package being analyzed? |
| Decision for Escalation | Escalate to Tier 2 if:<br>1. The source of the installer cannot be verified.<br>2. Scripts executed during the installation perform unauthorized or unexpected actions.<br>3. Elevated privileges were used without a clear legitimate justification.<br>4. EDR or network logs suggest potential lateral movement or data exfiltration linked to the installation event. |
| Additional Analysis Steps for L1 | 1. Verify the hashes and signatures of the installer package if possible.<br>2. Compare the observed installer activity against documented legitimate installation procedures.<br>3. Conduct a brief review of network activity during the installation process.<br>4. Check for any known false positives associated with the event signature or indicators. |
| T2 Analyst Actions | 1. Perform a detailed behavioral analysis of the installer script execution using a sandbox or virtual environment.<br>2. Review related artifacts to identify any secondary payloads or indicators of compromise (IOCs) that might suggest a broader issue.<br>3. Collaborate with threat intelligence resources to validate if the behavior matches known attacks or threat actor TTPs.<br>4. Confirm whether any persistence mechanisms (e.g., Launch Daemon) were established, and determine the necessary remediation steps. |
| Containment and Further Analysis | 1. Isolate affected systems from the network immediately.<br>2. Conduct a thorough examination of the system for additional indicators or secondary infections.<br>3. Remove or quarantine any identified malicious executables or scripts.<br>4. Revoke granted elevated privileges and reset accounts if compromised.<br>5. Review, update, and apply appropriate security patches to systems to prevent exploitation.<br>6. Engage with incident response teams to assess any further potential infiltrations or exploitations related to this event. |
