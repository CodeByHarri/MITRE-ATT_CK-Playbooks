# System_Network_Configuration_Discovery - T1016

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1016 |
| MITRE Sub-TTP | T1016 |
| Name | System Network Configuration Discovery |
| Log Sources to Investigate | 1. Network Flow Logs: Capture network traffic details such as IP addresses, MAC addresses, and interface usage. Examples include Cisco NetFlow, AWS VPC Flow Logs, or Azure Network Watcher.<br>2. Endpoint Logs: Collect logs from endpoint security solutions that monitor system processes and command line activities. Examples include Sysmon logs on Windows and audit logs on Linux.<br>3. Network Device Logs: Examine configuration and access logs from routers, switches, and other network devices, such as Cisco ASA or Palo Alto network logs.<br>4. SIEM Alerts: Monitor alerts from Security Information and Event Management systems, like Splunk or IBM QRadar, that detect network discovery attempts. |
| Key Indicators | 1. Execution of network configuration commands such as 'ipconfig', 'ifconfig', 'arp', 'nbtstat', and 'route' on an endpoint.<br>2. Unusual access to network device CLIs with commands like 'show ip route' or 'show ip interface'.<br>3. Network traffic spikes to endpoint our routers that align with typical discovery times (off-hours).<br>4. Scripts or binaries executed from uncommon user paths or by unexpected users to perform network discovery. |
| Questions for Analysis | 1. Was the network configuration command executed by a legitimate and authorized user?<br>2. Does the timing of these activities align with typical user behavior and working hours?<br>3. Is there a pattern of failed login attempts or unusual access to network devices prior to or after these activities?<br>4. Was the use of these commands part of a sanctioned IT maintenance or auditing task? |
| Decision for Escalation | Escalate to Tier 2 if the activities involve execution of commands by unauthorized users, occur during unusual hours without a known maintenance window, or if correlated with suspicious access attempts to network devices. Additionally, escalate if there are signs of lateral movement or mapping of network topology over time. |
| Additional Analysis Steps for L1 | 1. Verify user permissions and Active Directory group memberships to confirm authorization for the observed actions.<br>2. Correlate observed IPs/hosts with known assets in the organization and check for known suspicious activity associated with them.<br>3. Review baseline network and system activity logs to confirm if similar behaviors have occurred naturally in the past. |
| T2 Analyst Actions | 1. Conduct a deeper investigation into the user accounts and devices involved using advanced threat hunting tools.<br>2. Analyze historical logs to identify any additional command executions or suspicious network communications linked to the activity.<br>3. Engage in threat intelligence gathering to determine if the indicators align with any known threat actor TTPs. |
| Containment and Further Analysis | 1. Temporarily restrict or monitor the accounts involved in the suspicious activity to prevent further discovery actions.<br>2. Enhance monitoring on impacted network devices and endpoints to capture all future discovery attempts.<br>3. Conduct a full review of current network device configurations and enforce stricter CLI access controls.<br>4. Collaborate with the IT and network teams to conduct a detailed review of network segmentation and access controls. |
