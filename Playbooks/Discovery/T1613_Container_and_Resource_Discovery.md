# Container_and_Resource_Discovery - T1613

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1613 |
| MITRE Sub-TTP | T1613 |
| Name | Container and Resource Discovery |
| Log Sources to Investigate | Investigate Docker and Kubernetes logs, as they may contain commands and API calls used for container and resource discovery. Review access logs of Kubernetes dashboards and management interfaces to identify unauthorized access or unusual patterns. Specifically, look into kube-apiserver logs, pod logs, and any service logs that show API requests or access to the dashboard. Network traffic logs and packet captures may also reveal anomalies related to unauthorized exploration of the container environment. |
| Key Indicators | Unfamiliar or unauthorized API requests to Kubernetes or Docker, particularly those related to LIST, GET, or DESCRIBE functionalities. Unusual user-agent strings querying Kubernetes APIs. Attempted access to Kubernetes dashboard from atypical IP addresses. Multiple failed attempts to access Kubernetes or Docker APIs or related dashboard interfaces within a short period. Sudden spikes in resource commands, such as kubectl get pods or kubectl get nodes. |
| Questions for Analysis | Does the activity originate from a known, authorized user or service account? Are the API requests consistent with the user's role and regular behavior? Is the access time or source IP address anomalous relative to normal traffic patterns? Are there accounts with elevated privileges being used unexpectedly? Is there simultaneous activity from the user's credentials across different locations or devices? |
| Decision for Escalation | Escalate to Tier 2 if the API calls or access requests originate from unusual IPs, especially if associated with known threat actors or geolocation anomalies. Escalate if there is evidence of attempts to access privileged nodes or if discovery attempts are followed by data exfiltration activities or lateral movement behaviors. Also escalate if the account in question has a history of misuse or anomalous behaviors. |
| Additional Analysis Steps for L1 | Correlate identity information with the attempted actions, ensuring known and legitimate credentials are used. Assess the volume and frequency of container discovery-related activities logged. Check for any existing security alerts related to the API calls identified. Review historical access patterns for the account in question to identify deviations. |
| T2 Analyst Actions | Validate if there are existing vulnerabilities or misconfigurations that may have allowed unauthorized access. Examine detailed logs for context around anomalous actions identified, looking at timestamp correlations and related activities. Conduct deeper packet analysis if network traffic logs suggest unauthorized data transmissions. Verify if similar patterns are observed in other parts of the container environment. |
| Containment and Further Analysis | Restrict access to Kubernetes dashboard and Docker APIs to known, trusted IPs and enforce multi-factor authentication for sensitive access points. Regularly update and apply security patches to container management tools to mitigate exploits. Enhance logging and monitoring capabilities for better anomaly detection, including real-time alerting for suspicious activity. Investigate any breaches with a focus on identifying potential data loss or shifts in privilege escalation techniques. |
