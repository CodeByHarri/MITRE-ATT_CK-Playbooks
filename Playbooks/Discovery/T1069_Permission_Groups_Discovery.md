# Permission_Groups_Discovery - T1069

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1069 |
| MITRE Sub-TTP | T1069 |
| Name | Permission Groups Discovery |
| Log Sources to Investigate | Monitor Windows Security Event Logs (Event ID 4798: A user's local group membership was enumerated). Collect logs from PowerShell (script execution logs and module logging). Check Active Directory logs for unusual read access on directory ACLs and user group memberships. Use Sysmon to capture process creation and command line logs for suspicious queries. If applicable, examine Linux system logs for commands like `getent`, `id`, or `groups`. Network traffic can also be analyzed for unusual LDAP queries or SMB connections. |
| Key Indicators | Frequent or unusual enumeration of Active Directory group memberships. Execution of scripts or commands related to group querying (e.g., Get-ADGroupMember in PowerShell). Unrecognized users or accounts performing LDAP queries or SMB sessions. Execution of known tools used for group discovery like BloodHound or PowerView. Scheduled tasks or services querying permissions outside of regular administrative patterns. |
| Questions for Analysis | Is the account performing the queries a known administrative or service account? Are the queries being performed during unusual hours or in a different context than usual for the user? Is there any evidence that these queries are linked to legitimate administrative actions such as audit or roster checks? Does the account have a history of similar behavior? Are there concurrent signs of compromise such as failed logins or suspicious process activity linked to the account? |
| Decision for Escalation | Escalate if the account querying permission groups is not recognized as an administrative account, especially if combined with other signs of potential compromise (e.g., geographic login anomalies, concurrent suspicious activity). Escalate if the enumeration is being performed with unexpected scripts or tools not typically used in the environment or outside normal administrative hours. |
| Additional Analysis Steps for L1 | Verify the identity and typical access patterns of the account executing the queries. Check recent changes in user account permissions or additions to privileged groups. Review related logs for signs of lateral movement or credential theft. Document the context of the query activity (tools, times, associated events). |
| T2 Analyst Actions | Conduct a deeper review of the account activity across multiple systems and times to identify any unauthorized access patterns. Verify system integrity and cross-reference with threat intelligence for related TTPs or known malicious identifiers (e.g., IPs, tools). Investigate any detected anomalies with group management or unauthorized permission grants. If linked to specific tools, check for any malicious payloads or additional scripts that might have been executed. |
| Containment and Further Analysis | Disable accounts performing unauthorized group enumeration if misuse is confirmed. Change passwords and invalidate tokens for compromised accounts. Monitor and audit group membership changes across the environment. Utilize EDR solutions to scan for persistent threats or additional payloads. Conduct a network-wide search for known indicators of compromise (IOCs) associated with the tools used. Strengthen monitoring of privileged accounts and regularly audit AD permissions. |
