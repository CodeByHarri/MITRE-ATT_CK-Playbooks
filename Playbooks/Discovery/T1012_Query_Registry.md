# Query_Registry - T1012

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1012 |
| MITRE Sub-TTP | T1012 |
| Name | Query Registry |
| Log Sources to Investigate | Monitor Windows Event Logs, particularly: PowerShell logs (Event ID 4104 for script block logging), Sysmon logs for registry queries (Event ID 13 for RegistryEvent registry query events), Security logs for unusual access patterns, and Process Creation logs (Event ID 4688) to identify processes accessing the registry using reg.exe or other utilities. Additional logs: Antivirus/EDR logs for alerts related to suspicious registry access, and network logs for anomalies indicating data exfiltration. |
| Key Indicators | Unusual querying of the registry, especially against sensitive keys such as those revealing installed software paths or system configurations. Repeated or automated queries within a short time frame. Querying of registry locations containing security product configurations. Use of the reg.exe utility or any custom scripts/binary aimed directly at registry exploration. |
| Questions for Analysis | Is there a legitimate business reason for the observed registry queries? Are the queries performed by a known and trusted application or user? Is there evidence of elevated privileges used for the registry query? Are there associated alerts or anomalies that coincide with registry access, such as unauthorized network connections, process anomalies, or alerted indicators of compromise? |
| Decision for Escalation | Escalate to Tier 2 if repeated unexplained registry queries are observed, the source or application performing the query is unusual or unauthorized, the queries are directed toward sensitive registry keys associated with security software settings, or there are coinciding indicators of other suspicious activities (e.g., abnormal network traffic or process execution). |
| Additional Analysis Steps for L1 | Verify the identity and privileges of the user or service querying the registry. Check for accompanying alerts or anomalies in correlation with the registry query events. Cross-reference with known white-listed applications and validate if the behavior aligns with their expected operational footprint. Inspect any linked process executions or script deployments for signs of unauthorized modifications or dubious purposes. |
| T2 Analyst Actions | Conduct deeper forensic analysis utilizing endpoint detection and response (EDR) tools to evaluate the full context of registry access events. Review historical data for pattern anomalies or a timeline of similar suspicious activity. Engage in threat intelligence analysis to cross-check indicators with current threat advisories or datasets. Perform lateral movement detection assessments to check for broader compromise. |
| Containment and Further Analysis | Isolate the affected system from the network if confirmed unauthorized registry access is linked to malicious activity. Initiate full system scan with updated antivirus/anti-malware solutions. Engage system snapshots or backups for detailed comparative analysis. Report findings to incident response (IR) teams for containment strategy assessment. Execute registry permission audits to reinforce against further unauthorized access. |
