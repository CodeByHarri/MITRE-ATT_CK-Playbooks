# System_Network_Configuration_Discovery:_Wi-Fi_Discovery - T1016002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1016.002 |
| MITRE Sub-TTP | T1016.002 |
| Name | System Network Configuration Discovery: Wi-Fi Discovery |
| Log Sources to Investigate | Log sources include: 1. Wi-Fi Event Logs: Check for logs pertaining to Wi-Fi connectivity changes, especially those that record the list of available networks or changes to stored Wi-Fi configurations.<br>2. Windows Event Logs: Look at command line logs for uses of 'netsh wlan' commands.<br>3. Linux System Logs: Investigate access or read operations on files within '/etc/NetworkManager/system-connections/'. 4. macOS Logs: Examine Terminal logs for 'security find-generic-password' executions and monitor for sudo or admin access granting. 5. Network Monitoring: Keep an eye on outbound network connections for any unusual destinations that might imply data exfiltration after Wi-Fi credential discovery. |
| Key Indicators | 1. Execution of commands like 'netsh wlan show profiles' and 'netsh wlan show profile "Wi-Fi name" key=clear' on Windows systems.<br>2. Access to '/etc/NetworkManager/system-connections/' on Linux.<br>3. Usage of 'security find-generic-password -wa wifiname' on macOS, particularly with elevated privilege requests. 4. Sudden access to a large list of Wi-Fi networks or credential files by processes unrelated to regular Wi-Fi management services. 5. Repeated and unauthorized access attempts to Wi-Fi networks detected in historical logs. |
| Questions for Analysis | 1. Is the command or file access originating from a known administrative user or process?<br>2. Has there been a recent change in Wi-Fi connection patterns, such as connecting to previously unknown networks?<br>3. Are there signs of data exfiltration or unusual network activity following the Wi-Fi credential discovery activity? 4. Are the commands/scripts executed during typical operational hours? 5. Is the activity anomalous compared to historical system behavior? |
| Decision for Escalation | Escalate to Tier 2 if 1. The commands for Wi-Fi credential discovery are executed by unknown or non-administrative users.<br>2. There are correlating signs of data exfiltration or lateral movement attempts.<br>3. Multiple systems exhibit similar suspicious activity concurrently, suggesting a coordinated effort. |
| Additional Analysis Steps for L1 | 1. Cross-verify command execution with user activity and system access logs to identify if any anomalies are present.<br>2. Review user accounts involved in the activity for any signs of compromise or recent changes.<br>3. Check historical trends for system or network activities to establish a baseline for what constitutes normal behavior. |
| T2 Analyst Actions | 1. Conduct a deeper forensic analysis of involved systems, focusing on unauthorized data access or exfiltration.<br>2. Analyze network traffic for signs of data being transmitted to suspicious IP addresses or domains post-discovery activity.<br>3. Review all logs to piece together a timeline of the suspicious activity to determine the attack's scope and potential impact. |
| Containment and Further Analysis | 1. Isolate affected systems from the network immediately to prevent further credential access or data exfiltration.<br>2. Reset and rotate Wi-Fi passwords for compromised networks to prevent unauthorized access.<br>3. Deploy broader security patches and updates across the network to close any vulnerabilities utilized by the adversary. 4. Conduct a post-mortem analysis with stakeholders to address gaps and improve detection and response strategies. |
