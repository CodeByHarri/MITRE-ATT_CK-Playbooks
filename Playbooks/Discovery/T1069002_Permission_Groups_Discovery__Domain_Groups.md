# Permission_Groups_Discovery:_Domain_Groups - T1069002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1069.002 |
| MITRE Sub-TTP | T1069.002 |
| Name | Permission Groups Discovery: Domain Groups |
| Log Sources to Investigate | To detect and analyze T1069.002, focus on:<br>1. Domain Controller Security Logs: Look for events indicating group enumeration activities, such as Windows Security Event ID 4662 (An operation was performed on an object).<br>2. Network Traffic Logs: Monitor for anomalous network traffic patterns or specific commands like 'net group /domain'.<br>3. Endpoint Detection and Response (EDR) Logs: Use EDR solutions to identify execution of commands indicative of domain enumeration, such as 'net group' on Windows, 'dscacheutil -q group' on macOS, or 'ldapsearch' on Linux.<br>4. Authentication Logs: Examine authentication events for unusual sources or failed attempts associated with domain enumeration. |
| Key Indicators | Key indicators of the T1069.002 include:<br>1. Execution of commands like 'net group /domain', 'dscacheutil -q group', or 'ldapsearch' on endpoints.<br>2. Suspicious or anomalous account usage patterns accessing domain group information.<br>3. Network connections from unusual IP addresses to domain controllers.<br>4. Repeated or failed attempts to access domain group information within a short timeframe. |
| Questions for Analysis | 1. Is the account executing domain group enumeration commands authorized to perform such actions?<br>2. Is there any correlation between the executed commands and suspicious network activities or authentication attempts?<br>3. Has the same IP address or account been associated with any previous suspicious activities?<br>4. Are there instances of this account executing commands from unexpected locations or at unusual times? |
| Decision for Escalation | Escalate to Tier 2 if:<br>1. The account executing the commands does not have a legitimate need to perform domain group enumeration.<br>2. The activity originates from an unusual location or during non-business hours.<br>3. There are other related suspicious activities, such as failed login attempts or privilege escalation attempts.<br>4. EDR or network logs show connections from known malicious or blacklisted IP addresses. |
| Additional Analysis Steps for L1 | 1. Verify the legitimacy of the account executing the domain enumeration commands.<br>2. Check recent activity and logins for the account to identify any anomalies.<br>3. Analyze network logs for correlating suspicious patterns or external connections.<br>4. Review historical incidents associated with the account or IP address. |
| T2 Analyst Actions | 1. Perform a deeper investigation of the user account and endpoint involved in the activity.<br>2. Correlate multiple data sources (EDR, network, authentication logs) to confirm malicious intent.<br>3. Use threat intelligence to check if the involved IPs or patterns match known threat actor TTPs.<br>4. If confirmed, prepare an incident report with the findings and recommended remediation steps. |
| Containment and Further Analysis | 1. Temporarily suspend the account involved in suspicious activity to prevent further unauthorized access.<br>2. Isolate the endpoint from the network to halt potential lateral movement.<br>3. Conduct a thorough forensic analysis of the endpoint to determine the scope and impact of the compromise.<br>4. Update firewall and intrusion detection system (IDS) rules to monitor and block similar enumeration attempts in the future. |
