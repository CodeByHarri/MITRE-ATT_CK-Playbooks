# Hijack_Execution_Flow:_Services_Registry_Permissions_Weakness - T1574011

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Persistence, Privilege Escalation |
| MITRE TTP | T1574.011 |
| MITRE Sub-TTP | T1574.011 |
| Name | Hijack Execution Flow: Services Registry Permissions Weakness |
| Log Sources to Investigate | Collect logs from Windows Event Log, particularly Security and System logs to look for events related to service configuration changes. Monitor Registry access events using Sysmon (Event ID 13 for Registry value modification) to detect unauthorized modifications to HKLM\SYSTEM\CurrentControlSet\Services keys. Use EDR (Endpoint Detection and Response) solutions to track process activity involving tools like sc.exe, PowerShell, and reg.exe that might modify service registry keys. |
| Key Indicators | Unusual modifications to HKLM\SYSTEM\CurrentControlSet\Services tree. Changes to ImagePath, FailureCommand, and Performance keys in the registry without corresponding legitimate administrative actions. Execution of processes from unexpected paths or by non-administrative users via services. Creation of unexpected subkeys like Performance or Parameters in service registry keys. |
| Questions for Analysis | Are there recent changes in service registry keys without corresponding administrative approval? Have any new executables been launched by services not previously altered? Are there any signs of unauthorized registry changes correlating with suspicious user accounts? Are there any abnormal behavior or privilege escalations observed from the modified services? |
| Decision for Escalation | Escalate to Tier 2 if unauthorized registry changes to service keys are detected, especially if associated with sensitive services or SYSTEM level execution. Escalate if unknown executables are configured to launch via services. Escalation is needed for any registry modifications made by non-administrative users. Consider escalation if indicators of privilege escalation are identified. |
| Additional Analysis Steps for L1 | Verify the legitimacy of recent service registry changes with responsible administrators. Check the ownership and permissions of modified registry keys to identify potential weaknesses. Validate unexpected service behavior and changes against known changes and updates. Correlate any identified unauthorized changes with suspicious behavior in user account activity logs. |
| T2 Analyst Actions | Conduct deeper forensics on affected systems to understand the full scope and impact. Investigate any unauthorized registry changes and verify execution paths for involved services. Analyze execution context and user permissions to determine escalation paths. Look for parallel suspicious activity across the infrastructure indicating a broader attack. |
| Containment and Further Analysis | Revert unauthorized changes to service registry keys immediately to prevent further unauthorized execution. Patch permission weaknesses identified in registry keys. Isolate affected systems for detailed incident analysis and ensure malicious payloads or service modifications are removed. Review and strengthen user permissions policies to prevent registry modifications by unauthorized users. |
