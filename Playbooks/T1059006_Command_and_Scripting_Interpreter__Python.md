# Command_and_Scripting_Interpreter:_Python - T1059006

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Execution |
| MITRE TTP | T1059.006 |
| MITRE Sub-TTP | T1059.006 |
| Name | Command and Scripting Interpreter: Python |
| Log Sources to Investigate | To investigate potential abusive usage of Python, examine the following log sources: <br>1. Endpoint Detection and Response (EDR) logs: Look for the execution of python.exe, particularly those running from unusual paths or with suspicious command-line arguments.<br>2. Process Monitoring: Capture details around process creation events involving python.exe.<br>3. File Integrity Monitoring (FIM): Check for newly created or modified .py files, especially those in non-standard directories.<br>4. Network Traffic Analysis: Investigate outbound network connections initiated by python.exe, especially those to suspicious domains or IPs.<br>5. Sysmon Logs: Helps in observing detailed process creation and network connections initiated by Python scripts.<br>6. Security Information and Event Management (SIEM): Correlate events involving Python scripts execution and any related security alerts. |
| Key Indicators | 1. Execution of 'python.exe' with command-line arguments that include potential obfuscation or encoded scripts.<br>2. Python processes initiating unusually high outbound network connections or connections to known malicious IP ranges.<br>3. Creation and execution of .py files in non-standard directories, such as temporary folders.<br>4. Suspicious Python script contents, involving sensitive system API calls such as 'os', 'subprocess', or network-related libraries like 'http.client'.<br>5. Abnormal access to critical files and directories by Python-related processes.<br>6. Sequential or timed Python script executions indicating potential scheduled tasks or persistence mechanisms. |
| Questions for Analysis | 1. Is the python.exe execution related to a known software process, or does it appear as an unusual activity?<br>2. Do the command-line arguments or script contents suggest typical or malicious intentions?<br>3. Is there any correlation with other suspicious activity, such as alerts from antivirus tools or user-reported issues?<br>4. Have there been any recent changes or installations in the environment that might explain the script execution?<br>5. Are the IP addresses contacted by the Python process known to be associated with malicious activities? |
| Decision for Escalation | Escalate to Tier 2 if: <br>1. The Python script or execution context is unknown and cannot be justified by normal business operations.<br>2. The activity correlates with known Indicators of Compromise (IoCs) from threat intelligence feeds.<br>3. There is evidence of unauthorized data access or exfiltration attempts.<br>4. The Python process attempts privilege escalation or access to restricted system areas or files.<br>5. Multiple systems exhibit similar suspicious Python-related activity concurrently. |
| Additional Analysis Steps for L1 | 1. Gather and review additional context regarding the execution's command-line parameters.<br>2. Verify the source and integrity of the Python script or commands executed.<br>3. Cross-reference against known patterns or signatures in threat intelligence platforms.<br>4. Check related system logs for any prior activities leading up to the Python execution.<br>5. Communicate with the affected user or system owner to validate any legitimate needs for Python script execution. |
| T2 Analyst Actions | 1. Conduct a deeper investigation into the affected system's history for signs of lateral movement or persistence.<br>2. Analyze the script for malicious functions or code patterns like data exfiltration or obfuscation techniques.<br>3. Use sandboxing tools to safely execute and observe the behavior of the suspect Python script.<br>4. Collaborate with threat intelligence teams to identify any new IoCs.<br>5. Determine the impact on the network and potentially affected systems to initiate cyber threat intelligence sharing. |
| Containment and Further Analysis | 1. Quarantine affected endpoints to prevent further execution or propagation of suspicious scripts.<br>2. Use endpoint security tools to isolate or block execution from specific paths or of suspicious scripts.<br>3. Perform a thorough malware scan and system integrity check on affected and potentially affected systems.<br>4. Review and refine security policies to prevent unauthorized script executions (e.g., using application whitelisting).<br>5. Gather forensic evidence from affected systems for legal or compliance requirements.<br>6. Monitor network traffic for ongoing or similar suspicious activities to prevent recurrence. |
