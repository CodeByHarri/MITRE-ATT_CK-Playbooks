# Unsecured_Credentials:_Private_Keys - T1552004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1552.004 |
| MITRE Sub-TTP | T1552.004 |
| Name | Unsecured Credentials: Private Keys |
| Log Sources to Investigate | Audit logs from file access monitoring tools to detect creation, access, or modification of files with extensions such as .key, .pgp, .gpg, .ppk, .p12, .pem, .pfx, .cer, .p7b, and .asc. System security logs that document access to directories like ~/.ssh or C:\Users\<username>\.ssh\ on Windows. Network device logs detailing command executions, particularly commands like 'crypto pki export' or other configuration changes. Endpoint detection and response (EDR) logs for evidence of keylogging activities or brute force attempts. Authentication logs for unusual or unauthorized remote connection attempts, especially over SSH. |
| Key Indicators | Presence of key or certificate files in non-standard directories. Access to or modification of files in ~/.ssh or C:\Users\<username>\.ssh\. Execution of commands related to private keys on network devices. Unusual read activity on files with key or certificate extensions. Unexplained increases in failed access attempts associated with key usage. Suspicious processes or applications running keylogging actions. |
| Questions for Analysis | Are there records of recent file access attempts to private key locations? Do any user accounts appear to be accessing these files outside of their normal hours? Are there any related alerts for unauthorized command execution on network devices? Is there evidence of keylogging or brute force attempts on the system? Have there been any successful unauthorized authentications using private keys? |
| Decision for Escalation | Escalate if there is direct evidence of unauthorized access or exfiltration of private key files. Escalate if any processes linked to keylogging or brute force activities are detected. Escalate if private key-related commands on network devices are executed by unauthorized users or outside maintenance windows. |
| Additional Analysis Steps for L1 | Verify if the private key files were accessed by authorized users by cross-referencing access times with known user activities. Review authentication logs to determine if keys have been exported or attempted to be used in unauthorized connections. Check for any anomalies in login patterns, such as source IP addresses and change in login frequency. Examine available logs for command line execution on network devices for unauthorized use. |
| T2 Analyst Actions | Conduct a deeper investigation into the accessed or modified key files to determine their creation and modification sources. Perform detailed log correlation and timeline analysis to match key-related events against user activities and alerts. Investigate surrounding events in network device logs to uncover any related unauthorized commands or configurations. Coordinate with IT personnel to verify the integrity and legitimacy of affected cryptographic keys or certificates. |
| Containment and Further Analysis | Isolate affected systems from the network to prevent further misuse of compromised keys. Remove discovered malicious processes such as keyloggers and mitigate any brute force accesses. Revoke or rotate compromised cryptographic keys or certificates and implement additional monitoring around reissued credentials. Update asset-specific security settings and access control guidance to harden against identified exploitation paths. Conduct a comprehensive review of key management practices to prevent future incidents. |
