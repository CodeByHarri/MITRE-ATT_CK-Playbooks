# Modify_Authentication_Process:_Hybrid_Identity - T1556007

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access, Defense Evasion, Persistence |
| MITRE TTP | T1556.007 |
| MITRE Sub-TTP | T1556.007 |
| Name | Modify Authentication Process: Hybrid Identity |
| Log Sources to Investigate | 1. Windows Event Logs from servers running PTA agents or AD FS servers.<br>2. Azure AD audit logs for unusual changes, such as the registration of new PTA agents.<br>3. Entra ID sign-in logs to detect unusual authentication patterns. 4. Network traffic logs for signs of unauthorized access or data exfiltration from compromised servers. 5. Endpoint detection logs for DLL injection activities or unauthorized file modifications on key servers. |
| Key Indicators | 1. Changes to PTA agent configurations or unauthorized installations/registrations of new agents.<br>2. Modifications to AD FS configuration files such as Microsoft.IdentityServer.Servicehost.<br>3. Unexpected DLL injections into AzureADConnectAuthenticationAgentService process or associated processes. 4. Unusual patterns of authentication requests or logins, especially from unexpected locations or outside normal hours. 5. Changes to privileged account settings or permissions in Entra ID without a legitimate request. |
| Questions for Analysis | 1. Are there any unauthorized changes to PTA or AD FS configurations?<br>2. Have there been unexpected logins or authentication attempts from unusual IP addresses?<br>3. Is there evidence of DLL modifications or suspicious processes running on servers handling hybrid identities? 4. Are there any unusual additions or changes to privileged accounts in Azure AD? 5. Is there any network traffic indicating data exfiltration from critical identity servers? |
| Decision for Escalation | Escalate to Tier 2 if: 1. Unauthorized changes to authentication processes are confirmed.<br>2. Evidence of unauthorized access to privileged accounts is detected.<br>3. DLL injections or file modification activities are identified. 4. Anomalous authentication patterns suggest compromised credentials or infrastructure. |
| Additional Analysis Steps for L1 | 1. Verify if any privileged account changes logged are associated with a legitimate business request.<br>2. Cross-reference IP addresses from which suspicious activities originate with known company assets or employees.<br>3. Check recent software or configuration updates on identity management servers for anomalies. |
| T2 Analyst Actions | 1. Perform deep dive on server logs to confirm any unauthorized changes to authentication infrastructure.<br>2. Analyze network traffic around the time of suspicious activities to identify potential C2 communications.<br>3. Use tools like Sysinternals or similar forensic tools to verify DLL injections or file integrity issues on affected servers. |
| Containment and Further Analysis | 1. Immediately disable any suspicious PTA agents or authentication-related configurations.<br>2. Reset passwords and initiate security protocols on any compromised privileged accounts.<br>3. Conduct a comprehensive review of server integrity and reinstall any affected components if necessary. 4. Monitor for subsequent suspicious activities in case of residual threats, and strengthen monitoring rulesets for hybrid identity processes. |
