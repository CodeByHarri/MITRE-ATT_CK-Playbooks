# Hijack_Execution_Flow:_AppDomainManager - T1574014

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Persistence, Privilege Escalation |
| MITRE TTP | T1574.014 |
| MITRE Sub-TTP | T1574.014 |
| Name | Hijack Execution Flow: AppDomainManager |
| Log Sources to Investigate | To investigate T1574.014 AppDomainManager injection, focus on the following log sources: <br>- Windows Event Logs: Look for events associated with .NET processes, such as application starts (Event ID 1000) and load configuration changes.<br>- Security Logs: For any unauthorized changes to application domains or configuration files.<br>- Process Creation Logs: Monitor for unexpected or abnormal processes starting .NET runtime environments.<br>- File Integrity Monitoring (FIM) logs: Check for alterations to .NET configuration files (.config).<br>- Application Logs: Specifically look at logs capturing assembly load events or custom AppDomain creations. |
| Key Indicators | Key indicators of AppDomainManager injection include:<br>- Unusual or unexpected creation of .NET AppDomains.<br>- Modification of .NET configuration files specifying unknown or suspicious assemblies to load.<br>- Unexpected processes running under .NET or with AppDomainManager functions.<br>- Network connections initiated by AppDomain-managed applications that do not align with normal usage patterns. |
| Questions for Analysis | Consider the following questions:<br>- Is there evidence of unusual assemblies being loaded by .NET applications?<br>- Were there any recent changes to .NET configuration files or environment settings?<br>- Have there been any recent unsigned or suspicious binaries executing under .NET runtime?<br>- Are there any known vulnerabilities in the applications or environments involved? |
| Decision for Escalation | Escalate to Tier 2 if:<br>- Unrecognized or suspicious assemblies have been loaded into critical .NET applications.<br>- There is evidence of tampering with .NET configuration files or AppDomainManager settings.<br>- Unauthorized processes are creating or managing AppDomains.<br>- Any indicators correlate with threat intelligence reports or IOC lists. |
| Additional Analysis Steps for L1 | For Tier 1 Analysts, additional analysis might include:<br>- Validate modifications to .NET configuration files by checking their integrity and comparing with backups or expected baselines.<br>- Correlate events across different logs to understand the timeline and impact of any AppDomain-related events.<br>- Investigate any associated user accounts for anomalies or unauthorized activity. |
| T2 Analyst Actions | Tier 2 Analysts should:<br>- Conduct a deeper forensic analysis on the affected systems, utilizing tools to unpack .NET assemblies to identify malicious code.<br>- Cross-reference suspicious activities with up-to-date threat intelligence feeds and past incidents.<br>- Review system and application hardening configurations to identify and address any weaknesses. |
| Containment and Further Analysis | To contain and further analyze the threat:<br>- Isolate affected systems immediately to prevent spread or further malicious activity.<br>- Restore modified .NET configuration files to known good states from backups.<br>- Conduct a comprehensive review of logs and system interactions to map out potential threat actor movements.<br>- If possible, utilize sandboxing techniques to observe the behavior of any suspicious assemblies in a controlled environment. |
