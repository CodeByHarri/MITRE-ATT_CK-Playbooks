# Hide_Artifacts:_Hidden_File_System - T1564005

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1564.005 |
| MITRE Sub-TTP | T1564.005 |
| Name | Hide Artifacts: Hidden File System |
| Log Sources to Investigate | To detect the presence of hidden file systems, analysts should investigate logs from the following sources: <br>- File system monitoring logs such as Sysmon event ID 1 (Process creation) and Sysmon event ID 11 (File creation) to track unusual file system activity. <br>- Disk activity logs from tools like Process Monitor that can highlight abnormal I/O operations and access to reserved disk space. <br>- Endpoint Detection and Response (EDR) solutions that might log anomalies in file path naming conventions or unusual file existence.<br>- Security Information and Event Management (SIEM) systems to correlate activities linked to unusual processes or OS-level file system interactions. |
| Key Indicators | Indicators of this TTP include:<br>- The presence of unfamiliar portable partition images stored as files in common directories.<br>- Unusual disk space usage in sectors or partitions marked as 'reserved' or containing no standard partitions.<br>- Anomalous and fragmented file paths within common directories suggesting unusual storage formats.<br>- Sudden or unexpected drops in available disk space not consistent with typical usage patterns.<br>- Files or file systems that evade traditional file integrity or antivirus checks. |
| Questions for Analysis | Questions to consider include:<br>- Is there observed disk space usage from hidden or unrecognized partitions?<br>- Are there logs of processes accessing unusual areas of the file system?<br>- Have there been changes in disk geometry or reporting through standard OS tools?<br>- Are there entries in the logs indicating installation or access to non-standard file systems?<br>- Has the system exhibited any sudden performance issues linked to file system operations? |
| Decision for Escalation | Escalate to Tier 2 when:<br>- There is any confirmed detection of potential hidden partitions or abnormal file system structures.<br>- Anomalies consistently align with known TTPs for hidden file systems without an immediate, legitimate explanation.<br>- Suspicious access patterns or system alerts indicate further investigation beyond automated detection capabilities.<br>- There are new or unknown portable partition files found on critical systems that require expert analysis. |
| Additional Analysis Steps for L1 | Tier 1 analysts should:<br>- Review detailed logs of all related file system events over a suspicious timeframe.<br>- Check for known indicators of compromise (IOCs) related to hidden or virtual file systems.<br>- Analyze the differences in disk space usage against the expected capacity and historical changes.<br>- Utilize disk and file utilities to attempt to identify anomalies in file location and structure.<br>- Coordinate with the responsible system administrator to determine if legitimate changes occurred. |
| T2 Analyst Actions | Tier 2 analysts should:<br>- Use advanced tools to analyze disk partitions and file systems for hidden or non-standard entries.<br>- Conduct a thorough forensic analysis of the system's disk to detect anomalies.<br>- Validate identified anomalies with network and system activity logs for possible coordinated actions.<br>- Consider leveraging file system analysis utilities to mount and investigate suspicious partitions or files.<br>- Report findings and suggest system hardening measures or potential threat containment actions based on analysis. |
| Containment and Further Analysis | To contain and further analyze the threat:<br>- Isolate the affected system to prevent potential spread or data exfiltration.<br>- Consider imaging the disk for in-depth analysis and to preserve evidence.<br>- Employ locked-down restoration techniques, ensuring no hidden partitions are inadvertently restored.<br>- Use sandbox environments to safely investigate suspicious files or partitions for any malware.<br>- Engage threat intelligence teams to match the findings with known threat actor techniques and update defense mechanisms accordingly. |
