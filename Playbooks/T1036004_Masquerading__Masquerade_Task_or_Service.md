# Masquerading:_Masquerade_Task_or_Service - T1036004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1036.004 |
| MITRE Sub-TTP | T1036.004 |
| Name | Masquerading: Masquerade Task or Service |
| Log Sources to Investigate | 1. Windows Event Logs - Specifically, Task Scheduler Operational logs (Event ID 4698, 4700, 4720), and Service Control Manager logs (Event ID 7045) for any changes in services.<br>2. Systemd Logs - On Linux systems, check logs under /var/log/syslog or systemdâ€™s journalctl for service modifications.<br>3. SIEM - Centralized logging solutions that aggregate logs from different sources may provide a more comprehensive view. Examples include Splunk or ELK Stack. |
| Key Indicators | 1. Newly created or modified tasks/services with names or descriptions that closely resemble legitimate ones but with minor typos or deviations.<br>2. Unusual execution paths for tasks or services that do not follow standard baseline behaviors.<br>3. Task/Service creation by unfamiliar or unauthorized accounts. 4. Tasks or services with unusual persistence mechanisms, like registry keys unfamiliar to legitimate operations. |
| Questions for Analysis | 1. Does the task/service name exactly match those in the baseline of legitimate tasks/services?<br>2. Is the creation or modification of the task/service conducted by a privileged account or a known user?<br>3. Are there unusual patterns in the timing of the task execution or service start-up that don't align with regular activity schedules? |
| Decision for Escalation | Escalate to Tier 2 if: 1. The task/service name is similar to a legitimate one but with unknown deviations.<br>2. The action was taken by an unexpected or unauthorized user account.<br>3. There is evidence of the task/service being used in recent suspicious activity (e.g., execution of unauthorized scripts or unusual network connections). |
| Additional Analysis Steps for L1 | 1. Review recent changes or additions in Task Scheduler or Systemd services and verify details against known baseline activities.<br>2. Conduct OSINT or use internal documentation to verify if the suspect task/service names have any known associations with malware tactics or legitimate applications.<br>3. Check associated accounts for unusual access patterns or recent changes in user permissions. |
| T2 Analyst Actions | 1. Perform a deeper analysis of any related binaries or scripts linked with the suspicious service/task using malware analysis tools.<br>2. Use threat intelligence sources to correlate the task/service names with known malicious behavior.<br>3. Cross-check any network activity tied to the task/service for potential C2 communications or data exfiltration attempts. |
| Containment and Further Analysis | 1. Quarantine affected systems from the network to prevent further spread or exfiltration of data.<br>2. Disable suspected services/tasks temporarily until a full analysis can confirm their legitimacy.<br>3. Perform a complete scan of the affected system for additional indicators of compromise. 4. If compromised, take steps to reinforce user access controls and monitor for repeated or similar attack patterns. |
