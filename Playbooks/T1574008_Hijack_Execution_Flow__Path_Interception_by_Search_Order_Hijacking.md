# Hijack_Execution_Flow:_Path_Interception_by_Search_Order_Hijacking - T1574008

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Persistence, Privilege Escalation |
| MITRE TTP | T1574.008 |
| MITRE Sub-TTP | T1574.008 |
| Name | Hijack Execution Flow: Path Interception by Search Order Hijacking |
| Log Sources to Investigate | Monitor process creation logs, especially for unexpected child processes that deviate from normal execution patterns, such as Sysmon Event ID 1 (Process Creation). Review file creation/modification events, like those provided by Sysmon Event ID 11 (File Creation) and Windows Event ID 4663 (File Access). Examine command-line logging sources for unusual program execution without full paths. Utilize third-party tools like Process Monitor to track file and process activity that might indicate search order hijacking. |
| Key Indicators | Presence of executable files in application directories that match commonly executed names like 'net.exe', but differ in file hashes from legitimate system files. Execution of processes with command-line arguments that suggest PATH hijacking, such as launching 'cmd.exe' with commands typically not specified with full paths. Unexpected execution of files with extensions in specified directory orders like .com over .exe in high-risk directories. |
| Questions for Analysis | 1. Are there any recent changes or updates to software known to have caused unexpected behavior?<br>2. Does this process exhibit behavior typical of known legitimate software, or are there anomalies like unusual network connections or system modifications?<br>3. Has the suspected file been executed recently, and does it match known good files on the system based on hash checks? |
| Decision for Escalation | Escalate if the process involves new or unexpected executables in sensitive application directories, especially if combined with unusual network activity or system changes. Alert if reputation checks or file hashes do not match known legitimate files. Escalate cases where the file is part of a critical application path that might be vulnerable to search order hijacking, leading to potential privilege escalation or data exfiltration. |
| Additional Analysis Steps for L1 | Conduct initial reputation checks on files involved, including hash matching against threat intelligence databases. Analyze process ancestry for unexpected parent-child relationships that might indicate hijacking. Review recent logs for similar anomalies to establish if this is a repeat occurrence or isolated incident. |
| T2 Analyst Actions | Perform in-depth file analysis, including static and dynamic analysis of the suspicious executable(s). Check for persistence mechanisms related to the hijacked execution flow, such as auto-start registry entries. Investigate any network interactions conducted by these processes to detect possible command and control activity. |
| Containment and Further Analysis | Isolate affected systems to prevent further execution of malicious payloads. Remove or rename the offending files and replace with legitimate versions where applicable. Review and possibly harden application code or paths to prevent future abuse of search order vulnerabilities. Document and apply lessons learned to similar system configurations across the network. |
