# Archive_Collected_Data:_Archive_via_Library - T1560002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Collection |
| MITRE TTP | T1560.002 |
| MITRE Sub-TTP | T1560.002 |
| Name | Archive Collected Data: Archive via Library |
| Log Sources to Investigate | Collect logs from file creation and modification, specifically focusing on directories typically used for staging before exfiltration. Monitor process execution logs for use of library functions related to compression or encryption, such as Python scripts utilizing rarfile or zlib, or the use of libzip. Security Information and Event Management (SIEM) systems can aggregate data from application logs, operating system event logs (e.g., Windows Event Log, syslog for Linux), and host-based intrusion detection systems (HIDS) for library usage. |
| Key Indicators | Unusual use of archival library functions detected in process monitoring, suspicious naming patterns for archive files (e.g., very large file size or uncommon extensions like .rar, .zip, .bz2 in atypical directories), high volume of read operations against sensitive files followed by write operations to an archive, and network connections to uncommon external IP addresses immediately following archival activities. |
| Questions for Analysis | 1. Was the archival operation executed by a known and trusted process or user?<br>2. Is the accessing and archiving of data from an unexpected directory or user workstation?<br>3. Did the archive process use any unfamiliar third-party libraries that are not typically a part of the organizationâ€™s tech stack? 4. Was there a rapid succession of file accesses followed by network activity suggesting potential exfiltration? |
| Decision for Escalation | Escalate to Tier 2 if there is evidence of potential data staging for exfiltration, such as large archive files created in user directories or system areas where such activities are not typically performed. Escalate if the process creating the archive matches known patterns of malicious activity or involves privileged accounts doing unusual tasks. |
| Additional Analysis Steps for L1 | Verify the legitimacy of the processes involved in creating the archives. Check for recent user activity logs to identify unexpected access or usage patterns. Correlate the archive timestamps with network activity logs to determine if there was any attempt to exfiltrate data. Review antivirus or endpoint detection logs for alerts relating to suspicious libraries. |
| T2 Analyst Actions | Conduct a deeper forensic analysis of the system to identify any signs of compromise leading to the archival process. Check for persistence mechanisms that might have been dropped by the attacker. Review user account history leading up to archival events. Identify all systems or network shares accessed by the suspicious process. |
| Containment and Further Analysis | Isolate the affected systems from the network to prevent further data exfiltration. Quarantine the suspicious archive files for analysis without allowing them to be transferred offsite. Conduct deeper packet analysis on the network to identify if any data transfer occurred. Deploy endpoint detection agents to monitor further activity from the affected systems and recommend updating security policies to include better detection for unconventional archive library usage. |
