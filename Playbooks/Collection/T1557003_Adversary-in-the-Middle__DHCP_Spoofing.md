# Adversary-in-the-Middle:_DHCP_Spoofing - T1557003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Collection, Credential Access |
| MITRE TTP | T1557.003 |
| MITRE Sub-TTP | T1557.003 |
| Name | Adversary-in-the-Middle: DHCP Spoofing |
| Log Sources to Investigate | Examine DHCP server logs for unauthorized or unexpected DHCP server responses. Network traffic logs, especially related to DHCP broadcast messages, to identify unusual traffic patterns or rogue responses. Analyze DNS traffic, particularly changes in DNS server assignments on client devices. Inspect system logs on client devices for changes in IP configuration without legitimate changes. Review intrusion detection system (IDS) alerts for any spoofing activity or unusual traffic patterns. |
| Key Indicators | Unusual DHCP OFFER messages originating from unauthorized MAC addresses or IP addresses. Unexpected DHCP ACK messages not matching legitimate DHCP servers within the network. Clients receiving IP addresses or DNS configurations that differ from standard assignments. Sudden changes in network traffic routes on the client side. High volume of DHCP DISCOVER messages indicative of DHCP exhaustion attacks. |
| Questions for Analysis | Is the source MAC address of the DHCP OFFER or ACK messages associated with a known IP address on the network? Are there unexpected DNS server entries in the DHCP responses? Are there sudden and unauthorized changes in network configuration for a large group of clients? Are there legitimate reasons for DHCP messages with large intervals or high frequency? |
| Decision for Escalation | Escalate to Tier 2 if unauthorized DHCP server activity is detected, especially if aligning with known rogue DHCP server activity. Escalate if there is evidence of a departure from normal network configuration by multiple clients without justification. Escalate upon observing high volumes of DHCP DISCOVER messages that could indicate a DHCP exhaustion attempt. |
| Additional Analysis Steps for L1 | Verify the DHCP server configuration and compare it against known authorized DHCP servers. Check the network for the presence of unauthorized DHCP servers using tools that can detect rogue servers. Validate the source IP addresses and MAC addresses of reported DHCP messages against the inventory of authorized devices. Look for sudden changes in DNS settings or network routes on client machines. |
| T2 Analyst Actions | Perform deeper network packet analysis to identify all associated traffic routes potentially altered by the rogue DHCP server. Investigate the environment for signs of credential theft or information leakage via MITM positioning. Use active network scouting tools to discovery and isolate rogue DHCP servers. Correlate DHCP activity with logs from other security devices to identify broader attack patterns. |
| Containment and Further Analysis | Isolate affected client devices from the network to prevent further exposure. Disable unauthorized DHCP servers discovered during analysis. Conduct a full network sweep to ensure no other compromised systems exist. Rollback unauthorized network configuration changes on client endpoints. Increase network monitoring post-incident to detect similar attack patterns in the future. Engage with forensic specialists if credential compromise is suspected. |
