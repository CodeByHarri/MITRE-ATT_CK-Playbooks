# Input_Capture:_Keylogging - T1056001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Collection, Credential Access |
| MITRE TTP | T1056.001 |
| MITRE Sub-TTP | T1056.001 |
| Name | Input Capture: Keylogging |
| Log Sources to Investigate | For detection of T1056.001 activities, focus on logs from endpoint detection and response (EDR) solutions, anti-malware logs, Windows Event Logs (particularly logs related to registry modifications and driver changes), Sysmon for API calls, and Device/Driver installation. Examples include Windows Security event logs, Sysmon event logs (specifically Event ID 12 for driver load and Event ID 13 for registry modifications), and specific anti-malware application logs that monitor for unauthorized software installations. |
| Key Indicators | Detection of suspicious API call hooking related to keyboard inputs, unusual registry changes in paths such as 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options', installation of unauthorized or suspicious drivers, significant increases in Resource Monitor usage related to specific processes known to interface with hardware drivers, and frequent user-initiated login/logout events post-clearance of browser cookies. |
| Questions for Analysis | Is there evidence of unauthorized API hooking or modifications associated with keyboard input? Have there been unsanctioned changes to the Windows Registry, particularly related to driver or keyboard handling? Are there logs showing driver installations or modifications that align with adversarial behaviors? Have there been unusual patterns in user login/logout activities? |
| Decision for Escalation | Escalate if you identify unauthorized keylogging software, suspicious processes showing increased resource usage potentially related to keylogging, unauthorized registry modifications, or unapproved driver installations. Clear evidence of API hooks or malicious code consistent with keystroke monitoring should also be escalated. |
| Additional Analysis Steps for L1 | Review event logs for signs of hooked processes or suspicious registry changes. Check recent installations and driver changes. Validate any alerts from anti-malware tools related to input capture. Correlate these findings, if possible, with known indicators of compromise from threat intelligence feeds. |
| T2 Analyst Actions | Conduct a more detailed forensic analysis on the suspect system, including memory analysis for direct evidence of keylogging activity. Use network traffic analysis to identify any data exfiltration attempts, possibly leveraging keylogging outputs. Validate the scope of impact by determining whether other systems in the environment exhibit similar anomalies. |
| Containment and Further Analysis | Isolate affected systems immediately to prevent further credential compromise and data exfiltration. Remove suspicious drivers and restore registry settings to known good states. Conduct a thorough investigation to identify how the keylogger was introduced, ensuring any broader compromise vectors are mitigated. Deploy additional monitoring across the network to detect similar threats and conduct endpoint hardening to prevent reoccurrence. |
