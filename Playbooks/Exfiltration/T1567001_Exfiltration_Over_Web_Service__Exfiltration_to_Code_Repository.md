# Exfiltration_Over_Web_Service:_Exfiltration_to_Code_Repository - T1567001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Exfiltration |
| MITRE TTP | T1567.001 |
| MITRE Sub-TTP | T1567.001 |
| Name | Exfiltration Over Web Service: Exfiltration to Code Repository |
| Log Sources to Investigate | Network traffic logs to identify unusual HTTPS traffic patterns directed toward code repositories. Examples include logs from firewalls, network intrusion detection systems (NIDS), and web proxies. API access logs of services like GitHub, GitLab, or Bitbucket should also be monitored. Additionally, endpoint logs capturing command-line and process execution can help identify automation scripts or tools used for automated exfiltration tasks. |
| Key Indicators | Unusual API requests to code repositories, especially those containing POST requests with large data payloads from endpoints that typically don't interact directly with such services. A sudden surge in outbound traffic to IP addresses or domains of code repositories. Unexpected creation or modification of repositories, branches, or files on platforms like GitHub/GitLab. Use of toolkits or scripts for automating uploads to repositories. |
| Questions for Analysis | Is the detected HTTPS traffic pattern directed to a code repository API unusual for the identified user or endpoint? Does the user or endpoint typically access the identified code repository? Are there corresponding logs showing suspicious behavior before or after the exfiltration attempt? Are there observable changes in user behavior or access patterns correlating to known adversarial tactics? |
| Decision for Escalation | Escalate to Tier 2 if there is confirmation of large or unusual data transfers to repositories not normally utilized by the endpoint, discrepancies between the user's usual behavior and the current activity, or any detected use of known malicious scripts or tools for repository access. |
| Additional Analysis Steps for L1 | Verify the ownership and typical access patterns for the code repository in question. Check endpoint security logs for any executed scripts or tools that might facilitate data exfiltration. Correlate user or endpoint activity with external threat intelligence sources to identify known indicators of compromise related to repository exfiltration. |
| T2 Analyst Actions | Perform deeper analysis on network traffic patterns and correlate these with previously flagged activities. Investigate user account activity for signs of compromise and check for any unauthorized API tokens or keys. Review repository access logs for unauthorized changes or access times inconsistent with regular user activity. If available, use behavioral analytics to determine potential insider threats or hijacked accounts. |
| Containment and Further Analysis | Revoke unauthorized access to the code repository by invalidating compromised API keys or user accounts. Implement network-based blocks for unauthorized endpoints attempting to contact repositories. Engage in discussions with repository administrators for any needed internal security reviews. Conduct a post-incident analysis to refine detection rules and enhance monitoring of code repository interactions. If sensitive data was exfiltrated, initiate data breach notification protocols as per organizational policies. |
