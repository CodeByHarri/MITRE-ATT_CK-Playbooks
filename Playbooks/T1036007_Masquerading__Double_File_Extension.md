# Masquerading:_Double_File_Extension - T1036007

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1036.007 |
| MITRE Sub-TTP | T1036.007 |
| Name | Masquerading: Double File Extension |
| Log Sources to Investigate | Monitor file activity logs to detect the creation, modification, or execution of files with double extensions. Key log sources include Windows Event Logs (particularly Security and Application logs for execution events), Antivirus or Endpoint Detection and Response (EDR) alerts, email gateway logs for attachments with double extensions, and file access logs from systems or applications such as SIEM tools. Review email logs for spearphishing attachment indicators, and file system audit logs for irregular access patterns. |
| Key Indicators | Presence of files with suspicious double extensions (e.g., .txt.exe, .jpg.scr) in directories commonly used by users or within temporary email directories. Alerts from antivirus or EDR solutions concerning files with executable extensions originally appearing as benign file types. Instances where the file is downloaded or received through email and subsequently executed. Use of executable types masked as non-threatening formats (.txt, .doc appearing as .exe). |
| Questions for Analysis | 1. Was the file with a double extension received or executed recently? <br>2. Is there a history of executing files with similar patterns in the past by the user or within the organization? <br>3. Do the associated files correlate with known email attachments identified in phishing campaigns? <br>4. Is there any user-generated activity corroborating intentional execution? <br>5. Are there any antivirus or EDR alerts connected to these files? |
| Decision for Escalation | Escalate to Tier 2 if the file with a double extension either matches known IOC patterns, triggers multiple security alert layers (e.g., EDR, Antivirus), or if the file is placed in critical directories. Also, escalate if there’s evidence of subsequent, suspicious network activity or if similar incidents are observed across multiple users or systems. |
| Additional Analysis Steps for L1 | Check the file properties to ascertain its actual extension and origin. Validate the user’s activity to determine if the execution was intentional or inadvertent by examining user activity patterns through system logs. Consult threat intelligence databases for any matching IOC involving the double extension file. Document all findings and initiate contact with the user, if permissible, to verify the legitimacy of the action if contextually feasible. |
| T2 Analyst Actions | Conduct a deeper forensic investigation to determine the true nature of the file. Analyze any sandbox detonation results if the file was submitted to a sandbox. Review network logs for any attempted connections post-execution that align with C2 indicator patterns. Utilize advanced EDR capabilities to perform a timeline analysis of file activities and cross-reference with system changes. Identify affected systems, determine the extent of potential compromise, and elevated privileges, if any. |
| Containment and Further Analysis | Isolate affected systems from the network to prevent further propagation of any detected threats. Use the EDR solution to quarantine and remove the malicious file. Perform a comprehensive scan of the system and affected network to identify other compromised files or indicators of compromise. Review backup systems and restore clean states if necessary. After containment, document the lessons learned and strengthen defenses by applying IOEs to existing security measures. |
