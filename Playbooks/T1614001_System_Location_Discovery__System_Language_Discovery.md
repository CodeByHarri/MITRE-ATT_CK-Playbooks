# System_Location_Discovery:_System_Language_Discovery - T1614001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1614.001 |
| MITRE Sub-TTP | T1614.001 |
| Name | System Location Discovery: System Language Discovery |
| Log Sources to Investigate | For Windows systems, investigate security and system logs to identify registry query events, especially those targeting HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Language. Use Windows Event Log channels such as the Security Event Log for 'Process Creation' (Event ID 4688) and 'Registry' events (Event ID 4663). Monitor API call traces for calls to GetUserDefaultUILanguage, GetSystemDefaultUILanguage, GetKeyboardLayoutList, and GetUserDefaultLangID through endpoint detection and response (EDR) solutions. For macOS or Linux, examine shell history and process execution logs for evidence of 'locale' command usage, often found in bash history or auditd logs. |
| Key Indicators | Suspicious registry queries directed at HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Language, unexpected API calls such as GetUserDefaultUILanguage and GetSystemDefaultUILanguage in short succession or by unusual processes, and unexpected execution of the 'locale' command on non-interactive shells or by unfamiliar scripts. Anomalies in these logs that coincide with known attack frameworks can be key indicators. |
| Questions for Analysis | Is this activity coming from a known or trusted process/application? Have there been similar historical activities logged? Is this occurring from an expected host location or associated with typical user patterns? Are there associated network activities that match known threat actor behaviors, such as unusual outbound connections or data exfiltration attempts? |
| Decision for Escalation | Escalate to Tier 2 if registry or API calls related to system language discovery originate from unrecognized or malicious processes, or if they occur in conjunction with other suspicious activities such as network anomalies or unauthorized access attempts. Additionally, escalate if there are signs of cross-platform behavior via 'locale' command use in atypical contexts. |
| Additional Analysis Steps for L1 | Correlate identified registry and API call activities with known bad hashes or IP addresses. Verify if domain joined machines correspond with expected policy settings. Conduct searching across logs for similar patterns and confirm the legitimacy of the processes involved. Attempt to map any suspicious activity to known threat actor tactics or patterns. |
| T2 Analyst Actions | Perform deeper forensic analysis of involved hosts, including memory and disk imaging to uncover potential malware or script artifacts. Analyze network traffics, like beaconing or data transfers to detect anomalies or exfiltration attempts. Review recent updates to security policies, rules, and signatures to better trace the threat landscape. Collaborate with threat intelligence teams to validate if activities align with TTPs associated with advanced threat actors. |
| Containment and Further Analysis | Execute host containment procedures, such as network isolation, to prevent further data leakage. Run comprehensive endpoint scans to remove identified threats and verify the cleanup. Conduct retrospective analysis to determine if similar activities have been logged in the past indicating potential overlooked threats. Ensure all systems have updated endpoint protection with signatures catering to the latest threats related to this TTP. |
