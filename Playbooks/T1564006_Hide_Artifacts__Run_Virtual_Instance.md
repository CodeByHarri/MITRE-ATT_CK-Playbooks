# Hide_Artifacts:_Run_Virtual_Instance - T1564006

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1564.006 |
| MITRE Sub-TTP | T1564.006 |
| Name | Hide Artifacts: Run Virtual Instance |
| Log Sources to Investigate | To effectively monitor this TTP, investigate logs and telemetry from virtualization platforms such as Hyper-V and VirtualBox. Examine host-level logs for unusual creation of virtual instances, focusing on instances with atypical configurations. Network flow logs should be checked for unusual traffic patterns originating from virtualization interfaces. Windows Event Logs, particularly those related to Hyper-V (Event ID 19050, 18560), should be examined for signs of virtual machine creation or networking configuration changes. Additionally, monitor file access logs for indications of shared folders between host and virtual instances. |
| Key Indicators | Key indicators include the unexpected creation or execution of virtual machines on endpoints not typically used for virtualization, presence of virtualization files or software installations not standard for the environment (e.g., VirtualBox binaries), usage of network configurations like bridged adapters that are uncommon for legitimate use, and activity on network interfaces associated with virtual machines not corresponding to patch management schedules. |
| Questions for Analysis | 1. Is the virtual instance creation originating from a known administrator or authorized source?<br>2. Are there discrepancies in virtual instance configurations compared to standard templates used in the organization?<br>3. Is there any new or unusual software installation on the host system related to virtualization? 4. Does the network traffic from the virtual instance IP address align with normal business operations? 5. Are there any indications that virtual machine files or images were downloaded from external sources? |
| Decision for Escalation | Escalate to Tier 2 if: There is unauthorized creation of a virtual instance, if application of network configurations is inconsistent with the organization's security policy, when shared folders between host and guest show unauthorized or atypical access patterns, or if there's evidence of data exfiltration attempts via the virtual instance. |
| Additional Analysis Steps for L1 | Review user and process logs associated with the installation and execution of virtualization software. Verify the legitimacy of any new network interfaces, especially virtual network interfaces, discovered on the host machine. Check file access records for shared folders created between virtual and host machines. Correlate recent security patches or software updates with the appearance of virtualization software. |
| T2 Analyst Actions | Conduct deeper investigation into the origin and timeline of virtual instance creation, analyzing who initiated them and their exact configurations. Use endpoint detection and response (EDR) tools to perform a comprehensive scan of the host system for traces of malicious activities. Review historical network activity associated with the host and virtual instances for anomalies. Validate against threat intelligence sources for any IoCs associated with virtual instance misuse. |
| Containment and Further Analysis | Isolate the compromised host and any suspected virtual instances when unauthorized virtualization is confirmed. Disable unknown virtual instances and revoke any shared folder permissions. Fully log these actions for audit and compliance. Temporarily block the network traffic originating from suspicious virtual instances at the firewall. Conduct a forensic analysis on the host and virtual instances to identify and capture IoCs for future detection improvements. Report findings to the incident response team to inform wider organization security posture improvements. |
