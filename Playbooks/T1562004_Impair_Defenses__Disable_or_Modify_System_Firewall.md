# Impair_Defenses:_Disable_or_Modify_System_Firewall - T1562004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1562.004 |
| MITRE Sub-TTP | T1562.004 |
| Name | Impair Defenses: Disable or Modify System Firewall |
| Log Sources to Investigate | 1. Firewall Logs: Review for unauthorized modifications or deletions of rules (e.g., changes in existing RDP port usage or new rules allowing unwanted traffic).<br>2. Command-Line Logs: Check for commands that alter firewall settings using utilities like `netsh`, `firewall-cmd`, or `ufw`.<br>3. Windows Event Logs: Look for events associated with modifications to the Windows Firewall, particularly under the Security and System categories. 4. Windows Registry: Monitor changes to registry keys related to the Windows Defender Firewall. 5. System Configuration Logs: Examine logs for any changes to network interfaces and host networking settings that could influence firewall behavior. |
| Key Indicators | 1. Creation or removal of firewall rules without following change management protocols.<br>2. Unusual command-line activities like `netsh advfirewall set allprofiles state off`.<br>3. Registry modifications such as changes to `HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy`. 4. Alerts or logs showing exposure of high-risk ports not previously authorized. 5. Deviations in firewall policy enforcement timelines or sudden restart of firewall services. |
| Questions for Analysis | 1. Was the firewall rule modification authorized and documented within change management?<br>2. Is there historical precedent for similar changes by the user or on this device?<br>3. Are there signs of other suspicious activity correlating with the firewall modification timeframe? 4. Does the modified rule align with known attack patterns or techniques? 5. Has this device been flagged for security incidents previously? |
| Decision for Escalation | Escalate to Tier 2 if: 1. Unauthorized firewall modifications are confirmed.<br>2. There is matching activity with known threat indicators or attack patterns.<br>3. Contextual data associates firewall changes with lateral movement or suspected data exfiltration activities. 4. Validation shows critical devices or sensitive data are exposed as a result of the changes. |
| Additional Analysis Steps for L1 | 1. Correlate firewall log events with user activity logs to verify legitimacy.<br>2. Confirm whether firewall changes coincide with maintenance or scheduled updates.<br>3. Review historical logs for patterns of such changes, focusing on consistency or anomalies. 4. Consult with network administrators to gather additional context on recent firewall adjustments. |
| T2 Analyst Actions | 1. Conduct a deeper threat analysis utilizing threat intelligence to identify whether the changes are associated with known threat actors.<br>2. Investigate surrounding network traffic for abnormal patterns or communications suggesting compromised systems.<br>3. Validate integrity of registry keys and assess for signs of tampering beyond firewall settings. 4. Cross-reference with other security incidents or alerts in the same timeline. |
| Containment and Further Analysis | 1. If malicious activity is confirmed, isolate affected systems from the network to prevent lateral movement.<br>2. Restore affected firewall rules to their secure state from known-good configurations.<br>3. Apply updates or patches to address any vulnerabilities exploited by the adversary. 4. Conduct a comprehensive forensic investigation to determine the scope and entry vector of the attack. 5. Implement additional monitoring for early detection of similar future activities. |
