# Process_Injection:_Dynamic-link_Library_Injection - T1055001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Privilege Escalation |
| MITRE TTP | T1055.001 |
| MITRE Sub-TTP | T1055.001 |
| Name | Process Injection: Dynamic-link Library Injection |
| Log Sources to Investigate | Investigate log sources such as Windows Event Logs, specifically Security and System logs. Look for suspicious events related to process creation (Event ID 4688), handle manipulation (Event ID 4656, 4657), and remote thread creation. Monitor Sysmon logs for events like Sysmon Event ID 8 (CreateRemoteThread), Event ID 10 (Process access), and Event ID 7 (Image loaded). Utilize EDR solutions for detailed insight into DLL loads and privilege escalations. Analyze access logs for file system changes, especially for DLL paths in processes that usually do not load such libraries. |
| Key Indicators | Look for abnormal DLL load events, especially using uncommon or suspicious paths. Detect the use of process injection-related API calls such as VirtualAllocEx, WriteProcessMemory, and CreateRemoteThread. Monitor for newly started threads in processes that do not usually have them, potentially with calls related to LoadLibrary. Check for overwritten AddressOfEntryPoint within known DLL modules indicating Module Stomping. |
| Questions for Analysis | Does the process loading the DLL have a history of such actions? Is the DLL path or name consistent with expected applications or updates? Are there any known indicators around the DLL or its source process? Is the behavior aligned with any recent attack campaigns? What are the parent and child processes involved in this event? |
| Decision for Escalation | Escalate to Tier 2 if the DLL loading is associated with unusual system processes not typically performing such actions or if DLL paths and names are nonexistent or contradictory to the known baseline. Escalate also if detected API calls correlate with malicious process injection behavior or part of a larger attack chain. |
| Additional Analysis Steps for L1 | Perform a review of the system's recent updates and software installations to rule out legitimate DLL load actions. Conduct a preliminary investigation to determine the prevalence of the DLL path across other endpoints in the network. Attempt to identify specific users or tasks that might account for the observed behavior. Confirm process parent-child relationships to detect any known patterns of legitimate execution chains. |
| T2 Analyst Actions | Conduct deeper forensic analysis using memory dumps of the affected processes to identify hidden or reflected code snippets. Cross-reference DLL file hashes against known malware databases. Evaluate network activity for any possible exfiltration or command-and-control traffic signatures. Analyze system-wide logs to determine the full scope and impact of the injection event. |
| Containment and Further Analysis | Isolate the affected system from the network and initiate containment by terminating malicious processes. Facilitate restoration or cleanup of any overwritten or injected DLL files. Conduct a full malware scan and ensure integrity of key system binaries. Evaluate all communication logs to understand potential data leaks or lateral movement, and harden future defenses by implementing stricter DLL handling policies and monitoring improvements. |
