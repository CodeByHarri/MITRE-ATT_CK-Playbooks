# Command_and_Scripting_Interpreter:_JavaScript - T1059007

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Execution |
| MITRE TTP | T1059.007 |
| MITRE Sub-TTP | T1059.007 |
| Name | Command and Scripting Interpreter: JavaScript |
| Log Sources to Investigate | Collect logs from web servers for JavaScript execution, including NodeJS logs if applicable. Monitor browser history and downloads for suspicious websites that could host malicious JavaScript. Capture network traffic for anomalies indicating script file downloads. Check endpoint security solutions' logs for script execution alerts, especially focusing on the osascript command in macOS and wscript.exe or cscript.exe on Windows. Review event logs related to script execution and creation of new script files on macOS (e.g., Console logs, Unified logs) and Windows (e.g., Application and System Logs). |
| Key Indicators | Frequent and unexplained use of osascript or osacompile commands on macOS. Use of wscript.exe or cscript.exe for executing scripts on Windows that are not part of normal operations. The presence of known obfuscation signatures in JavaScript code. Unexpected outbound connections following script execution, particularly to suspicious IP addresses or domains. Creation of new JXA or JScript files in directories that do not typically contain scripts. |
| Questions for Analysis | Is there any record or justification for the execution of the script based on regular user activity? Are the scripts signed by a known developer, or are they unsigned/unknown? Does the timing of script execution correlate with the user's active hours or known maintenance windows? Are there any indicators of drive-by downloads, such as unusual browsing patterns or browser alerts? |
| Decision for Escalation | Escalate if scripts are executing unexpectedly, originating from suspicious domains, or showing evidence of obfuscation. Escalate if there is lateral movement or if script execution is followed by other suspicious activities like unusual file modifications or network connections to known malicious entities. |
| Additional Analysis Steps for L1 | Verify the legitimacy of the script origins using available threat intelligence sources. Correlate script execution with user activity logs to ascertain if the user was active during execution. Verify file hashes against threat databases, and analyze scripts for known malware patterns. Check for any correlating alerts from endpoint protection solutions around the script execution time. |
| T2 Analyst Actions | Conduct a deeper analysis of script content to identify obfuscation techniques and decode scripts if possible. Validate any network connections made by the script for potential C2 communications. Research any domains or IPs contacted for known associations with malicious activity. Examine process trees for spawned processes post script execution for further abnormal behavior. |
| Containment and Further Analysis | Isolate affected endpoints to prevent potential further script execution or data exfiltration. Use forensics tools to capture a snapshot of the system state for in-depth analysis. Remove or quarantine identified malicious scripts from the system. Review and update user privileges if scripts exploit user accounts. Implement network rules to block malignant domains or IPs identified during the analysis. |
