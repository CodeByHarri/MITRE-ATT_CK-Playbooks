# Hijack_Execution_Flow:_Services_File_Permissions_Weakness - T1574010

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Persistence, Privilege Escalation |
| MITRE TTP | T1574.010 |
| MITRE Sub-TTP | T1574.010 |
| Name | Hijack Execution Flow: Services File Permissions Weakness |
| Log Sources to Investigate | To investigate this TTP, focus on log sources such as Windows Event Logs, especially Security logs (Event ID 7045 for new service installation, Event ID 4656 for Handle Request for services related registry keys or binaries), Sysmon logs for file creation and modification (Event ID 11), and Service Control Manager logs for service changes or execution (Event ID 7036). Application logs where applicable in specific environments should also be checked to correlate unusual service activity. |
| Key Indicators | Key indicators include unexpected changes to service binaries, modification timestamps not aligning with legitimate updates, new services being added, existing services being altered (particularly set to automatically start), and binaries executed by services that are not typical for the process. Review of filesystem logs indicating overwriting or renaming activities in service-related directories. |
| Questions for Analysis | 1. Does the service binary file path point to an unexpected binary or location?<br>2. Is there a mismatch in the expected and current hash of service binaries?<br>3. Are there abnormal patterns of service start/stop activity? 4. Is there a correlation between service modification times and known benign user interactions or updates? 5. Has there been any recent anomalous login activity or privilege escalations? |
| Decision for Escalation | Escalate to Tier 2 if malicious alteration of service binaries is confirmed, unexpected new services are installed, suspicious patterns in service execution are observed, or forensic artifacts indicating persistence mechanisms are found. Also, escalate if there are indications of privilege escalation events aligning with service modifications. |
| Additional Analysis Steps for L1 | 1. Verify file hashes of affected or suspicious service binaries against known-good values.<br>2. Check user accounts responsible for initiating changes in service configurations.<br>3. Correlate timestamps with user activity or other security events. 4. Review system logs for related suspicious processes executed in the same timeframe. |
| T2 Analyst Actions | 1. Conduct deeper forensic analysis on the compromised host to identify other potential artifacts left by the adversary.<br>2. Analyze the replaced service binary to determine its function and possible network connections made by the system.<br>3. Assess compromise spread by looking at linked registry modifications or similar behaviors on connected systems. 4. Validate any alerting or correlated logs indicating heightened privilege access during service changes. |
| Containment and Further Analysis | 1. Isolate the affected system from the network to prevent lateral movement.<br>2. Restore any altered service binaries with clean versions from trusted sources.<br>3. Conduct a thorough system audit to remove any established persistence mechanisms. 4. Enhance monitoring on similar services and systems to detect related suspicious activity. 5. Report findings to internal security teams and consider reviewing or updating service configuration policies to prevent such weaknesses. |
