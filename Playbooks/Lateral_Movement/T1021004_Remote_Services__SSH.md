# Remote_Services:_SSH - T1021004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Lateral Movement |
| MITRE TTP | T1021.004 |
| MITRE Sub-TTP | T1021.004 |
| Name | Remote Services: SSH |
| Log Sources to Investigate | To investigate the use of SSH as described in T1021.004, focus on log sources such as server authentication logs (e.g., /var/log/auth.log on Linux or /var/log/secure), SSH server logs, and network traffic logs capturing SSH activity. These logs may reveal successful and failed login attempts, account names used, IP addresses of the clients connecting to the SSH service, and timestamps. For more centralized logging, SIEM solutions often collect these logs and can provide correlation capabilities to detect suspicious patterns involving SSH activity. |
| Key Indicators | Key indicators include the presence of failed and successful SSH login attempts from unusual or new IP addresses, accounts trying to log in at unusual hours, multiple failed attempts followed by a successful login (indicating possible brute-forcing), unusual transfers of files through SSH, or activity from accounts not typically using SSH. Additionally, check for changes in SSH configuration files or the presence of unauthorized public keys in the authorized_keys file. |
| Questions for Analysis | 1. Is the login originating from a known or unknown IP address?<br>2. Does the account regularly use SSH for remote access?<br>3. Are there records of failed login attempts prior to a successful one? 4. Does the login activity occur during normal business hours for the account in question? 5. Has there been any modification to SSH configuration or user account keys that are unexplained? |
| Decision for Escalation | Escalate to Tier 2 if you observe repeated failed login attempts followed by a successful login from abnormal or new IP addresses, especially if accounts are not familiar with regular SSH activity. Also escalate if SSH configuration changes or presence of unknown SSH keys are detected, indicative of potential compromise or persistence setup. |
| Additional Analysis Steps for L1 | Verify the intention and legitimacy of the current user sessions by contacting the user involved if possible. Check historical log data for patterns of normal user behavior. Review recent system updates or changes that might align with this activity. Validate the IP addresses by geolocating them or comparing them against known safe lists. |
| T2 Analyst Actions | Conduct a deeper forensic analysis on the affected systems to confirm unauthorized access. Check for signs of lateral movement or deployment of backdoors. Analyze related network traffic to identify any associated data exfiltration attempts. Look into environmental-wide usage of SSH to identify any other compromised nodes or unusual patterns. |
| Containment and Further Analysis | If compromise is confirmed, immediately isolate the affected system from the network to prevent further unauthorized access. Disable the compromised account or change credentials and invalidate all cryptographic tokens or keys used. Conduct a full scan for malicious software and rootkits, review and tighten SSH configurations (e.g., disabling password authentication in favor of key-based authentication), and deploy intrusion detection systems monitoring for future unauthorized SSH activities. |
