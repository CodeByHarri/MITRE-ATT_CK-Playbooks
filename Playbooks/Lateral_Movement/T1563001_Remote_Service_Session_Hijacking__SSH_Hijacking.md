# Remote_Service_Session_Hijacking:_SSH_Hijacking - T1563001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Lateral Movement |
| MITRE TTP | T1563.001 |
| MITRE Sub-TTP | T1563.001 |
| Name | Remote Service Session Hijacking: SSH Hijacking |
| Log Sources to Investigate | For detecting SSH hijacking, examine SSH server logs, auth logs (e.g., /var/log/auth.log or /var/log/secure), and process creation logs. Explore user interaction logs, which include login attempts, session establishment records, and any discrepancies in user activity patterns. Network traffic logs should be monitored for unusual SSH traffic patterns such as multiple sessions from a single IP or unusual times of access. Endpoint detection logs capturing process executions and access to SSH agent sockets are also critical. |
| Key Indicators | Indicators include: log entries showing unexpected or concurrent logins from the same user; SSH sessions originating from unusual IP addresses; anomalies in typical user access times; presence of SSH agent forwarded sockets; unexpected creation of SSH processes; and mismatches or anomalies in SSH session duration compared to typical activity. |
| Questions for Analysis | Is the SSH session originating from a suspected IP address? Are there multiple simultaneous sessions for a single user? Is there evidence of SSH agent forwarding? Are there indicators of privilege escalation activities on the same host? Are there logs of unauthorized access to SSH key files or agent sockets? |
| Decision for Escalation | Escalate to Tier 2 if there are genuine indications of unauthorized SSH session access, especially if there's evidence of simultaneous sessions, abnormal geographic access patterns, or linkage to known malicious IPs. Escalation is also required if there is corroborating evidence of additional lateral movement or privilege escalations. |
| Additional Analysis Steps for L1 | Verify the user's typical SSH login behavior, such as access times and source IPs. Correlate auth logs with network logs to identify unusual session initiations. Check for signs of SSH agent forwarding, such as environment variable analysis. Review any related alerts for unauthorized access attempts or failed login attempts leading up to the session. |
| T2 Analyst Actions | Conduct a deeper forensic analysis on the affected system(s) to check for compromise related to SSH key files or agents. Evaluate patterns in historical access logs and cross-reference with known threat intelligence on IPs and behaviours. Utilize SIEM to search for similar indicators across the environment. Perform memory analysis for signs of potential in-memory exploits related to SSH. |
| Containment and Further Analysis | Immediately terminate the suspected hijacked SSH sessions. Change the credentials associated with potentially compromised accounts and review related account permissions. Disable SSH agent forwarding wherever possible and ensure public key authentication is strictly controlled. Conduct a network isolation of the potentially compromised system for deep analysis, checking for residual malicious binaries or scripts. Initiate a threat intelligence analysis to understand the scope of the adversary's capabilities and objectives, applying IOCs across the environment. |
