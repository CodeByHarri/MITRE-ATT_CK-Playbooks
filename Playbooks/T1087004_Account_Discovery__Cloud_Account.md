# Account_Discovery:_Cloud_Account - T1087004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1087.004 |
| MITRE Sub-TTP | T1087.004 |
| Name | Account Discovery: Cloud Account |
| Log Sources to Investigate | Log sources relevant to T1087.004 include: <br>1. Cloud service provider logs such as AWS CloudTrail, Azure Activity Logs, and Google Cloud Audit Logs for monitoring activities related to account listings and role enumerations. <br>2. Authentication logs from identity providers like Azure AD, AWS IAM, and GCP IAM to trace user authentication activities. <br>3. PowerShell logs for commands such as Get-MsolRoleMember, including ScriptBlockLogging and Module logs in Windows Event Logs. <br>4. Command line activity logs to capture execution of Azure CLI or AWS CLI commands. |
| Key Indicators | Key indicators include: <br>1. Execution of commands like az ad user list, aws iam list-users, aws iam list-roles, gcloud iam service-accounts list, and gcloud projects get-iam-policy. <br>2. Elevated privileges or unusual authenticated access used in conjunction with account enumeration commands. <br>3. Unusual execution patterns of these commands, such as being run from IPs not typically associated with administrative tasks. <br>4. Failed attempts or repeated attempts to execute these commands. |
| Questions for Analysis | 1. Is the source of the command execution from a suspicious or unexpected IP address? <br>2. Were any privilege escalation attempts observed prior to these activities? <br>3. Do the timestamps of these activities correlate with legitimate administrative or operational tasks? <br>4. Is the account used to execute these commands known and authorized to perform such tasks? |
| Decision for Escalation | Escalate to Tier 2 if: <br>1. The command execution is from an unfamiliar or unauthorized IP address. <br>2. Unusual patterns of access or behavior are observed (e.g., execution by non-administrative accounts). <br>3. There are additional indicators of compromise or lateral movement suggesting a coordinated attack. <br>4. Repeated failed attempts or brute-force patterns are observed in authentication or command execution logs. |
| Additional Analysis Steps for L1 | 1. Verify if there are legitimate business reasons for account enumeration activities. <br>2. Check related logs for signs of privilege escalation preceding the account discovery. <br>3. Confirm the legitimacy of the user account and permissions involved in the activities. <br>4. Review any associated alerts for a broader picture of potential malicious activity. |
| T2 Analyst Actions | 1. Deep dive into network logs and correlate IP addresses and geolocations with known entities or previous incidents. <br>2. Investigate recent changes in IAM policies and roles that could facilitate unauthorized access. <br>3. Review endpoint logs for evidence of persistence techniques or lateral movement. <br>4. Conduct a risk assessment based on the scope of access that may have been obtained. |
| Containment and Further Analysis | 1. Isolate accounts or systems if an unauthorized breach is detected. <br>2. Implement temporary access controls or MFA for suspected accounts until the investigation is concluded. <br>3. Notify affected departments or stakeholders about the potential compromise and take steps to secure sensitive data. <br>4. Conduct a post-mortem analysis to determine root cause and improve detection mechanisms for future account discovery activities. |
