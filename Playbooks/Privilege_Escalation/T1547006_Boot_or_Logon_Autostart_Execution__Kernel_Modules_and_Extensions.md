# Boot_or_Logon_Autostart_Execution:_Kernel_Modules_and_Extensions - T1547006

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1547.006 |
| MITRE Sub-TTP | T1547.006 |
| Name | Boot or Logon Autostart Execution: Kernel Modules and Extensions |
| Log Sources to Investigate | Relevant log sources include system logs such as /var/log/syslog or /var/log/messages for Linux systems, which may include entries related to module load and unload events. On macOS, kext-related logs can be found in system logs accessible via the Console app, particularly under /var/log/system.log. Security solutions that monitor kernel-level activities should also be reviewed. Additionally, consider reviewing file integrity monitoring logs for changes in directories typically associated with modules like /lib/modules/ in Linux. |
| Key Indicators | Indicators of malicious loadable kernel modules or kext include unexpected or unauthorized loading of kernel modules, discrepancies in loaded module signatures, changes to critical kernel module directories without corresponding legitimate administrative tasks, system instability or crashes, and hidden processes or files. Look for indications of log tampering or unusual network activity with elevated privileges. |
| Questions for Analysis | Is there evidence that the LKM or kext was loaded by a non-privileged user? Was the LKM or kext signed with a recognized developer ID? Are there logged activities or file changes that correspond to known malicious behavior or correlate with known attack indicators from threat intelligence? Have there been any recent system reboots or stability issues that align with these logs? |
| Decision for Escalation | Escalate if an LKM or kext is loaded without corresponding administrative action or approval, if signatures are invalid or unknown, if the module performs actions typically associated with rootkits, or if thereâ€™s evidence of log tampering or other associated suspicious activities. Anomalous behavior patterns or deviations from baseline activities should also result in escalation. |
| Additional Analysis Steps for L1 | Verify the legitimacy of loaded modules against known good configurations and baselines. Cross-reference with known threat indicators and validate the signatures of suspicious kexts. Check for any sudden changes in system performance or unexplained reboots. Review any associated warning or error messages in system logs around the time of the event. |
| T2 Analyst Actions | Perform in-depth analysis of the suspect LKM or kext, confirming malicious functionality. Use forensic tools to inspect file integrity and search for other potential persistence mechanisms. Investigate related processes, files, and network connections for contextual indicators of compromise. Correlate with global threat intelligence feeds to establish links to known campaigns or actors. |
| Containment and Further Analysis | If a malicious kernel module or kext is confirmed, initiate containment by safely unloading the module using appropriate commands (e.g., rmmod for Linux, kextunload for macOS) while ensuring system stability. Consider options for isolating the affected system to prevent further compromise. Follow up with a thorough forensic analysis to determine the impact scope, including potential privilege escalation or persistence attempts, and update defensive measures accordingly. |
