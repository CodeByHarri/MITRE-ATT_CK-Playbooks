# Boot_or_Logon_Initialization_Scripts:_Logon_Script_(Windows) - T1037001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1037.001 |
| MITRE Sub-TTP | T1037.001 |
| Name | Boot or Logon Initialization Scripts: Logon Script (Windows) |
| Log Sources to Investigate | Collect logs from Windows Event Logs, particularly Security Event Log for logon events (Event IDs 4624, 4625) and Sysmon logs for Registry changes (Event ID 13). Monitor changes to the HKCU\Environment\UserInitMprLogonScript Registry key. Additionally, gather endpoint detection and response (EDR) logs to track script executions and potential anomalous behaviors associated with known user and system processes. |
| Key Indicators | Monitor for unusual changes to HKCU\Environment\UserInitMprLogonScript registry key, new or altered logon scripts in the file system (e.g., C:\Scripts, %USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup). Presence of script files (.bat, .cmd, .ps1) in these paths, executed by unexpected users or during unusual logon times. Sudden spikes in script execution activity or deviation from normal user script-associated tasks. |
| Questions for Analysis | Is the logon script change in the environment intended or documented by IT? Is the script file newly created, modified, or accessed by atypical users? What is the content of the script, are there any malicious or unusual commands present? Are the timestamps of script modification or execution aligning with a legitimate user logon activity? |
| Decision for Escalation | Escalate to Tier 2 if the script files contain suspicious or non-business related commands, particularly those related to network scanning, data exfiltration, or credential dumping. If there is no documented change request or explanation from IT, and if the script execution is associated with known malicious patterns or occurs on multiple systems in a short timeframe. |
| Additional Analysis Steps for L1 | Identify the source IP and user account associated with the logon script change. Review related user activity around the timestamp of the change. Check whether the affected system has a history of similar modifications. Validate the authenticity of the logon script file with a hash comparison against known good scripts. |
| T2 Analyst Actions | Perform deeper investigation using EDR tools to trace the origin and impact of the scripts. Analyze the contents of the scripts for malicious payloads or commands. Cross-correlate with threat intelligence to identify any known patterns or indicators of compromise. Verify whether the script modifications are linked to any unauthorized software or unsanctioned remote access attempted. |
| Containment and Further Analysis | Isolate affected systems to prevent further propagation, especially if evidence of lateral movement is detected. Roll back any unauthorized registry changes and remove malicious or suspicious logon scripts. Conduct a full malware scan and forensic disk analysis to ensure no residual threats remain. Collaborate with IT to patch any identified vulnerabilities exploited and strengthen script management controls. |
