# Boot_or_Logon_Initialization_Scripts - T1037

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1037 |
| MITRE Sub-TTP | T1037 |
| Name | Boot or Logon Initialization Scripts |
| Log Sources to Investigate | Collect and analyze logs from the following sources: <br>1. Windows Event Logs, specifically Security and System logs, to track logon activity and identify the execution of scripts.<br>2. Sysmon logs, to correlate process creation events with unusual script executions.<br>3. PowerShell logs, especially if PowerShell scripts are used for initialization.<br>4. File integrity monitoring logs, to detect changes in boot or logon script files (e.g., Windows startup folder, rc.local, crontab).<br>5. Endpoint Detection and Response (EDR) platform logs to capture script execution, process creation related to startup items, and privilege escalations.<br>6. Authentication logs if available, to detect potentially malicious logon events.<br>7. Cron job logs on Unix/Linux systems for changes in scheduled tasks linked to logon events. |
| Key Indicators | 1. Modification of startup items, such as entries in the Windows Registry Run keys or the startup folder.<br>2. Presence of unusual scripts or newly created files in startup directories like /etc/init.d, /etc/rc.local, crontab, or Windows startup folder.<br>3. Unusual or new accounts executing logon scripts.<br>4. High privileged process creation events that originate from known or suspicious scripts.<br>5. Execution of scripts at unusual frequencies or times, indicating potential persistence techniques.<br>6. Anomalous behavior observed in processes such as elevated privilege levels or network communication initiated by startup scripts. |
| Questions for Analysis | 1. Is there any deviation from the standard configuration or expected scripts in startup directories?<br>2. Are there any unauthorized changes to startup items or entries?<br>3. Is the executing account or script associated with known suspicious behavior or external threat intelligence?<br>4. Have there been recent privilege escalations or unusual activity linked to startup scripts?<br>5. Are there any known vulnerabilities associated with the scripts or methods used for logon initialization? |
| Decision for Escalation | Escalate to Tier 2 if:<br>1. There are confirmed unauthorized changes to critical boot or logon scripts.<br>2. If suspicious activity is linked to known threat actors or reported exploits (e.g., via threat intelligence).<br>3. If there are indicators of compromise or evidence suggesting privilege escalation attempts.<br>4. Detection involves a high-profile or sensitive system that could risk business operations. |
| Additional Analysis Steps for L1 | 1. Verify the legitimacy of changes in startup folders and logon scripts using baseline configurations.<br>2. Check user account activities for anomalies around the timeframe of the script modifications.<br>3. Analyze related process trees to check for chained process executions post-initialization.<br>4. Cross-reference observations with updated threat intelligence sources to check for known TTPs.<br>5. Report findings and initiate containment if immediate threats are identified. |
| T2 Analyst Actions | 1. Conduct a detailed forensic analysis of affected systems, focusing on timeline correlation and additional script changes.<br>2. Review endpoint telemetry data for anomalies or execution patterns tying to detected scripts.<br>3. Investigate similar scripts or changes across other systems on the network to identify lateral movement.<br>4. Ensure all detection tools and signatures are updated with any new IoCs discovered.<br>5. Coordinate with IT to amend configurations or scripts to prevent reoccurrence of the unauthorized changes. |
| Containment and Further Analysis | 1. Isolate compromised systems to prevent further unauthorized access or escalation.<br>2. Rollback unauthorized changes to boot or logon scripts and restore from known good backups.<br>3. Perform a full malware sweep on impacted systems, specifically targeting directories and processes associated with script execution.<br>4. Implement additional monitoring measures on startup scripts and critical user accounts.<br>5. Conduct a thorough review of access controls and permissions, especially if escalation was involved, and apply necessary changes. |
