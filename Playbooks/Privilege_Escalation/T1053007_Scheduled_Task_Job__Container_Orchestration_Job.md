# Scheduled_Task_Job:_Container_Orchestration_Job - T1053007

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Execution, Persistence, Privilege Escalation |
| MITRE TTP | T1053.007 |
| MITRE Sub-TTP | T1053.007 |
| Name | Scheduled Task/Job: Container Orchestration Job |
| Log Sources to Investigate | To investigate potential abuse of container orchestration job scheduling such as Kubernetes CronJobs, analysts should collect and examine logs from the following sources: Kubernetes API server logs, Kubernetes scheduler logs, container runtime logs (e.g., Docker logs), and cloud provider logs if the containers are running in a cloud environment. These logs could provide evidence of irregular or suspicious CronJob creations or modifications. Additionally, monitoring solutions like Prometheus can track resource utilization metrics, which might indicate abnormal container behavior. |
| Key Indicators | Key indicators of potential malicious activity include: unexpected creation or modification of CronJobs within Kubernetes, running of jobs at odd times that do not align with regular maintenance schedules, configuration of jobs to execute within privileged contexts or namespaces, unusual spikes in resource utilization associated with specific containers, and connections to command and control servers from within containerized environments. |
| Questions for Analysis | 1. Was the CronJob creation or modification requested by a known administrator or a previously registered service account?<br>2. Is there an unusual pattern of job scheduling that does not align with known maintenance windows?<br>3. Have there been any correlated alerts from network security monitoring tools indicating suspicious outbound traffic from the container? 4. Are there any indications that the job is running with higher privileges than necessary? 5. Is there a prior history of similar suspicious activity associated with the same namespace or cluster? |
| Decision for Escalation | Escalate to Tier 2 if: There is evidence that the container job has executed commands or accessed data beyond its intended scope (e.g., signs of lateral movement within clusters), if there's confirmation of communication with a known malicious IP/Domain, if unauthorized users have modified the CronJob schedule, or if there is uncertainty regarding the job's origin and it has potential security implications by running with elevated privileges. |
| Additional Analysis Steps for L1 | 1. Cross-reference the timing of CronJob activities with known scheduled tasks or maintenance windows.<br>2. Check for any corresponding authentication logs that might show unauthorized access attempts.<br>3. Verify the user's credentials and access logs involved in creating or modifying the CronJob. 4. Isolate telemetry data such as CPU/RAM spikes that could correlate with the scheduled job's execution. 5. Use a threat intelligence platform to check for indicators of compromise related to the traffic from the suspect container. |
| T2 Analyst Actions | 1. Conduct a deeper investigation into the environment to identify any lateral movement attempts from the nodes running suspicious containers.<br>2. Evaluate past behavior of the service accounts linked with the CronJob for historical anomalies.<br>3. Conduct a risk assessment of systems potentially affected by the suspicion operation of these containers. 4. Work with the cloud provider to acquire additional information such as network flow logs or snapshots of affected instances. |
| Containment and Further Analysis | 1. Immediately isolate the suspected container(s) to prevent potential spread across the cluster.<br>2. Disable or remove the malicious CronJob from the schedule.<br>3. Conduct a forensic analysis of activity logs and configuration files within the affected nodes and containers. 4. Review Kubernetes role-based access control (RBAC) policies to tighten any overly permissive permissions. 5. Implement continuous monitoring and set up alerts for specific anomalous behaviors associated with container orchestration. 6. Apply necessary security patches or updates in the container images and Kubernetes components. |
