# Event_Triggered_Execution:_Application_Shimming - T1546011

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1546.011 |
| MITRE Sub-TTP | T1546.011 |
| Name | Event Triggered Execution: Application Shimming |
| Log Sources to Investigate | 1. Windows Event Logs: Check for events related to application compatibility or shim database loading. <br>2. File System Monitoring: Monitor changes to %WINDIR%\AppPatch\sysmain.sdb and custom database paths. <br>3. Registry Monitoring: Track changes to hklm\software\microsoft\windows nt\currentversion\appcompatflags\installedsdb and custom. <br>4. Process Monitoring: Identify unusual processes or services loading DLLs or executing from shimmed paths. <br>5. Security Software Logs: Review any alerts or detections related to shim abuse or privilege escalation. |
| Key Indicators | 1. New or modified entries in shim databases or registry keys. <br>2. Execution of sdbinst.exe with unusual or unsanctioned parameters. <br>3. Unexplained DLL injections into processes. <br>4. Presence of non-standard or unexpected custom .sdb files in %WINDIR%\AppPatch\custom or AppPatch64\Custom. <br>5. Attempts to disable security features or services using known shimming methods. |
| Questions for Analysis | 1. Are there recent changes or creations of shim database or registry entries related to appcompatflags? <br>2. Is there evidence of sdbinst.exe being executed without any sanctioned purpose or user action? <br>3. Are there records of non-standard DLLs being injected or loaded by trusted processes? <br>4. Are there any alerts from antivirus or security tools regarding shim-related threats? <br>5. Has there been any attempt to bypass security restrictions like UAC using shims? |
| Decision for Escalation | Escalate if: <br>1. Unapproved modifications to shim databases or registry are identified. <br>2. Evidence of privilege escalation or execution of malicious content through shims is found. <br>3. Confirmation of attempts to disable critical security services through shims. <br>4. Unusual DLL injections are occurring in critical or sensitive processes. |
| Additional Analysis Steps for L1 | 1. Verify that changes to shim databases or registry are sanctioned or expected. <br>2. Review recent logins or user actions around the time of suspicious shim activity. <br>3. Cross-check with known vectors or patterns for shim exploitation present in threat intelligence. <br>4. Gather evidence of process behaviors leading up to or following shim-related modifications. |
| T2 Analyst Actions | 1. Conduct a deeper investigation of shim database or registry modifications for malicious indicators. <br>2. Analyze process dumps and memory captures for evidence of injected malicious code. <br>3. Cross-reference process behaviors with threat intelligence databases for known exploits or attackers. <br>4. Collaborate with IT and security personnel to determine the impact and scope of shim modifications. |
| Containment and Further Analysis | 1. Isolate affected systems from the network to prevent further exploitation. <br>2. Review and potentially remove unauthorized shim entries from databases and registry. <br>3. Run comprehensive malware scans and perform rootkit checks on impacted systems. <br>4. Implement stricter monitoring on application compatibility and shim databases systemwide. |
