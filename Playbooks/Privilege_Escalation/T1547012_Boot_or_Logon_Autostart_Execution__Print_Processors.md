# Boot_or_Logon_Autostart_Execution:_Print_Processors - T1547012

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1547.012 |
| MITRE Sub-TTP | T1547.012 |
| Name | Boot or Logon Autostart Execution: Print Processors |
| Log Sources to Investigate | Examine Windows Event Logs, particularly Application and System logs, for events related to the print spooler service 'spoolsv.exe'. Look for suspicious DLL loads in the context of the print spooler using Event ID 7036 (Service Control Manager) for service state changes and Event ID 4657 (Registry Value Change) to track registry modifications under 'HKLM\SYSTEM\CurrentControlSet\Control\Print\Environments'. Analyze Windows Security logs for unusual logon or privilege escalation activity related to 'SeLoadDriverPrivilege'. |
| Key Indicators | Presence of unusual or non-standard DLLs in the system print-processor directory. Registry modifications related to 'HKLM\SYSTEM\[CurrentControlSet or ControlSet001]\Control\Print\Environments\[Windows architecture]\Print Processors'. Event logs showing 'spoolsv.exe' loading uncommon DLLs. Use of 'AddPrintProcessor' API and 'GetPrintProcessorDirectory' API calls traced in application usage logs. |
| Questions for Analysis | Have there been recent changes to print processor registry keys or print processor files? Does the spooler service load any DLLs not typically associated with print processing tasks? Are there any corresponding privilege escalation or unusual logon events? Is the 'SeLoadDriverPrivilege' enabled for users not typically requiring it? |
| Decision for Escalation | Escalate to T2 if there are registry manipulatory activities pointing to unauthorized DLLs, if SYSTEM privileges are detected running unknown DLLs, or if anomalous API calls like 'AddPrintProcessor' are invoked by non-standard accounts or processes. If any suspicious files are located in the print-processor directory, escalate immediately. |
| Additional Analysis Steps for L1 | Cross-reference the DLL names from the print-processor directory with known malicious hashes or threat intelligence feeds. Verify system integrity by correlating current registry settings against baselines for unauthorized modifications. Review user access patterns and correlate with recent changes within print processor settings. |
| T2 Analyst Actions | Conduct a deeper forensic analysis of the DLLs identified in the print processor directory, including static and dynamic malware analysis. Investigate process trees originating from 'spoolsv.exe' for any suspicious child processes or network activity. Consider utilizing a sandbox environment to test DLL behaviors. Engage with threat hunting teams to identify any lateral movement or additional persistence mechanisms. |
| Containment and Further Analysis | Quarantine or delete any unauthorized DLLs and restore affected registry keys from backups if necessary. Disable suspicious print processors and restart the print spooler in a controlled manner. Perform a full system scan using updated antivirus and endpoint detection solutions. Review and tighten security policies related to 'SeLoadDriverPrivilege' and ensure only necessary accounts have the privilege. Monitor for recurring signs of compromise and potential re-entry vectors. |
