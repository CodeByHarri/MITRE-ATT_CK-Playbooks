# Scheduled_Task_Job:_At - T1053002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Execution, Persistence, Privilege Escalation |
| MITRE TTP | T1053.002 |
| MITRE Sub-TTP | T1053.002 |
| Name | Scheduled Task/Job: At |
| Log Sources to Investigate | Investigate logs related to task scheduling and command execution across affected systems. For Windows, focus on Event Logs such as the Task Scheduler Operational log (Applications and Services Logs > Microsoft > Windows > TaskScheduler > Operational), Security logs for privilege use (Event IDs 4698, 4701, 4702), and Windows Management Instrumentation (WMI) logs. For Linux and macOS, check system logs (e.g., /var/log/syslog, /var/log/messages) and user shell history files that might log the use of the `at` command. |
| Key Indicators | Look for commands that execute the `at` utility, such as commands scheduling tasks (e.g., 'at 2:00 PM'), modifications to `/etc/at.allow` or `/etc/at.deny` on Linux/macOS, unexpected user accounts (especially non-admin) using the `at` command, and the execution context of these tasks to determine if they are running with elevated privileges. |
| Questions for Analysis | Is there a legitimate application or process that requires scheduling using `at` at the reported time? Is the account utilizing the `at` command typical in its task scheduling behavior? Have similar tasks been scheduled by this user before? Are there known system or network changes that could justify this activity? |
| Decision for Escalation | Escalate to Tier 2 if the `at` command is used by an unauthorized or non-typical account, if tasks are set to execute unauthorized scripts or binaries, or if there are indications of privilege escalation attempts. Escalate if analysis reveals lateral movement attempts or scheduled tasks align with known malware or attack patterns. |
| Additional Analysis Steps for L1 | Verify the legitimacy of tasks created using the `at` command by cross-referencing user accounts and correlating with asset management data. Review any associated scripts or executables for signs of malicious activity. Check for anomalies in related system authentication logs, and confirm if there are any recent additions to `/etc/at.allow` or deletions in `/etc/at.deny` files. |
| T2 Analyst Actions | Perform a deeper forensic analysis of affected systems to understand the scope of the action taken using `at`. Analyze any payloads or scripts found in scheduled tasks for obfuscated code or suspicious network activity. Utilize threat intelligence databases to match observed behaviors with known patterns or IOCs. Assess if there is potential lateral movement by reviewing network logs. |
| Containment and Further Analysis | Isolate affected endpoints to prevent further spread. Disable or delete suspicious tasks scheduled via the `at` utility. Conduct a thorough analysis of system changes made around the time of `at` task creation. Implement endpoint monitoring to alert on future unauthorized task scheduling attempts. Prepare a detailed report on findings and suggest mitigation strategies, such as reinforcing least privilege access for task scheduling. |
