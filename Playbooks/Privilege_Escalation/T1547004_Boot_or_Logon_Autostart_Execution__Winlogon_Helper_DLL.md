# Boot_or_Logon_Autostart_Execution:_Winlogon_Helper_DLL - T1547004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1547.004 |
| MITRE Sub-TTP | T1547.004 |
| Name | Boot or Logon Autostart Execution: Winlogon Helper DLL |
| Log Sources to Investigate | Collect and review Windows Security Event Logs, particularly focusing on Logon and Logoff events that may show unexpected activity. Monitor Windows Registry access logs with a focus on changes to HKLM\Software[\Wow6432Node\]\Microsoft\Windows NT\CurrentVersion\Winlogon\ and HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\ registry keys. Use Sysmon logs for process creation events to detect abnormal processes spawned by Winlogon. Evaluate EDR or AV logs that provide insights into unauthorized DLL or executable loads. Review any logs from software inventory tools that may detect unexpected DLLs in critical system paths. |
| Key Indicators | Presence of suspicious or unfamiliar DLLs set in Winlogon\Notify registry subkey. Unexpected or unknown paths associated with userinit.exe or shell programs in the Winlogon\Userinit and Winlogon\Shell registry keys. Sudden changes or frequent modifications to critical Winlogon registry keys. Detection of non-standard processes initiated by Winlogon.exe through Sysmon Event ID 1 (process creation). Anomalous user behaviors surrounding logon hours correlating with unauthorized changes. |
| Questions for Analysis | Are there any unauthorized modifications or unusual values appearing in the Winlogon registry subkeys? Have any processes been initiated by Winlogon.exe that are not typically associated with this activity, such as non-standard DLLs? Are there associated logs showing the origin of the change, such as user account or source machine? Is there a legitimate reason or recent application installation/update that might have caused these changes? |
| Decision for Escalation | Escalate to Tier 2 if there are confirmed unauthorized changes to Winlogon registry keys, especially those pointing to non-standard or suspicious DLL paths. Escalate if associated processes are linked to known malicious indicators or if an associated account shows signs of compromise or anomalous behavior. |
| Additional Analysis Steps for L1 | Verify with the user or system owner if any legitimate software installations or updates occurred in the timeframe of the log entries. Cross-reference detected DLLs or executables with known vendor paths or hashes. Conduct a basic threat intelligence search on flagged DLL names or hashes to identify known bad actors. Document any anomalies carefully before escalating. |
| T2 Analyst Actions | Perform detailed forensic analysis on the affected system to confirm unauthorized changes or detect persistence mechanisms. Use advanced threat intelligence databases to identify whether flagged artifacts are linked to known threats. Analyze network logs for lateral movement or communications with known malware command and control servers. Validate whether malware has altered the loading order of processes initiated by Winlogon. |
| Containment and Further Analysis | Quarantine the affected system(s) to prevent further execution of the malicious code. Remove unauthorized registry entries and restore default Winlogon settings if deemed safe. Conduct a comprehensive scan for further malware presence. Review and enhance endpoint protection configurations to prevent recurrence and examine any patch compliance gaps that may have been exploited. Notify relevant internal teams such as threat intelligence and security operations for broader threat actor analysis or targeted defense improvements. |
