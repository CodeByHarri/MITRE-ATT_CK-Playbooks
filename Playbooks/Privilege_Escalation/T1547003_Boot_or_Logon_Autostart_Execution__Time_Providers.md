# Boot_or_Logon_Autostart_Execution:_Time_Providers - T1547003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1547.003 |
| MITRE Sub-TTP | T1547.003 |
| Name | Boot or Logon Autostart Execution: Time Providers |
| Log Sources to Investigate | Collect and examine Windows event logs, particularly Security, System, and Application logs. Investigate specific logs related to service creation and modification events (Event ID 7045 for a new service, and Event ID 4697 for a service installation). Also, examine registry change events (Event ID 4657) that pertain to changes within the `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\` registry path. Monitor File Access logs for unusual DLL loads, especially those related to W32Time or similar services. |
| Key Indicators | Unusual subkey creation under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\` that does not match known time providers. Presence of DLLs with unexpected names or locations being loaded by the W32Time service. New entries in service or registry logs corresponding with system startup without prior approval or explanation. Associated file changes or unauthorized DLL execution in the context of the Local Service account. |
| Questions for Analysis | Is the newly registered time provider subkey an approved entry? Is there an abnormal pattern of DLL execution involving W32Time? Is the associated DLL signed, and does it match known and approved software? Have any associated alerts or anomalies been triggered in relation to this activity in the past? Are there other related suspicious activities in the system logs? |
| Decision for Escalation | Escalate to Tier 2 if the analyzed DLL is unsigned, resides in an unusual directory or lacks verification, any lateral movement indications, or if the W32Time-related modifications do not align with typical system configurations or approved changes. Escalate also if related anomalies indicate potential compromise such as unauthorized privilege escalation or repeated suspicious registry key modifications. |
| Additional Analysis Steps for L1 | Verify if the newly created subkey under W32Time is correlated with approved administrative changes. Lookup the DLL file hash in threat intelligence databases to check for known threats. Check if there are any recent administrative activities or maintenance logs that account for these changes. Correlate with any open incident tickets that might explain system changes. |
| T2 Analyst Actions | Perform a deeper forensic analysis on the affected system to determine how the malicious DLL was introduced. Analyze network traffic for suspicious outbound connections possibly related to the DLL activity. Verify against whitelist of legitimate time provider DLLs and ensure the validity of file signatures. Conduct User Activity Monitoring for any abnormal activities preceding the suspicious changes. |
| Containment and Further Analysis | Isolate the affected machine from the network to prevent potential lateral movement. Quarantine and analyze the malicious DLL using sandbox environments. Perform a comprehensive review of similar systems within the environment for signs of similar registry modifications. Clean or restore the affected registry entries to a state consistent with organization-operated standards. Patch or update the affected systems to prevent re-exploitation using the same TTP. |
