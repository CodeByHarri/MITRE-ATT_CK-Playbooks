# Boot_or_Logon_Autostart_Execution:_Active_Setup - T1547014

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1547.014 |
| MITRE Sub-TTP | T1547.014 |
| Name | Boot or Logon Autostart Execution: Active Setup |
| Log Sources to Investigate | 1. Windows Registry logs via Sysmon or native Windows Event Logs to monitor changes under HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\, especially any additions or modifications to the StubPath key.<br>2. Endpoint Detection and Response (EDR) solutions to detect suspicious process creations stemming from user login events.<br>3. Security Information and Event Management (SIEM) for correlation of registry key modifications with suspicious user behavior or login activities. 4. System boot and user logon events to trace back any unconventional execution processes and anomalous program launches. |
| Key Indicators | 1. New or modified registry entries under HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\, particularly the StubPath key with non-standard or unexpected executable paths.<br>2. Execution of processes post-logon that do not match baseline user activity or software inventory.<br>3. Rapid changes in StubPath values that coincide with user logon event timestamps. 4. Processes linked to known-malicious hash values or marked as using Masquerading techniques. |
| Questions for Analysis | 1. Was there a recent modification to the Active Setup keys prior to the suspicious user login?<br>2. Does the StubPath value point to a binary or script that is known to be malicious or unrecognized?<br>3. Is there any correlation between the flagged user's activity with known threat actor techniques or behaviors? 4. Are there other indications of compromise on the system tied to the detected registry change? |
| Decision for Escalation | Escalate to Tier 2 if: 1. The StubPath value points to an executable not verified via corporate software inventory.<br>2. Thereâ€™s evidence of Masquerading or registry keys mimic legitimate software entries but deviate from known baselines.<br>3. Multiple endpoints are exhibiting similar suspicious registry modifications. 4. There are concurrent or prior alerts of suspicious activities from the same endpoint or user. |
| Additional Analysis Steps for L1 | 1. Validate the legitimacy of the executable or script listed in the StubPath field against corporate software inventories.<br>2. Review system and security logs for any login anomalies or system change events surrounding the modification.<br>3. Cross-reference any involved executables with threat intelligence databases for known bad indicators. 4. Document all unusual activity and prepare an initial report of observed behaviors and indicators. |
| T2 Analyst Actions | 1. Conduct a deeper forensic analysis on the modified registry key to understand the full scope of changes.<br>2. Utilize sandboxing technologies to execute the suspect binaries in a controlled environment and monitor behavior.<br>3. Investigate user activity patterns to determine if credentials have been compromised or if there is internal misuse. 4. Collaborate with threat intelligence teams to discern patterns that match known TTPs of active threat groups. |
| Containment and Further Analysis | 1. Isolate the affected system from the network to prevent lateral movement if malicious behavior is confirmed.<br>2. Remove or restore the altered registry keys to default values post-threat neutralization while ensuring system complies with enterprise policies.<br>3. Update EDR rules and SIEM alerts to better detect similar future activities across the network. 4. Conduct a full malware sweep on associated systems to identify any further persistence mechanisms or dropped artifacts. |
