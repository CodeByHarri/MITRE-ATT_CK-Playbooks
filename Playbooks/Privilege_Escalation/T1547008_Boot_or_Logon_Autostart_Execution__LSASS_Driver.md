# Boot_or_Logon_Autostart_Execution:_LSASS_Driver - T1547008

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1547.008 |
| MITRE Sub-TTP | T1547.008 |
| Name | Boot or Logon Autostart Execution: LSASS Driver |
| Log Sources to Investigate | Investigate the following log sources: <br>1. Windows Security and System Event Logs: Look for events related to driver installations or changes, particularly those involving LSASS or related processes (e.g., Event ID 7045 for new service installations).<br>2. Application Logs: Check for logs indicating changes to LSASS drivers, especially unauthorized or unexpected modifications.<br>3. Windows Process Monitoring: Monitor process creation events, focusing on any unusual instance of lsass.exe starting with unexpected parameters or loading non-standard DLLs.<br>4. File Integrity Monitoring (FIM) Logs: Review logs for unauthorized changes or additions to critical files associated with the LSASS subsystem.<br>5. Security Information and Event Management (SIEM) Solutions: Correlate logs from various sources to identify patterns indicative of LSASS driver manipulation. |
| Key Indicators | Key indicators include:<br>1. Unusual driver installations or modifications in LSASS directories.<br>2. Presence of non-standard DLLs or drivers associated with LSASS.<br>3. Unexpected process behaviors or startup of lsass.exe.<br>4. Event ID 7045 indicating new or altered driver services linked to LSASS.<br>5. Anomalies in checksum or signature of critical LSASS-related files. |
| Questions for Analysis | Questions to assess legitimacy include:<br>1. Is there a record of legitimate maintenance or updates that justify the changes in LSASS drivers?<br>2. Are there any known software or updates recently installed that might account for the modifications?<br>3. Are the modified or newly added drivers signed with a legitimate certificate?<br>4. Have similar activities been observed in other systems within the network that might indicate a larger pattern? |
| Decision for Escalation | Escalate to Tier 2 if:<br>1. There is no legitimate reason for LSASS driver modification or replacement.<br>2. Detected modifications originate from unknown or suspicious sources.<br>3. Modified drivers lack valid digital signatures.<br>4. Activity correlates with other malicious indicators or alerts in the network. |
| Additional Analysis Steps for L1 | For Level 1 analysts:<br>1. Verify the timestamps of driver modifications against known or scheduled updates/maintenance.<br>2. Check the digital signatures of the LSASS drivers for validity.<br>3. Cross-reference with change management logs to identify any authorized driver changes.<br>4. Gather and review any related user activity logs around the time of the modification event. |
| T2 Analyst Actions | Tier 2 analysts should:<br>1. Conduct a deeper investigation into the origin and nature of the modified drivers.<br>2. Perform behavior analysis to understand the impact and purpose of the unauthorized driver if any.<br>3. Utilize sandbox environments to execute and analyze the potential payloads involved.<br>4. Liaise with IT and security teams to corroborate findings and understand the context better. |
| Containment and Further Analysis | For containment and deeper analysis:<br>1. Isolate affected systems from the network to prevent lateral movement.<br>2. Quarantine suspicious or unsigned drivers, restoring legitimate copies from a secure backup if available.<br>3. Perform a comprehensive security audit on isolated systems to identify further compromises.<br>4. Engage incident response protocols to ensure all potential threats and vectors are addressed. |
