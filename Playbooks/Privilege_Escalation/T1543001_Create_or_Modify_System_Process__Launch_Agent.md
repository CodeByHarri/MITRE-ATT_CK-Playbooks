# Create_or_Modify_System_Process:_Launch_Agent - T1543001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1543.001 |
| MITRE Sub-TTP | T1543.001 |
| Name | Create or Modify System Process: Launch Agent |
| Log Sources to Investigate | Investigate system logs related to macOS LaunchAgents. Specifically, examine the following log sources: <br>1. File system changes monitored by tools like File Integrity Monitoring (FIM) which can show if new or suspicious .plist files were added or modified in /System/Library/LaunchAgents, /Library/LaunchAgents, and ~/Library/LaunchAgents.<br>2. User activity logs that can provide insights into who made changes to the LaunchAgent directories.<br>3. System activity logs showing system and user-specific daemon start-up processes that include suspicious or unexpected programs.<br>4. Any available EDR (Endpoint Detection and Response) logs that might capture 'Launchctl' command executions or abnormal patterns.<br>5. Terminal command logs and shell history for evidence of unauthorized usage of 'launchctl' commands. |
| Key Indicators | Look for the following key indicators: <br>1. Presence of new or modified .plist files in LaunchAgents directories when none are expected.<br>2. .plist files utilizing common system or software names but located in unexpected locations.<br>3. .plist files with the 'RunAtLoad' or 'KeepAlive' keys set to true, without the user's consent or understanding.<br>4. Anomalous execution patterns in system processes related to LaunchAgents, such as unexpected programs running on login.<br>5. Sudden changes in user level permissions associated with Launch Agent tasks.<br>6. Execution of 'launchctl' commands by non-admin users or scripts without known legitimate purposes. |
| Questions for Analysis | 1. Is there any recent creation or modification of .plist files in LaunchAgent directories by unknown users or processes?<br>2. Are there signs that the 'RunAtLoad' or 'KeepAlive' keys are set to true without corresponding legitimate software updates or installations?<br>3. Are there any known legitimate purposes for the .plist files found, or do they contain any malware signatures?<br>4. Has 'launchctl' been used by users or scripts that should not have access to system-level modifications?<br>5. Are there any unauthorized changes in user permissions that could be exploited by adversaries? |
| Decision for Escalation | Escalate to Tier 2 analysts if: <br>1. A .plist file is identified with suspicious configuration, without a corresponding legitimate explanation.<br>2. The 'RunAtLoad' or 'KeepAlive' keys are activated by unidentified process or user activity.<br>3. Unusual 'launchctl' command executions are detected, suggesting potential privilege escalation or persistence misuse.<br>4. There are corroborating indicators of compromise such as malware detection linked to the .plist file. |
| Additional Analysis Steps for L1 | 1. Verify the source and legitimacy of any newly created or modified .plist files in the LaunchAgents directories.<br>2. Cross-reference suspicious .plist file names with known macOS and third-party software to spot anomalies.<br>3. Review user and system logs for peculiar activities coinciding with the creation or modification of Launch Agents.<br>4. Conduct initial verification checks to see if 'launchctl' commands have been used in expected contexts by authorized users. |
| T2 Analyst Actions | 1. Conduct a deeper forensic analysis on the .plist files to determine potential links to malicious activity.<br>2. Utilize malware scanning and sandboxing tools to launch suspected .plist files in a controlled environment.<br>3. Investigate EDR logs or employ threat intelligence services to identify known malware signatures or connections to identified threats.<br>4. Verify any unauthorized privilege changes or suspicious user behavior and correlate with possible external threats or attacks. |
| Containment and Further Analysis | 1. Isolate affected systems from the network to prevent further execution of potential malicious code.<br>2. Remove or quarantine identified malicious .plist files and their associated tasks.<br>3. Conduct a full malware scan across the devices used by the affected user of newly installed Launch Agents.<br>4. Gather threat intelligence data and report findings to improve defenses and inform similar response incidents in the future.<br>5. Update user education to prevent future compromises via Launch Agents, emphasizing secure practices for software installations. |
