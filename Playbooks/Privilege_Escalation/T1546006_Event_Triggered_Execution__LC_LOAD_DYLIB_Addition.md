# Event_Triggered_Execution:_LC_LOAD_DYLIB_Addition - T1546006

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1546.006 |
| MITRE Sub-TTP | T1546.006 |
| Name | Event Triggered Execution: LC_LOAD_DYLIB Addition |
| Log Sources to Investigate | To detect T1546.006, focus on the following log sources: <br>1. File Integrity Monitoring logs: Look for changes in Mach-O binaries, particularly changes related to LC_LOAD_DYLIB headers.<br>2. System and audit logs on macOS: Examine logs for the execution of binaries that show unexpected dylib loading behaviors.<br>3. Endpoint Detection and Response (EDR) tools: Use these to identify suspicious execution patterns or manipulation of binary headers.<br>4. Code signing logs: Investigate any Mach-O binaries with missing or altered LC_CODE_SIGNATURE commands.<br>5. Application and security logs: Monitor activity involving new or altered dylib files being loaded.<br>Examples include monitoring launch services and library validation subsystems. |
| Key Indicators | Identify activities such as: <br>1. Modification of an LC_LOAD_DYLIB header in known Mach-O binaries.<br>2. Absence or removal of LC_CODE_SIGNATURE in a Mach-O binary.<br>3. Loading of unexpected or unusual dylibs as recorded in system or application logs.<br>4. Alerts from file integrity monitoring tools about unauthorized modifications.<br>5. Presence of unusual or newly created dylibs in library paths. |
| Questions for Analysis | Consider the following: <br>1. Is there an abnormal pattern of library loading detected?<br>2. Are the modified Mach-O binaries signed by legitimate developers?<br>3. Has the binary been altered recently, and does this correspond with known trusted updates?<br>4. Are the identified dylibs from known and trusted sources?<br>5. Have there been similar activities on other endpoints in the network? |
| Decision for Escalation | Escalate to Tier 2 if: <br>1. There is evidence of unauthorized modification of Mach-O binaries.<br>2. Several instances of unexpected dylib loads are detected without a clear benign explanation.<br>3. There are potential signs of persistence mechanisms being established across multiple systems.<br>4. Digital signatures are missing or irregular for multiple important binaries. |
| Additional Analysis Steps for L1 | 1. Verify recent updates or changes to the affected binaries through system patch or update logs.<br>2. Correlate activity logs with user actions or scheduled tasks that may have led to these changes.<br>3. Conduct a basic check to see if detected dylibs are commonly associated with known malware.<br>4. Confirm if there are backups or versions available for the altered binaries. |
| T2 Analyst Actions | 1. Perform a deeper investigation into the origin of the modified binaries and verify their integrity.<br>2. Check for cross-system correlations indicating widespread abuse of LC_LOAD_DYLIB.<br>3. Analyze any network behavior that may indicate communication between the affected system and potential C2 servers.<br>4. Conduct Threat Intelligence searches to verify if suspected dylibs or binary alterations are linked to known threat actors or campaigns. |
| Containment and Further Analysis | 1. Isolate affected systems to prevent further compromise.<br>2. Restore originals of altered binaries from trusted backups or clean installations.<br>3. Block and monitor the loading paths involved in the suspicious activity.<br>4. Implement Application Control policies to prevent execution of unauthorized binaries and dylibs.<br>5. Document and report findings to improve detection and response strategies for similar threats in future. |
