# Boot_or_Logon_Autostart_Execution:_Login_Items - T1547015

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1547.015 |
| MITRE Sub-TTP | T1547.015 |
| Name | Boot or Logon Autostart Execution: Login Items |
| Log Sources to Investigate | Monitor macOS-specific logs such as: <br>1. Unified Logs: Check for entries related to launchd and SMLoginItemSetEnabled API calls.<br>2. System Logs: Look for unexpected applications being launched upon user login.<br>3. File Integrity Monitoring: Track changes in '~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm'.<br>4. SIEM Solutions: Configure alerts for new login items added outside of user-initiated actions.<br>Example tools include osquery and native macOS logging mechanisms. |
| Key Indicators | 1. Presence of unexpected paths or executables in login items within System Preferences.<br>2. Unusual processes being spawned from '~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm'.<br>3. Use of AppleScript or Native API to modify login items outside typical user behavior.<br>4. Increased API call frequency to SMLoginItemSetEnabled. |
| Questions for Analysis | 1. Is the executable path associated with known legitimate software?<br>2. Have there been recent user complaints or reports of abnormal system behavior after login?<br>3. Is the executables' hash known to be associated with malware?<br>4. Were there any correlated suspicious activities (e.g., unusual network connections) with the login item execution? |
| Decision for Escalation | Escalate to Tier 2 if: <br>1. The login item entry is for an unknown or suspicious executable.<br>2. Multiple logon items are identified within a short timeframe with no legitimate justification.<br>3. The executables have been identified by Threat Intelligence as potentially harmful.<br>4. Associated user accounts have a history of unexplained privileges escalations. |
| Additional Analysis Steps for L1 | 1. Verify the legitimacy of the login items by cross-referencing with known software.<br>2. Request feedback from the user regarding any unusual system behavior post-login.<br>3. Utilize VirusTotal or similar to analyze the hash of items within '~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm'. |
| T2 Analyst Actions | 1. Conduct a deeper investigation into the system to look for signs of compromise.<br>2. Correlate any detected login items with network activity and file access logs.<br>3. Perform malware analysis on suspicious executables utilizing sandboxing techniques.<br>4. If applicable, employ Digital Forensics Tools like Autopsy or EnCase for further inspection. |
| Containment and Further Analysis | 1. Quarantine the involved endpoint to prevent further exploitation.<br>2. Remove unauthorized login items using safe methods (e.g., system applications).<br>3. Conduct a full malware scan on the affected system.<br>4. Block network connections to any identified Command and Control servers found in associated network activity logs.<br>5. Review user accounts for any unauthorized changes or privilege escalations. |
