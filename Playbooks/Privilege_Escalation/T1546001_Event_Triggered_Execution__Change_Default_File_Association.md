# Event_Triggered_Execution:_Change_Default_File_Association - T1546001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1546.001 |
| MITRE Sub-TTP | T1546.001 |
| Name | Event Triggered Execution: Change Default File Association |
| Log Sources to Investigate | Collect and review Windows Event Logs, particularly those related to Registry changes. Look into events under Microsoft-Windows-Sysmon/Operational for Registry modification events (Event ID 13 is used for Registry modifications). Also, examine Endpoint Detection and Response (EDR) logs which may capture changes to file associations, and monitor logs from cybersecurity tools that detect anomalies in registry activity. Additionally, utilize Windows Security Audit logs to track changes made by users and applications. |
| Key Indicators | Unusual modifications to registry keys related to file extensions and handlers, such as unexpected changes in HKEY_CLASSES_ROOT. Specifically, focus on unexpected handlers in HKEY_CLASSES_ROOT\[handler]\shell\open\command paths for common extensions like .txt, .doc, .exe. Look out for unfamiliar programs in association with the open, print, and printto commands. Sudden changes without corresponding software installation or updates are also significant indicators. |
| Questions for Analysis | Has a legitimate user or administrator made recent changes to file associations? Were any unauthorized software installations conducted around the time the registry changes were observed? Are there any concurrent alerts indicating potential malicious activity or file changes associated with known malware? Are the modified handlers pointing to suspicious or non-standard executable paths? |
| Decision for Escalation | Escalate to Tier 2 if file association changes involve uncommon file types or point to executables located outside standard directories (e.g., Program Files, Windows), or if there is no clear indication of a legitimate administrative operation. Also, escalate if multiple endpoints are affected simultaneously within a short period or if there are indicators of additional suspicious activities like network anomalies or malware detections. |
| Additional Analysis Steps for L1 | Verify the timeline of registry changes against user activity logs to determine if changes coincide with legitimate updates or administrative actions. Cross-reference file hashes of any executables involved in the changed associations with known malware databases. Assess whether recent software updates or installations justify the registry changes. |
| T2 Analyst Actions | Conduct deep inspection of the executable files linked with modified registry keys to determine legitimacy. An analyst should query Threat Intelligence platforms for reports on executables or behaviors observed. Additionally, examine other endpoints for similar registry changes to assess potential propagation. Utilize forensic tools to analyze file system changes around the time of the association modifications. |
| Containment and Further Analysis | Immediately revert the suspicious registry modifications to their original, known-safe state. Isolate affected systems to prevent possible lateral movement. Conduct comprehensive malware scans and integrity checks on impacted systems. Collect memory and disk images for affected systems for further forensic analysis. Coordinate with IT to restore impacted systems from backups if a compromise is confirmed. |
