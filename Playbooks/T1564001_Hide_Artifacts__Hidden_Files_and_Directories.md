# Hide_Artifacts:_Hidden_Files_and_Directories - T1564001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1564.001 |
| MITRE Sub-TTP | T1564.001 |
| Name | Hide Artifacts: Hidden Files and Directories |
| Log Sources to Investigate | Log sources to investigate for T1564.001 should include file system monitoring logs that record file attribute changes, OS security logs, and host-based intrusion detection system (HIDS) alerts. Specific examples include:<br>- Windows Event Logs: Look for events indicating use of 'attrib.exe' to change file attributes<br>- File Integrity Monitoring (FIM) logs: Detect changes in file properties, such as hidden attribute toggles<br>- Linux/macOS system logs: Monitor for 'chmod', 'chflags', or 'mv' commands that manipulate hidden file attributes<br>- Application logs: Investigate logs from applications known to create hidden files, such as SSH utilities generating '.ssh' directories. |
| Key Indicators | Key indicators of this TTP include:<br>- Unusual use of command-line utilities to set files and directories as hidden, e.g. 'attrib +h' on Windows or naming files with a leading '.' on Linux/macOS<br>- Presence of unexpected hidden files or directories in common locations, such as user directories or system folders<br>- Changes to file attributes detected by File Integrity Monitoring tools<br>- Logs showing unexpected changes in Finder settings on macOS to hide files with UF_HIDDEN flag. |
| Questions for Analysis | The following questions should guide Tier 1 analysts:<br>1. Are there indications of recent file attribute changes that mark files as hidden?<br>2. Is there a pattern of similar changes across multiple files or directories?<br>3. Do the hidden files belong to known benign applications, or are they unfamiliar?<br>4. Are the hidden files located in directories commonly associated with user activity or system processes?<br>5. Have there been any logged intrusions or unauthorized access attempts prior to the detection of these hidden files? |
| Decision for Escalation | Escalation to Tier 2 is warranted if:<br>- Hidden files are found in sensitive directories, such as system or application directories<br>- There's a pattern of recent changes marking files as hidden without proper authorization<br>- The source of these changes cannot be traced to a recognized application or user activity<br>- There are concurrent signs of potential compromise, like malware detections or changes in system configurations. |
| Additional Analysis Steps for L1 | Tier 1 analysts should perform the following steps:<br>1. Confirm the detection of hidden file attribute changes using available logs<br>2. Check for recent alerts or detections of suspicious behavior on the host in question<br>3. Verify whether the hidden files are part of legitimate software activities or updates<br>4. Communicate with the user or owner of the affected system for any recent changes they might have made intentionally. |
| T2 Analyst Actions | Tier 2 analysts should:<br>1. Conduct deeper forensics on the affected systems to identify the process or user responsible for setting the files as hidden<br>2. Analyze the hidden files for suspicious content or known signatures of malware<br>3. Review historical data to check for patterns or repeated occurrences of similar activities<br>4. Collaborate with IT and affected parties to understand the context of these changes, especially if associated with legitimate programs. |
| Containment and Further Analysis | To contain the threat:<br>1. Remove or quarantine suspicious hidden files after confirmation of malicious intent<br>2. Review and restore file permissions and attributes to appropriate settings<br>3. Update and deploy endpoint protection updates to prevent further misuse of file hiding tactics<br>4. Document the incident comprehensively for post-incident review and to reinforce detection and response strategies for future occurrences. |
