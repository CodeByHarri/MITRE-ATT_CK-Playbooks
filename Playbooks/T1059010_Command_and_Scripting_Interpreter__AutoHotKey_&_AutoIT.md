# Command_and_Scripting_Interpreter:_AutoHotKey_&_AutoIT - T1059010

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Execution |
| MITRE TTP | T1059.010 |
| MITRE Sub-TTP | T1059.010 |
| Name | Command and Scripting Interpreter: AutoHotKey & AutoIT |
| Log Sources to Investigate | Investigate process creation logs that indicate execution of AutoIT (.au3) or AutoHotKey (.ahk) scripts, particularly unusual instances of `AutoIt3.exe` and `AutoHotKey.exe`. Check file creation events for new .ahk, .au3, or their corresponding compiled executables within user profile directories or temp folders. Monitor PowerShell commands or scripts invoking these executables. Look into endpoint detection and response (EDR) tools and antivirus logs for detections related to AHK or AutoIT malware. Inspect network traffic logs for suspicious outgoing connections that might correlate with known command and control (C2) domains or IPs associated with AHK or AutoIT payloads. |
| Key Indicators | Presence of .ahk or .au3 files being created or executed unexpectedly. Abnormal network activity following the execution of AHK or AutoIT scripts. Identifiers of compiled scripts or unexpected use of `AutoIt3.exe` or `AutoHotKey.exe`. Alert from security tools on known AHK malware or suspicious script execution. |
| Questions for Analysis | Did the execution of AHK or AutoIT scripts coincide with any user-triggered legitimate automation tasks? Are there any known false positives associated with these scripts on this particular user system? Is the execution of these scripts coming from untrusted locations or involving unexpected parent processes? Does the context of the file indicate a phishing attempt, e.g., within a suspicious email attachment? |
| Decision for Escalation | Escalate if there is any unknown AHK or AutoIT script present, particularly if executed from unusual directories or during non-business hours. If network indicators suggest C2 communication post-script execution, escalate immediately. Also, escalate if script execution aligns temporally with phishing emails or reported suspicious emails. |
| Additional Analysis Steps for L1 | Verify the hash and origin of the AHK or AutoIT scripts, checking for known malicious signatures. Cross-reference script contents with known malicious patterns or combine with OTX/YARA rules for a preliminary threat analysis. Review recent email logs or alerts for associated phishing attempts. Look into user activity logs for any legitimate automation that could explain the scripts' presence. |
| T2 Analyst Actions | Conduct a deeper forensic analysis of the scripts, examining payloads or embedded code. Leverage sandbox environments to safely execute and analyze the behavior of detected scripts. Compile threat intelligence from security vendors regarding any similar cases or novel tactics involving these scripting languages. Engage in deeper network traffic analysis correlated with the script execution timeline using both internal logs and external threat feeds. |
| Containment and Further Analysis | Isolate the affected system from the network to prevent potential data exfiltration. Remove the identified malicious scripts and revert any changes made by them if possible. Quarantine associated email or files. Conduct a thorough sweep across the environment for similar indicators. Implement or reinforce security controls to monitor and block the execution of suspicious automation scripts like AHK and AutoIT. Update detection rules to capture similar gaps moving forward. |
