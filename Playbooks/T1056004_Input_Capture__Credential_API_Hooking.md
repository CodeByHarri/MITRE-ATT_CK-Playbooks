# Input_Capture:_Credential_API_Hooking - T1056004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Collection, Credential Access |
| MITRE TTP | T1056.004 |
| MITRE Sub-TTP | T1056.004 |
| Name | Input Capture: Credential API Hooking |
| Log Sources to Investigate | Analyze application logs that may show unusual API call patterns or unauthorized hooks. This includes security logs from endpoint detection and response (EDR) tools and logs from application monitoring solutions. Windows Event Logs like Security and Application logs can provide insights into suspicious activities. Log sources should include process creation logs (Sysmon Event ID 1), image loaded logs (Sysmon Event ID 7), and module detection from memory monitoring tools such as Windows Defender ATP or Carbon Black. |
| Key Indicators | Look for unusual modifications to the Import Address Table or evidence of inline hooking such as altered API function start bytes. Unexpected DLL injections or loads that are not typical for the process. Abnormally frequent API calls that relate to credential management or user interactions. New or unknown processes performing memory manipulations. Recorded use of known hooking techniques, libraries, or tools associated with malicious activity. |
| Questions for Analysis | Is there evidence of processes behaving anomalously, such as reading memory of privileged processes? Are there logs indicating execution of unknown or uncommon applications or scripts? Have any unauthorized applications been detected interacting with sensitive APIs? Are there user reports of unexpected application behavior? |
| Decision for Escalation | Escalate if hooking is detected on critical systems or if suspicious credentials or sensitive data seem accessed without authorization. Also, escalate if thereâ€™s corroborative evidence of unauthorized memory access or modification by untrusted applications or code. |
| Additional Analysis Steps for L1 | Perform an initial review of identified suspicious processes and compare them against threat intelligence databases for known malicious activity. Cross-reference API hooking indicators with other known threats. Verify if the observed patterns correspond to business-as-usual activities. Use automated tools to scan for inconsistencies or anomalies in related network and application logs. |
| T2 Analyst Actions | Conduct deeper forensic analysis of affected systems, such as memory dumps and detailed examination of the API usage patterns. Utilize threat hunting tools to identify similar incidents across the network. Correlate findings with recent mitigations or threat intelligence reports establishing motives or actor profiles. Determine the full scope of the compromise, including lateral movement or data exfiltration. |
| Containment and Further Analysis | Isolate affected hosts to prevent further credential stealing or lateral movement. Implement network segmentation if necessary. Audit and potentially reset compromised credentials. Review and adjust endpoint protection configurations to monitor and block unexpected hooking activities. Execute purple teaming exercises to ensure enhanced detection and response capabilities against similar TTPs in future. |
