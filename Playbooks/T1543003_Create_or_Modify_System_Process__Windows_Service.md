# Create_or_Modify_System_Process:_Windows_Service - T1543003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1543.003 |
| MITRE Sub-TTP | T1543.003 |
| Name | Create or Modify System Process: Windows Service |
| Log Sources to Investigate | Investigate Windows Event Logs, specifically System and Security logs related to service creation and modification (Event ID 4697 for service created, Event ID 7045 for a service installed). Check Windows Registry changes using Security logs (Event ID 4657). Review command-line activity (Event ID 4688) to identify suspicious usage of utilities such as sc.exe, PnPUtil.exe, and interaction with ZwLoadDriver() or ZwSetValueKey() APIs. Examine process creation logs for evidence of native API calls (Event IDs pointing to process creation like 4688). Inspect any driver installations or modifications, looking at Sysmon logs for driver load events (Event ID 6). |
| Key Indicators | New or modified services without legitimate justification. Registry changes to service configurations. Unusual command-line execution of sc.exe, PnPUtil.exe, or detection of direct usage of ZwLoadDriver() or ZwSetValueKey() APIs. Installation of unsigned or unexpected drivers, particularly if accompanied by system crashes or anomalies immediately afterwards. Presence of services running under unusual names or incorporating known masquerading techniques. Hidden services detected via non-standard enumeration methodologies such as SC query with SDDL changes. |
| Questions for Analysis | Is there a legitimate business need for the new or modified service? Are the service names similar to known malicious signatures or anomalous compared to the usual service naming conventions? Is the executable path for the service pointing to an unexpected or unauthorized directory? Are there any administrative actions supporting this change logged by authorized personnel? Are there unexpected or undefined driver files present on the system? |
| Decision for Escalation | Escalate if a newly created or modified service has no clear business justification or approval. Escalate for T2 analysis if command-line history or API calls are typical of known malicious patterns. Escalate if the service is masked under a legitimate name and unusual service configurations are observed, especially if they incorporate SDDL modifications. Elevate if unauthorized drivers are loaded or if associated system anomalies are detected. |
| Additional Analysis Steps for L1 | Verify the legitimacy of new services via interaction with IT staff or system owners. Compare service names and paths against whitelists or known lists of legitimate services. Use available threat intelligence to match service characteristics against known threat actor TTPs. Check for any concurrent user account anomalies related to service modification. Consult internal documentation for IT-approved tools and software that may have modified services. |
| T2 Analyst Actions | Conduct deeper investigation into service execution paths and associated binaries using file hashes, antivirus scans, and threat intelligence platforms. Analyze network traffic for the compromised system for potential C2 communications related to the service. Review process trees from Sysmon logs to observe any unusual parent-child relationships. Investigate any possible privilege escalation activities linked to service manipulation. Cross-reference with known service manipulation incidents and patterns from threat intel data. |
| Containment and Further Analysis | Isolate the affected system from the network to prevent further compromise. Terminate suspicious services and drivers immediately upon detection. Restore registry and service configurations from backups or known-good baselines. Scan the system with updated malware signatures and an in-depth anti-malware suite. Implement changes to block the specific TTPs detected in the service manipulation (e.g., network segmentation, group policy updates). Conduct a post-incident review to identify whether additional systems are affected and refine detection strategies. |
