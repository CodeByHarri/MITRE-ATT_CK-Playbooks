# Subvert_Trust_Controls:_Code_Signing_Policy_Modification - T1553006

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1553.006 |
| MITRE Sub-TTP | T1553.006 |
| Name | Subvert Trust Controls: Code Signing Policy Modification |
| Log Sources to Investigate | Monitoring security logs from EDR (Endpoint Detection and Response) solutions for changes to the code signing policy through command execution, specifically bcdedit.exe on Windows and csrutil on macOS. Inspect System and Security Event logs for entries related to changes in boot configuration (Event ID 13 or 16 in Windows Event Viewer for BCD changes). Check for PowerShell commands and scripts execution if applicable. Also, examine system boot logs for evidence of debug or recovery mode initiations. Additional sources include Registry changes, specifically targeting keys associated with Driver Signature Enforcement and System Integrity Protection. |
| Key Indicators | Presence of commands such as 'bcdedit.exe -set TESTSIGNING ON' on Windows or 'csrutil disable' on macOS in command logs. Audit logs showing system reboots into debug or recovery mode. Changes to registry keys like 'g_CiOptions' or modifications in kernel memory related to signature enforcement policies. Presence of artifacts like a 'Test Mode' watermark on the desktop in Windows. |
| Questions for Analysis | Have there been recent system reboots, especially into debug or recovery mode, observed in logs? Has the COMMAND activity been seen in contexts indicating legitimate development or testing practices? Are there any legitimate applications or system updates that could justify the code signing policy modification? Are multiple endpoints showing similar changes concurrently? |
| Decision for Escalation | Escalate to Tier 2 if the code signing policy changes are observed outside of known maintenance windows, without any justification from approved change management records, or if artifacts like 'Test Mode' appear on multiple systems. Escalation is also warranted if suspicious unsigned or self-signed binaries are found executing after policy modifications. |
| Additional Analysis Steps for L1 | Verify the command source and user ownership from audit logs and correlate with user activity patterns. Check for any legitimate software updates or configurations that might have prompted code signing policy changes. Assess whether the same patterns are observed across various endpoints or isolated to particular ones. |
| T2 Analyst Actions | Conduct a deep-dive forensic analysis of affected systems to identify any unsigned or self-signed binaries executed post-policy modification. Review and correlate findings from network logs for any lateral movement or command and control communication. Validate the integrity of critical security features by reviewing system and kernel memory for unauthorized alterations. |
| Containment and Further Analysis | If unauthorized changes are confirmed, revert code signing policy to its secure state using enterprise tools, and isolate affected machines for a more detailed investigation. Recover original settings from system backups if necessary. Coordinate with IT support for further monitoring and apply additional signing enforcement policies via group policies or management configurations where necessary. Implement alerts for any future attempts of policy modifications across endpoints. |
