# Domain_Trust_Discovery - T1482

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1482 |
| MITRE Sub-TTP | T1482 |
| Name | Domain Trust Discovery |
| Log Sources to Investigate | 1. Security Event Logs: Focus on event ID 4672 (special privileges assigned to new logon) and event ID 4768 (authentication ticket request) to identify unusual activities from accounts that might be querying domain trust.<br>2. Network Traffic Logs: Monitor for connections to domain controllers, especially internal network scans or unusual LDAP traffic.<br>3. Application Logs: Investigate logs from tools such as 'Nltest' or custom scripts/tools that may be used for domain trust enumeration. 4. Active Directory Logs: Capture and inspect logs related to DSEnumerateDomainTrusts() function or similar API calls that could indicate domain trust discovery attempts. |
| Key Indicators | 1. Use of 'Nltest' or other tools to query domain trusts, especially if used by non-administrative users.<br>2. Network traffic showing LDAP queries that include DSEnumerateDomainTrusts or similar functions.<br>3. Unusual account logins followed by trust enumeration activity. 4. Access attempts from unusual geolocations or IP addresses closely preceding or following domain trust queries. |
| Questions for Analysis | 1. Is the account querying the domain trust relationships a privileged account?<br>2. Were there any unexpected login attempts prior to the trust discovery activities?<br>3. Has this activity been observed from this user or system before? 4. Did the queries originate from systems or IPs that are typically used by legitimate IT administration staff? |
| Decision for Escalation | Escalate to Tier 2 if: 1. The querying is done by a non-privileged or unusual account.<br>2. There is simultaneous suspicious account activity such as brute-force attempts.<br>3. Network traffic indicates communication to external systems post enumeration. 4. The activity deviates significantly from baseline user or system behavior. |
| Additional Analysis Steps for L1 | 1. Verify the legitimacy of the account performing the domain trust discovery via user validation and context.<br>2. Check recent logon activities from the involved account and machine.<br>3. Review recent internal network scans and LDAP query patterns for any anomalies. 4. Correlate with any ongoing security operations or known benign administrative scripts. |
| T2 Analyst Actions | 1. Deep dive into the account's history and network activity prior to and after the event.<br>2. Investigate all machines involved for signs of compromise, such as unexpected processes/services running or changes in scheduled tasks.<br>3. Cross-reference domain trusts enumerated logs against known exploitation campaigns or threat intelligence. 4. Provide findings to Threat Intelligence team to update potential IoCs. |
| Containment and Further Analysis | 1. Isolate the affected systems if unauthorized access or compromise is confirmed.<br>2. Disable potentially compromised accounts and force password resets.<br>3. Apply additional logging and monitoring on all domain controllers and active directory systems. 4. Use user behavior analytics tools to continuously monitor for similar anomalies. 5. Report findings to senior incident response teams for an organized threat hunt and risk assessment of lateral movements. |
