# XSL_Script_Processing - T1220

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1220 |
| MITRE Sub-TTP | T1220 |
| Name | XSL Script Processing |
| Log Sources to Investigate | Investigate the following log sources for evidence of msxsl.exe or WMIC activity: <br>1. Process Creation Logs: Look for execution of msxsl.exe or wmic with suspicious arguments. <br>2. PowerShell Logs: Check for scripts or commands invoking suspicious activity. <br>3. File Access Logs: Monitor access to XSL files, especially ones not typically used or in unexpected locations. <br>4. Network Traffic Logs: Review any outbound connections that might indicate the retrieval of a remote XSL file. <br>Examples include logs from Windows Event Viewer (specifically event ID 4688 for process creation) and proxy/firewall logs for unusual external communication attempts. |
| Key Indicators | Identify the following key indicators: <br>1. Execution of msxsl.exe with non-standard file extensions or invalid XML files. <br>2. Use of wmic with the /FORMAT switch pointing to local or external XSL files. <br>3. Access patterns to XSL files that are inconsistent with regular user behavior. <br>4. Abnormal network activity indicating XSL files fetched from external sources. <br>5. Instances of msxsl.exe or wmic not commonly found on target systems. |
| Questions for Analysis | Guide analysis with these questions: <br>1. Is msxsl.exe or wmic commonly used on the affected machine, or is this a rare event? <br>2. Are the XSL files being accessed located in suspicious directories or externally referenced? <br>3. Is there any indication of additional malicious payloads deployed through these files? <br>4. Does the context of the process execution align with normal user behavior? <br>5. Are there any other indicators in the logs pointing to malicious intent or compromise? |
| Decision for Escalation | Escalate to Tier 2 if any of the following criteria are met: <br>1. Execution of msxsl.exe or wmic tied to known malicious IPs or domains. <br>2. Discovery of XSL files containing suspicious scripts or functions. <br>3. Unexplained persistence or prevalence of msxsl.exe or wmic activity. <br>4. Evidence of lateral movement or exfiltration attempts following initial activity. |
| Additional Analysis Steps for L1 | L1 analysts should: <br>1. Cross-reference msxsl.exe or wmic execution with user login times and known legitimate activities. <br>2. Verify the origin and integrity of the XSL files in question. <br>3. Check user permissions to determine if they align with the observed activity. <br>4. Gather additional details about the network activity associated with the detection. |
| T2 Analyst Actions | T2 analysts should perform the following: <br>1. Conduct a deeper investigation into the XSL file contents for embedded scripts or anomalies. <br>2. Correlate the activity with other events on the network to identify potential payload delivery methods. <br>3. Perform an impact assessment to determine what, if any, systems have been compromised further. <br>4. Validate external communication with any detected C2 infrastructure. |
| Containment and Further Analysis | Execute containment and further analysis steps such as: <br>1. Isolate affected systems from the network to prevent further misuse or spread. <br>2. Remove unauthorized msxsl.exe installations and unknown or suspicious XSL files. <br>3. Implement blocks or filter rules to prevent the wmic /FORMAT argument being used maliciously. <br>4. Conduct a thorough post-incident review to identify gaps in existing security controls and improve detection capabilities. |
