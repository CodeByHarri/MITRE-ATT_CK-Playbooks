# Dynamic_Resolution:_Domain_Generation_Algorithms - T1568002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Command and Control |
| MITRE TTP | T1568.002 |
| MITRE Sub-TTP | T1568.002 |
| Name | Dynamic Resolution: Domain Generation Algorithms |
| Log Sources to Investigate | Investigate DNS logs for unusual domain query patterns often associated with DGAs, such as a high volume of requests for non-existent domains or domains with seemingly random names. Network traffic logs should be reviewed to identify communication attempts to these domains. Endpoint protection logs can be helpful to detect processes making these DNS requests. Example log sources include DNS query logs from BIND or Microsoft DNS server, firewall logs, and network traffic analyzed by IDS/IPS systems. |
| Key Indicators | Look for domains with unusual or random alphanumeric structures in DNS queries, which do not resolve to known hosts or have short-lived registration periods. High-frequency DNS queries from a single host to multiple domains with similar characteristics can be indicative of DGA activity. Usage of specific ports or protocols that deviate from the standard, especially if questionable endpoints are contacted. |
| Questions for Analysis | 1. Does the domain in question have a known purpose or reputation in threat intelligence databases?<br>2. Is there a pattern of DNS requests from the host indicating an anomaly consistent with DGA behavior?<br>3. Are the domain names queried similar in structure (e.g., random strings) and not resolving in public DNS? 4. Does the timing of domain generation match any known time-based DGAs? |
| Decision for Escalation | Escalate to Tier 2 if: 1. Confirmed evidence of DGA domain patterns in DNS logs.<br>2. Network traffic analysis reveals attempts to communicate with these domains.<br>3. Endpoint logs indicate a process persistently querying multiple domains per day with suspicious characteristics. 4. Threat intelligence correlates this behavior with known DGA-utilizing malware families. |
| Additional Analysis Steps for L1 | 1. Review IP addresses associated with suspicious domains for any previous malicious activity.<br>2. Check for multiple similar-looking queries from the same device to identify patterns.<br>3. Correlate domain names with threat intelligence feeds for additional context. 4. Validate if the domain names queried align with any known DGA-used patterns or algorithms. |
| T2 Analyst Actions | 1. Perform deeper threat intelligence searches to link suspicious domains to known malware campaigns.<br>2. Analyze related host systems for anomalies, such as unusual processes or file modifications.<br>3. Cross-reference suspicious activities across multiple logs for a comprehensive view. 4. Determine any lateral movement from affected systems and potential reach of the infection. |
| Containment and Further Analysis | 1. Block suspicious domains at network security infrastructure (e.g., firewalls, proxies).<br>2. Quarantine affected systems and conduct memory analysis to identify malware artifacts.<br>3. Conduct a full review of network communication from the host to detect other compromised areas. 4. Update endpoint protection signatures to recognize and resist specific DGA patterns. 5. Analyze retrieved malware samples to reverse-engineer and understand the DGA involved if possible. |
