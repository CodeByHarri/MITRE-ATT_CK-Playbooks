# Hide_Artifacts:_Process_Argument_Spoofing - T1564010

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1564.010 |
| MITRE Sub-TTP | T1564.010 |
| Name | Hide Artifacts: Process Argument Spoofing |
| Log Sources to Investigate | To effectively investigate T1564.010, focus on the following log sources: <br>1. Windows Security and System logs: These logs can provide information about process creations and status changes.<br>2. EDR (Endpoint Detection and Response) telemetry: Look for detailed process execution data including command-line arguments and process lineage.<br>3. Application logs: Logs from defensive software that track command-line executions.<br>4. PowerShell logs: Check for anomalies related to script executions and command-line usage.<br>Example tools include Sysmon (with process creation and change rules), Windows Event Viewer, and telemetry from solutions like Microsoft Defender ATP or CrowdStrike Falcon. |
| Key Indicators | Indicators of process argument spoofing include: <br>1. Detected changes in process command-line arguments post process initiation. <br>2. Usage of APIs such as WriteProcessMemory() which might indicate memory manipulation. <br>3. Discrepancies between initial process attributes logged and current attributes. <br>4. Unusual execution sequences or process parent changes potentially combined with process hollowing or parent PID spoofing.<br>5. Suspicious or unexpected analysis of benign-looking arguments after a process is initiated with malicious data. |
| Questions for Analysis | 1. Are the initial and current command-line arguments for the process different? <br>2. Was WriteProcessMemory or similar function used shortly after the process began? <br>3. Are there any discrepancies in parent-child process relationships? <br>4. Do the arguments make the process command-line look benign or commonly expected for the observed executable? <br>5. Has this behavior been observed in other processes or endpoints in the network recently? |
| Decision for Escalation | Escalation to Tier 2 should occur if any of the following criteria are met: <br>1. Clear evidence of memory manipulation (e.g., use of WriteProcessMemory) without a clear legitimate use case. <br>2. Multiple instances of argument spoofing across the environment. <br>3. Compound suspicious activities such as combined use of spoofing and process hollowing. <br>4. Inability to trace the process lineage due to spoofed or changed arguments. |
| Additional Analysis Steps for L1 | 1. Verify process argument integrity by checking initial PEB entries. <br>2. Align parent-child process relationships using historical data. <br>3. Perform cross-referencing of process hashes with known threat indicators. <br>4. Document any use of APIs like WriteProcessMemory in relation to the process in question. <br>5. Gather details on any user accounts involved in executing potentially spoofed processes. |
| T2 Analyst Actions | 1. Conduct a deeper forensic analysis of the endpoint, focusing on process memory dumps. <br>2. Correlate with network traffic analysis to detect possible lateral movement or data exfiltration. <br>3. Review historical and current threat intelligence reports for matching TTPs. <br>4. Work with IT to monitor systems for irregular API usage patterns. <br>5. Engage with affected users to determine if they noticed any unusual application behaviors. |
| Containment and Further Analysis | 1. Isolate impacted systems from the network to prevent potential spread. <br>2. Implement blocks on identified malicious hashes and alert on WriteProcessMemory usage in EDRs. <br>3. Deploy enhanced logging for processes known to have been exploited or potentially vulnerable. <br>4. Conduct full malware analysis of any newly identified or altered executable files. <br>5. Recommend patches or configuration changes to prevent future exploitation, and ensure comprehensive logging is in place for incident reconstruction. |
