# Native_API - T1106

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Execution |
| MITRE TTP | T1106 |
| MITRE Sub-TTP | T1106 |
| Name | Native API |
| Log Sources to Investigate | 1. Windows Event Logs: Monitor Security and System events for process creation events (e.g., Event ID 4688 for process creation in Windows).<br>2. Sysmon Logs: Look for process creation with parent-child relationships that involve unusual or suspicious processes.<br>3. EDR/AV Logs: These logs can capture suspicious API calls directly linked to malicious activities like process injection or untrusted applications calling low-level APIs.<br>4. Custom Application Logs: If available, logs that indicate utilization of low-level APIs, such as unusual app behavior or high-frequency API calls.<br>5. Network Traffic Logs: Sudden or unexplained increase in traffic to known command and control servers can be indicative of post-compromise activity leveraging API calls. |
| Key Indicators | 1. Unusual or rare process creation using known API functions like CreateProcess() or fork().<br>2. Direct invocation of syscalls via assembly, especially in non-native contexts.<br>3. Process injections or syscall proxies which do not map to known benign behavior.<br>4. Modifications to user-mode API-hooks detected via tools like Sysinternals or EDR capabilities.<br>5. Anomalies or tampering events in logs related to defensive tool evasion like unhooking actions. |
| Questions for Analysis | 1. Does the process creation involve known trusted vs. suspicious binaries or scripting engines?<br>2. Are the syscalls or API functions being invoked documented as typical behavior for the application or user session?<br>3. Is there evidence of the process attempting to laterally move or escalate privileges post-API call?<br>4. Has the behavior been observed in previous attacks or as part of known malware campaigns?<br>5. How frequent are these API calls in relation with typical system operations? |
| Decision for Escalation | Escalate to Tier 2 if there is: <br>1. Evidence linking API abuse with external C2 communication.<br>2. Detection of process anomalies that have no associated business justification.<br>3. Known indicators of compromise tied to observed API behavior.<br>4. Multiple systems reporting similar behavioral indicators simultaneously.<br>5. Clear signs of tampering with monitoring tools or logs which could hide further nefarious activities. |
| Additional Analysis Steps for L1 | 1. Validate the legitimacy of the processes and binaries involved in the suspicious API calls.<br>2. Cross-reference with known threat intelligence for similar API misuse patterns.<br>3. Check system baselines for deviations linked to the suspicious API-related events.<br>4. Review user and process histories for unusual activity leading up to the event. |
| T2 Analyst Actions | 1. Conduct a deeper behavioral analysis of suspicious processes, including dynamic analysis in a sandbox environment.<br>2. Investigate potential lateral movement or data exfiltration that might have occurred as a result of API misuse.<br>3. Assess the breadth of compromise by evaluating affected systems and spreading scope.<br>4. Correlate API usage with attacker TTPs found in current threat intelligence datasets. |
| Containment and Further Analysis | 1. Isolate affected systems immediately to prevent further compromise.<br>2. Implement API monitoring and alerting for high-frequency or unusual API calls.<br>3. Utilize advanced forensics tools to analyze root cause and recover deleted or modified logs if tampered.<br>4. Develop and deploy YARA rules to detect similar API-based attack patterns on unmonitored systems.<br>5. Work with development and IT teams to patch any exploited vulnerabilities either in custom applications or API integrations. |
