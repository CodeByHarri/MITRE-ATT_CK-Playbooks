# Boot_or_Logon_Initialization_Scripts:_Network_Logon_Script - T1037003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1037.003 |
| MITRE Sub-TTP | T1037.003 |
| Name | Boot or Logon Initialization Scripts: Network Logon Script |
| Log Sources to Investigate | Investigate the Group Policy Management logs to track changes or creations of network logon scripts. Windows Event Logs, particularly those related to logon events (Event ID 4624 for successful logon and 4648 for an explicit credential logon), can be useful to determine when scripts are executed. Security Information and Event Management (SIEM) solutions should be checked for any suspicious patterns or anomalies in PowerShell or Command Prompt logs. Look into file access logs to monitor when specific logon scripts are altered, as well as directory listing of shared script storage to detect unauthorized changes. |
| Key Indicators | Creation or modification of network logon scripts without a valid change request can indicate adversary activity. Unauthorized changes in Group Policy Objects, particularly those relating to user logon scripts, could be a sign of compromise. Multiple users executing a script that is not part of standard operations workflows. Elevated privileges used to modify script directories or content anomalies such as obfuscated code within scripts. |
| Questions for Analysis | Were there any recent changes to the network logon scripts that donâ€™t correspond with a change management request? Are the scripts being executed by users who do not typically run scripts? Is there any unusual network traffic originating after the script execution, possibly indicating C2 communication? Are there any anomalies or unexpected behaviors observed in user sessions following script execution? |
| Decision for Escalation | Escalate to Tier 2 if there are unauthorized or suspicious changes in network logon scripts detected. If the script contains obfuscated or encoded commands often found in malware, or if multiple systems are executing scripts simultaneously in a manner inconsistent with normal operations. Also, escalate if there is evidence of privileged accounts being used unexpectedly to modify network script parameters. |
| Additional Analysis Steps for L1 | Review recent change management tickets for any related approvals and check logs for the activities of the accounts involved in script modification. Cross-reference IP addresses associated with the execution of scripts against known threat intelligence for potential indicators of compromise (IOCs). Conduct a quick review of user activity and any associated alerts in user behavior analytics (UBA) tools. Review any scheduled tasks or services that might be using these scripts. |
| T2 Analyst Actions | Conduct a detailed forensic analysis of the modified logon script to determine intent and if it contains malicious code. Examine historical logs for patterns of execution or anomalies when the script was initially deployed or changed. Correlate script execution events with other suspicious activities, like unusual logon attempts or privilege escalations. Verify with IT operations to understand the context of recent legitimate modifications to logon scripts, if any. |
| Containment and Further Analysis | Revert unauthorized changes to a known safe state from backups. Isolate affected systems if suspicious logon scripts are confirmed to mitigate further propagation. Ensure that all accounts have strong authentication measures to prevent unauthorized access and script modification. Conduct a security audit of permissions and access controls on directories storing logon scripts. Engage with IT operations to streamline a change management process to safeguard against unauthorized script modifications. |
