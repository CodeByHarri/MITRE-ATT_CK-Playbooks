# Modify_Cloud_Compute_Infrastructure:_Revert_Cloud_Instance - T1578004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1578.004 |
| MITRE Sub-TTP | T1578.004 |
| Name | Modify Cloud Compute Infrastructure: Revert Cloud Instance |
| Log Sources to Investigate | To investigate this TTP, focus on cloud management logs, which capture actions taken within the cloud environment, including snapshot restores. Examples include AWS CloudTrail logs, Azure Activity logs, and Google Cloud Audit logs. Also, examine API access logs for unauthorized or unusual API calls related to snapshot restoration or VM instance resets. Additionally, review logs related to instance lifecycle events (start, stop, terminate) and any attached storage modifications. |
| Key Indicators | Key indicators for this technique include sudden or unusual snapshot restoration activities, particularly outside of normal business hours or without corresponding change management records. Look for API calls associated with snapshot restorations, especially if not typically executed by the user or service account in question. Monitor for any instances of ephemeral storage usage immediately followed by VM reboots or deletions, which may indicate attempts to use temporary storage to discard evidence. |
| Questions for Analysis | 1. Was the snapshot restoration authorized and documented in the change management system?<br>2. Does the timestamp of the snapshot restorations correlate with any known maintenance or update periods?<br>3. Are there abnormal patterns in snapshot restoration frequency or timing for specific VMs? 4. Who initiated the API calls related to snapshot restorations, and are these accounts expected to perform such actions? |
| Decision for Escalation | Escalate to Tier 2 if the snapshot restoration activity is unauthorized or there is no corresponding change request. Also, escalate if there's evidence of repeated or unusual API activity related to VM or storage modifications, particularly involving sensitive or critical systems. |
| Additional Analysis Steps for L1 | Verify the legitimacy of snapshot restoration by consulting the change management records and speaking with relevant system administrators. Review the user accounts involved in API calls for any suspicious behavior, and confirm whether the actions were expected. Check if there are any associated indicators of compromise (IOCs) such as concurrent access from unrecognized IP addresses or geolocations. |
| T2 Analyst Actions | Conduct a deeper analysis of the specific VM instances affected, including a review of system and application logs for any signs of compromise. Assess the user accounts involved for any history of anomalous activity. Audit other VMs and storage in the environment for similar restoration or reset patterns. If necessary, engage with cloud provider support for more detailed logs or assistance. |
| Containment and Further Analysis | Isolate the affected VMs to prevent further malicious activity. Disable compromised user accounts or API keys. Review full activity logs to identify all malicious actions taken during the attack. Restore affected systems from known good snapshots if necessary, and update access controls to prevent future unauthorized actions. Additionally, employ threat intelligence to assess whether this activity aligns with known attack profiles and modify detection rules accordingly to prevent future incidents. |
