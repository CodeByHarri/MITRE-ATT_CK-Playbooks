# Compromise_Infrastructure:_Server - T1584004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Resource Development |
| MITRE TTP | T1584.004 |
| MITRE Sub-TTP | T1584.004 |
| Name | Compromise Infrastructure: Server |
| Log Sources to Investigate | Review firewall logs to identify unusual inbound or outbound traffic patterns that may suggest adversary control over a compromised server. Inspect web server logs for unexpected connections or access patterns, particularly those involving administrator pages or sensitive directories. Check IDS/IPS alerts for signs of exploit attempts or suspicious traffic aimed at web services. Account for DNS query logs that might indicate unusual domain resolutions associated with the server's IP. Analyze endpoint detection and response (EDR) logs for activities such as file execution and privilege escalation on systems associated with the compromised server. |
| Key Indicators | Detection of anomalous inbound connections from high-risk regions or IP addresses associated with known malicious activity. Identification of unexpected user agents or combinations of user agent strings in web server logs. Sudden spikes in server resource usage such as CPU or bandwidth that coincide with traffic to external command and control servers. Changes in DNS records that redirect traffic to unfamiliar domains without authorization. Logs showing remote execution commands or unauthorized user account activity on the server. |
| Questions for Analysis | Is there evidence of unusual login attempts or successful logins from external IPs on the server? Are there any indicators of unauthorized file upload or download activity? Has the server been communicating with known malicious IP addresses or domains? Can we identify any link between the compromised server and ongoing phishing or watering hole campaigns? What processes are running on the server that might be indicative of compromise? |
| Decision for Escalation | Escalate to Tier 2 if evidence of persistent unauthorized access or control of the server is identified. If logs show communication with known malicious infrastructure, or if sensitive data has been exfiltrated, escalate immediately. Also, escalate if there are indications of broader campaign activities across multiple servers or if the compromised infrastructure is being used in active attacks such as phishing. |
| Additional Analysis Steps for L1 | Verify the server's ownership and ensure there are no expected changes from authorized parties. Compare current server configurations and network behavior against known baselines to identify deviations. Cross-reference observed IPs and domains with threat intelligence databases for known malicious associations. Check for any open vulnerabilities or outdated software versions that could have contributed to the compromise. |
| T2 Analyst Actions | Conduct a thorough forensic review of the compromised server, looking for web shells, scripts, or other malicious artifacts. Perform IR (Incident Response) scans to determine lateral movement or any pivoting activity to other internal systems. Collaborate with IT to implement additional monitoring and logging on the compromised server. Assess the extent of data access or exfiltration and report findings to management and relevant stakeholders. |
| Containment and Further Analysis | Isolate the compromised server from the network to prevent further misuse. Ensure all accessed sensitive data is classified for potential disclosures. Apply patches and security updates to fix any vulnerabilities that were exploited. Work with IT to restore services using backup configurations known to be clean. After containment, perform a full review of all access credentials and consider resetting them to prevent re-access using compromised details. Monitor closely for any attempts to regain access post-containment. |
