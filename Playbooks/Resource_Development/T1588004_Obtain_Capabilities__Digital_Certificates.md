# Obtain_Capabilities:_Digital_Certificates - T1588004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Resource Development |
| MITRE TTP | T1588.004 |
| MITRE Sub-TTP | T1588.004 |
| Name | Obtain Capabilities: Digital Certificates |
| Log Sources to Investigate | Investigate logs related to network traffic, web server access, and system logs for certificate-related events. Examples include: 1. Web server logs for entries showing new or unusual certificate usage.<br>2. Network traffic logs indicating encrypted communications over non-standard ports.<br>3. Certificate management logs for recent changes or additions to digital certificates, especially those linked to external domains. 4. Domain registration and DNS logs indicating registration or changes, which may suggest domain hijacking or new domain creation. |
| Key Indicators | 1. Unusual SSL/TLS certificate registrations or changes, especially without prior documented need or approval.<br>2. Network traffic indicating the use of SSL/TLS certificates to encrypt C2 traffic over unexpected channels.<br>3. Attempts to install root certificates especially if it involves recently compromised user accounts or unauthorized privileged access. 4. Logs showing communication with certificate authorities from unexpected IP addresses or with unusual domain validation requests. 5. Domain registration logs showing new domains registered that are similar to known ones or with minor variations. |
| Questions for Analysis | 1. Are there logs indicating unapproved SSL/TLS certificate applications or installations?<br>2. Is there evidence of encrypted traffic that does not match expected business operations or data flows?<br>3. Has there been any recent activity that involved domains being hijacked or newly registered? 4. Are there known phishing or malware campaigns associated with the domains registered during this period? 5. Have there been anomalies in user behavior that might suggest credentials are being used to validate illegitimate certificate requests? |
| Decision for Escalation | Escalate to Tier 2 if: 1. The source of the SSL/TLS certificates cannot be verified or is suspicious.<br>2. There is identified encrypted traffic that cannot be decoded using expected methods and appears to be part of a C2 infrastructure.<br>3. Unauthorized certificate installations have been detected. 4. The domain associated with a certificate shows signs of hijacking, registration under false pretenses, or is linked to command and control activities. 5. There are indicators of phishing, man-in-the-middle attacks, or other fraudulent activities. |
| Additional Analysis Steps for L1 | 1. Correlate certificate acquisition logs with known legitimate business processes.<br>2. Verify if the domain, IP, or certificate matches any existing threat intelligence sources.<br>3. Check for recent access attempts using privileged accounts involved in certificate-related activities. 4. Review historical logs for patterns suggesting gradual buildup of capabilities or infrastructural changes indicating preparatory steps for attack. |
| T2 Analyst Actions | 1. Conduct deep packet inspection to further investigate suspicious encrypted traffic.<br>2. Verify the legitimacy of all digital certificates and correlate with legitimate business need.<br>3. Analyze compromised domains for any patterns relating to known threat actor activity. 4. Explore potential data exfiltration or further compromise driven by the certificates. 5. Use threat intelligence feeds to identify possible adversary TTPs matching the certificates and traffic patterns. |
| Containment and Further Analysis | 1. Revoke any unauthorized certificates and block associated C2 infrastructure.<br>2. Isolate and monitor systems interfacing suspicious encrypted traffic for further data movement.<br>3. Strengthen monitoring of certificate authorities and implement enhanced validation practices for certificate requests. 4. Execute domain reputation checks and blocks for domains identified as hijacked or malicious. 5. Conduct a security review of privileged account management policies to ensure resilience against unauthorized certificate installation or use. |
