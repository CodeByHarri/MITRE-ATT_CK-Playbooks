# Stage_Capabilities:_Drive-by_Target - T1608004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Resource Development |
| MITRE TTP | T1608.004 |
| MITRE Sub-TTP | T1608.004 |
| Name | Stage Capabilities: Drive-by Target |
| Log Sources to Investigate | Investigate web proxy logs to identify unusual browsing behavior. Analyze DNS logs for connections to newly registered domains or domains similar to legitimate ones. Review web server logs from any internal web applications to detect script modifications or unexpected script injections. Collect endpoint detection and response (EDR) logs to identify any suspicious web content executed or browser vulnerabilities exploited. Audit ad traffic logs if applicable, to detect malvertising activities. |
| Key Indicators | Presence of unknown or suspicious JavaScript files in web pages. Data in web proxy or firewall logs showing access to domains that are homoglyphs or typosquatted versions of legitimate sites. Increased volume of advertisements displaying on sites with high traffic from targeted sectors. Discovery of writable cloud storage instances being used to host modified scripts or content. Indicators of browser profiling activities, such as collections of user agent strings. |
| Questions for Analysis | Have unusual domains been accessed recently by multiple users? Are there any web pages displaying unexpected content changes or script injections? Has there been an increase in the concentration of advertisements on target sites? Are there any HTTP requests that do not align with typical user behavior? Do logs show any signs of successful or attempted exploitation of browser vulnerabilities? |
| Decision for Escalation | Escalate if there is evidence of successful script injection or alteration on high-profile web assets. Also escalate if browser profiling scripts are detected or if there are connections to newly registered domains that resemble those of legitimate services. If multiple endpoints exhibit signs of compromise after visiting a certain site, escalate immediately. |
| Additional Analysis Steps for L1 | Correlate DNS queries with known indicators of compromise. Verify recent changes in web server content management systems for unauthorized modifications. Conduct search for any alerts concerning web-related exploits or anomalies in EDR. Check for presence of suspicious activity patterns aligned with typical watering hole attack behaviors, such as targeting specific sector websites. |
| T2 Analyst Actions | Perform deeper analysis of network traffic and examine payloads of unusual web requests. Cross-reference findings with threat intelligence databases for known threat actor TTPs. Use sandboxing to safely analyze any captured web payloads suspected of being malicious. Investigate the ownership and registration details of suspicious domains accessed by users. |
| Containment and Further Analysis | Ensure malicious content injected into web pages is removed and vulnerabilities patched. Block access to identified suspicious domains and review firewall rules for tightening. Implement browser security updates across endpoints. Consider segmenting networks to prevent lateral movement of any active malicious entities. Capture and preserve forensic evidence for further examination and potential legal action. |
