# Credentials_from_Password_Stores:_Securityd_Memory - T1555002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1555.002 |
| MITRE Sub-TTP | T1555.002 |
| Name | Credentials from Password Stores: Securityd Memory |
| Log Sources to Investigate | Investigate system logs and memory dumps for unusual access patterns. Key logs include<br>- 'system.log' and 'securityd' logs in macOS logging system, which may provide information on processes interacting with 'securityd'.<br>- Capture and analyze memory dumps specifically focusing on the heap memory of 'securityd' for signs of unauthorized keychain access attempts.<br>- Check 'console.log' for any unusual user activity around disk or memory interrogation utilities.<br>- Baseline activity for processes accessing keychain files and look for anomalies.<br>- Monitor for sudo or root escalation logs, particularly any abnormal uses shortly prior to captured memory access alerts. |
| Key Indicators | Indicators of potential credential access involve:<br>- Unusual high privileges required file access patterns, especially targeting '/var/db/SystemKey' paths.<br>- Presence of tools or scripts that attempt to dump process memory or use 'ptrace' against 'securityd'.<br>- Unrecognized or unapproved processes running with elevated privileges under contexts accessing keychain services.<br>- Evidence of process injection activities targeting 'securityd' or similar services.<br>- High volume of access or attempts to access encrypted data without regular application or user pattern. |
| Questions for Analysis | 1. Was there a legitimate administrative or maintenance task scheduled at the time of the detected memory access?<br>2. Is there any running process that doesn't align with expected baselines attempting to access 'securityd'?<br>3. Have there been any reports of users experiencing unusual prompts for keychain access?<br>4. Are there other security alerts triggering concurrently that could corroborate suspicious behavior?<br>5. Have these indicators been observed in conjunction with known threat patterns or actor behaviors? |
| Decision for Escalation | Escalate to Tier 2 if:<br>- Access to 'securityd' memory is confirmed without scheduled maintenance or identifiable legitimate need.<br>- There are corroborative events from multiple detection sources indicating potential compromise.<br>- Evidence suggests the potential dumping or decryption of keychain contents.<br>- Unknown or suspicious processes are observed with root privileges accessing secure memory. |
| Additional Analysis Steps for L1 | 1. Isolate and review any processes running at the time of alert with elevated privileges.<br>2. Correlate memory access alerts with any relevant deviation in network traffic, e.g., unusual outbound connections.<br>3. Check for recent modifications or access to keychain databases and validate if those actions were authorized.<br>4. Collect and archive logs for further forensic analysis by Tier 2.<br>5. Ensure the integrity and version of security patches for components related to keychain management are up to date. |
| T2 Analyst Actions | 1. Perform a detailed memory analysis using forensic tools to determine if passwords have been exfiltrated.<br>2. Validate all root or privileged access requests logged against approved administrative activities.<br>3. Use threat intelligence feeds to identify any associated IOCs with observed activity.<br>4. Assess the integrity of 'securityd' service and system components for tampering.<br>5. Conduct a deeper inspection of network activities possibly related to keychain exfiltration efforts. |
| Containment and Further Analysis | 1. Immediately isolate affected systems from the network to prevent further credential leakage.<br>2. Conduct a full investigation to reconstruct the timeline and scope of credential exposure.<br>3. Roll out a password change policy for impacted users and systems.<br>4. Implement enhanced monitoring for repeated or new patterns of the same TTP post-containment.<br>5. Update and patch affected systems to cover any exploitable vulnerability leading to the credential access. |
