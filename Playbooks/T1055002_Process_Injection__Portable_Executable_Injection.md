# Process_Injection:_Portable_Executable_Injection - T1055002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Privilege Escalation |
| MITRE TTP | T1055.002 |
| MITRE Sub-TTP | T1055.002 |
| Name | Process Injection: Portable Executable Injection |
| Log Sources to Investigate | 1. Windows Security Event Logs: Look for event IDs related to process creation (e.g., 4688) that might indicate unexpected threads in processes.<br>2. Sysmon Logs: Monitor for events like Sysmon Event ID 8 (CreateRemoteThread) and Event ID 10 (Process Access) which can highlight suspicious process injection attempts.<br>3. Network Logs: Capture any anomalous outbound traffic from the injected process that may suggest further communication by the adversary. 4. Application Logs: Logs from security software may give insight into process manipulation if configured to detect suspicious API calls like VirtualAllocEx or WriteProcessMemory. |
| Key Indicators | 1. Invocation of API calls: Unusual or high volume of calls to VirtualAllocEx, WriteProcessMemory, or CreateRemoteThread.<br>2. Anomalous process behavior: Processes that do not typically spawn threads might indicate injection (e.g., notepad.exe creating a thread).<br>3. Threads in unexpected locations: Code executing in unusual memory space regions of processes. 4. Memory scans: Look for signs of read/write operations to injected memory segments within a running process. |
| Questions for Analysis | 1. Is there a legitimate reason for the process to have these threads or memory allocations?<br>2. Are the involved processes known to exhibit this behavior under normal circumstances?<br>3. Are there any known vulnerabilities or exploits related to the affected processes? 4. Is there recent unusual filesystem or network activity associated with the affected processes? |
| Decision for Escalation | Escalate if: 1. The process exhibiting injection behavior is not typically associated with such activities.<br>2. Identified API calls were made in rapid succession or without legitimate user action.<br>3. Any of the injected code or process activity is linked to known malicious hashes or signatures. 4. Evidence of persistence mechanisms being deployed following injection (e.g., changes to Auto-run Registry keys). |
| Additional Analysis Steps for L1 | 1. Correlate the suspicious process activity with user behavior and schedule to rule out false positives.<br>2. Cross-reference detected anomalies with threat intelligence databases to check for known patterns.<br>3. Verify affected processes against baseline process behavior to ascertain deviations. |
| T2 Analyst Actions | 1. Conduct memory analysis on the affected machine to identify injected code fingerprints.<br>2. Examine and verify the origin and legitimacy of any parent-child process relationships.<br>3. Review historical data for anamolies within other systems to check for broader compromise. 4. Engage with threat intelligence to assess if the behavior matches ongoing campaigns or known TTPs. |
| Containment and Further Analysis | 1. Quarantine the affected systems to prevent lateral movement and additional compromise.<br>2. Preserve all related logs and memory captures for later forensic analysis.<br>3. Conduct a thorough integrity check on all processes to identify potential privilege escalations or rootkits. 4. Apply patches or upgrades to address any known vulnerabilities that could have been exploited. 5. Follow up by scanning the network for lateral movement, ensuring that no other systems exhibit signs of process injection. |
