# Process_Injection:_Thread_Execution_Hijacking - T1055003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Privilege Escalation |
| MITRE TTP | T1055.003 |
| MITRE Sub-TTP | T1055.003 |
| Name | Process Injection: Thread Execution Hijacking |
| Log Sources to Investigate | To effectively investigate T1055.003 - Thread Execution Hijacking, focus on the following log sources: <br>1. Windows Security Event Logs: Look for event IDs related to thread creation (e.g., 8 - Thread Vetted by ETW) or manipulation (e.g., 133 - Thread Profiling Event). <br>2. Windows API Monitoring: Logs capturing API calls like OpenThread, SuspendThread, WriteProcessMemory, SetThreadContext, and ResumeThread. <br>3. EDR Solutions: Endpoint Detection and Response tools that monitor process and thread activity, such as process injection alerts or suspicious memory accesses. Examples of such logs include suspicious memory allocation within running processes. <br>4. File/System Monitoring Tools: Logs from tools that capture unusual file access patterns or memory writes in processes change monitoring. <br>5. Network Traffic Logs: Any suspicious network connections initiated by typically benign processes could suggest injected behavior. |
| Key Indicators | 1. The presence of OpenThread, SuspendThread, and ResumeThread API calls executed in a sequence. <br>2. Memory allocation in unusual processes through VirtualAllocEx. <br>3. WriteProcessMemory logs where the written content resembles executable code patterns. <br>4. Unexpected changes in thread context within a process captured by SetThreadContext. <br>5. Logged use of process and thread manipulation functions typically used in injection techniques. <br>6. Anomalous increase in process memory usage. <br>7. Concurrent process hollowing or code injection alerts in legitimate applications. |
| Questions for Analysis | 1. Is the process that started the suspicious thread known for performing injections or modifications under normal behavior? <br>2. Are there legitimate explanations for API calls related to thread manipulation? <br>3. Can the imported modules or recent interactions associated with the process explain the suspicious memory writes? <br>4. Is the process verified with known signatures or checksums (hash values)? <br>5. Are there any recent software installations or updates that could account for typical process modifications? |
| Decision for Escalation | Escalate to Tier 2 if: <br>1. Multiple key indicators correlate, suggesting potential malicious intent. <br>2. A benign explanation for thread manipulation or code injection cannot be identified. <br>3. Similarities with known attack patterns or previous cases are detected. <br>4. Thread manipulation activity is associated with a process that handles sensitive data or has high privileges. |
| Additional Analysis Steps for L1 | 1. Review recent logs for other suspicious activities associated with the process thread manipulation. <br>2. Verify process legitimacy through cross-referencing with known and trusted software versions. <br>3. Check for correlated alerts triggered in close temporal proximity. <br>4. Document any potential false positives or benign reasons for the observed behavior. <br>5. Collect and save related logs and relevant memory dump captures for further analysis. |
| T2 Analyst Actions | 1. Conduct a deep dive forensic analysis, including memory analysis on affected endpoints to verify the presence of injected code. <br>2. Reverse engineer suspicious code segments to determine their objective or intent. <br>3. Cross-check the process and related activity against threat intelligence databases. <br>4. Assess the potential impact, including whether the code executed attained elevated privileges. <br>5. Provide detailed reports and recommendations for remediation if further action is warranted. |
| Containment and Further Analysis | 1. Isolate the affected system from the network to prevent lateral movement. <br>2. Terminate the suspicious threads or processes if confirmed malicious and assess the scope of infection. <br>3. Implement application whitelisting or similar controls to restrict the execution and injection into legitimate processes. <br>4. Verify system integrity via system recovery checks and restore from clean backups if necessary. <br>5. Continuously monitor and log any further indicators of compromise across the network, adjusting defensive measures based on outcomes. |
