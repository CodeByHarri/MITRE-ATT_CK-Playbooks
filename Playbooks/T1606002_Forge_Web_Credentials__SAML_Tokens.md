# Forge_Web_Credentials:_SAML_Tokens - T1606002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1606.002 |
| MITRE Sub-TTP | T1606.002 |
| Name | Forge Web Credentials: SAML Tokens |
| Log Sources to Investigate | Collect logs from the following sources: <br>- Identity Provider (IdP) logs, specifically focusing on authentication and SSO activities.<br>- Active Directory Federation Services (AD FS) logs to track token creation and federation trust activities.<br>- Security Information and Event Management (SIEM) logs for alerts related to unusual token usages.<br>- Web application logs that rely on SAML authentication to detect abnormal login attempts.<br>- Network Logs and Traffic Analysis Tools (e.g., NetFlow) to identify lateral movement or data exfiltration following token use. |
| Key Indicators | Look for: <br>- Unusual issuance of SAML tokens, especially with extended lifetimes beyond typical settings.<br>- Creation or modification of token-signing certificates not scheduled or expected.<br>- Sudden increase in logins or authorization requests from accounts leveraging SAML tokens.<br>- Instances of SAML assertions granting broad or sensitive privileges detected in logs.<br>- New federations being configured in the AD FS without proper change control documentation. |
| Questions for Analysis | Guide the investigation with these questions: <br>- Are there any anomalies in the token issuance times or validity periods that don't match expected patterns?<br>- Have there been any recent changes to federation trust configurations or SAML policies?<br>- Are there authenticating users or IP addresses associated with past suspicious activities?<br>- Is there a spike in the usage of privileges by tokens beyond usual operational hours or from unexpected locations? |
| Decision for Escalation | Escalate to Tier 2 if: <br>- You observe unauthorized or suspicious creation or modification of token-signing certificates.<br>- There are tokens issued with privileges that exceed typical user roles, especially granting admin or Entra ID rights.<br>- Suspicious changes to AD FS configurations or new federations without documentation.<br>- Detection of SAML token usage tied to IPs or devices known to be involved in recent security incidents. |
| Additional Analysis Steps for L1 | For thorough initial analysis: <br>- Validate if the tokens being used were recently issued or appear forged by comparing with historical data.<br>- Cross-reference with historical access logs to identify deviations from normal access patterns.<br>- Confirm the legitimacy of any changes in AD FS and federation trusts with the responsible IT staff. |
| T2 Analyst Actions | Steps for Tier 2 include: <br>- Conduct deeper forensic analysis on the systems issuing the tokens to identify potential compromise.<br>- Review access control and SAML configuration policies to verify that they match security baselines.<br>- Perform threat intelligence correlation to see if IPs or techniques are linked to known threat actors.<br>- Consult with internal stakeholders to validate any legitimate, though undocumented, configuration changes. |
| Containment and Further Analysis | Include these steps for containment: <br>- Invalidate all active sessions involving the affected SAML tokens to prevent further abuse.<br>- Temporarily disable any compromised token-signing certificates and reissue them after investigation.<br>- Apply patches or security updates if the compromise was linked to known vulnerabilities.<br>- Conduct a full network scan and endpoint analysis to detect any lateral movement or data exfiltration attempts.<br>- Re-assess federation trust agreements and SAML configurations to ensure they align with the organization's security posture. |
