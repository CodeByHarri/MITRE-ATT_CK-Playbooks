# System_Network_Connections_Discovery - T1049

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1049 |
| MITRE Sub-TTP | T1049 |
| Name | System Network Connections Discovery |
| Log Sources to Investigate | Relevant log sources include network traffic logs, intrusion detection system (IDS) logs, and endpoint detection and response (EDR) logs. For Windows environments, PowerShell logs (Event ID 4104), and command line logging (Event ID 4688) can be insightful. On Linux systems, audit logs, bash history, and command execution logs should be examined. Additionally, review cloud provider logs such as AWS VPC Flow Logs, Azure Network Watcher logs, or Google Cloud VPC Flow Logs for unexpected connection listings or unusual virtual network activity. |
| Key Indicators | Key indicators include an unusual frequency of network discovery commands (e.g., netstat, lsof) being run, particularly by non-administrative users or in atypical timeslots. Unexpected network connections or mapping activities logged, such as increased connection requests to unknown or rarely accessed IP addresses. Alerts generated by IDS regarding reconnaissance behavior, especially scanning for open ports or active sessions. In cloud environments, sudden enumeration of VPC networks or abrupt changes in network traffic patterns can also be indicative. |
| Questions for Analysis | Are there any unusual command executions related to network discovery? Was the action performed by a compromised account or an account with abnormal activity patterns? Are there unfamiliar external IPs or services being accessed? Does the accessing entity have a legitimate reason to be performing network discovery at this scale? |
| Decision for Escalation | Escalate if network discovery commands are executed by unauthorized or unexpected users, especially if coupled with other anomaly detection alerts like scanning activities. Escalate if there is potential lateral movement indicated by increased connections being made to critical infrastructure within the network, or if sensitive data exfiltration activity is also observed. |
| Additional Analysis Steps for L1 | Verify the legitimacy of user activity by checking associated timestamps, user roles, and correlating with scheduled tasks or approved changes. Review historical logs to identify patterns of similar activities. Cross-reference with potential IOCs related to known adversaries or campaigns. |
| T2 Analyst Actions | Perform a deeper investigation into the context and scope of the reconnaissance, including looking at previous and subsequent activities by the same user or system. Apply threat intelligence to correlate activity with known threat actors or groups. Analyze retrieved network logs further for potential data movements. Conduct user behavior analysis for deviations from the norm. |
| Containment and Further Analysis | Restrict or remove access for unauthorized users or systems performing unwanted discovery. Implement filtering rules to block unauthorized attempts to access internal network maps or sensitive data. Engage in active monitoring for additional signs of compromise or unusual behavior. If necessary, scoping using honeypots or additional decoys can help identify the presence and intention of adversaries more accurately. Finally, conduct a post-incident review to strengthen network defenses and improve detection capabilities. |
