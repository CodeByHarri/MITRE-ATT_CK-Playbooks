# Dynamic_Resolution - T1568

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Command and Control |
| MITRE TTP | T1568 |
| MITRE Sub-TTP | T1568 |
| Name | Dynamic Resolution |
| Log Sources to Investigate | Look into DNS logs for unusual patterns or frequent changes in domain resolution that could indicate algorithmically derived domains. Network traffic logs should also be examined for connections to suspicious or rapidly changing IP addresses. Proxy logs can provide details on DNS resolutions and internet access patterns that align with dynamic resolution behavior. Firewall logs can help identify connections to command and control servers based on resolved domains. Consider including data from antivirus solutions or endpoint detection and response (EDR) tools that may detect or have flagged suspicious dynamic DNS activity. |
| Key Indicators | Frequent or rapid changes in resolved IP addresses for the same domain name. Connections to domains with characteristics of domain generation algorithms (DGA), such as non-human readable domain names. Detection of fallback communications after primary command and control loss. Increased frequency of DNS requests for unusual domains from a single host. Alerts from threat intelligence solutions related to known malicious dynamic DNS services or DGAs. |
| Questions for Analysis | Is there a pattern of repeated changes in resolved IP addresses for the same domain? Are the domain names in the logs consistent with known domain generation algorithms? Is there a correlation between the suspicious DNS activity and alerts from other security tools, such as antivirus or EDR? Does the frequency of the DNS requests exceed typical user behavior for the host in question? |
| Decision for Escalation | Escalate to Tier 2 if multiple indicators suggest the use of a domain generation algorithm, especially in combination with anomalies in other log sources such as network or proxy logs. If suspicious behavior aligns with known threats or threat intelligence, or if the DNS behavior results in connections to known malicious IPs. |
| Additional Analysis Steps for L1 | Verify the legitimacy of the domains in question by checking them against known threat intelligence sources. Review WHOIS information for newly observed or suspicious domains. Check endpoint security logs for any detection of malware or corroborating suspicious behavior. |
| T2 Analyst Actions | Perform deeper inspection of the domains and resolved IPs, utilizing threat intelligence and external databases such as VirusTotal for reputational context. Monitor network traffic for unusual patterns or behavior associated with the resolved IPs. Check for corroborative data in system event logs that might indicate lateral movement or execution of payloads. Pivot on indicators of compromise to identify related suspicious activities. |
| Containment and Further Analysis | Isolate affected systems displaying dynamic resolution patterns to prevent further communication with possible command and control servers. Block identified malicious IPs or domains at the firewall or proxy level. Conduct a comprehensive scan of the affected systems for malware using updated antivirus and malware detection tools. Perform a root cause analysis to determine how the threat gained a foothold and assess any data exfiltration that may have occurred. |
