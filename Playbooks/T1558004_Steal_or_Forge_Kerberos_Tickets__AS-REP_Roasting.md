# Steal_or_Forge_Kerberos_Tickets:_AS-REP_Roasting - T1558004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1558.004 |
| MITRE Sub-TTP | T1558.004 |
| Name | Steal or Forge Kerberos Tickets: AS-REP Roasting |
| Log Sources to Investigate | Investigate logs from Domain Controllers for unusual AS-REQ and AS-REP traffic patterns. Windows Security Event logs, especially those pertaining to Kerberos authentication (e.g., Event ID 4768 for AS-REQ and Event ID 4769 for AS-REP) can be useful. Monitor network traffic for anomalies using Network Security Monitoring (NSM) tools or SIEM solutions that register requests without preauthentication. Analyze PowerShell execution logs if available to detect scripted queries against LDAP for preauthentication disabled accounts. |
| Key Indicators | AS-REQ messages sent without preauthentication from a source IP that generates a high volume of such requests, AS-REP responses following these requests. Repeated AS-REP traffic associated with accounts that have preauthentication disabled. Usage of PowerShell commands to enumerate accounts, especially those querying LDAP for the 'userAccountControl' flag indicating accounts with disabled preauthentication. |
| Questions for Analysis | Has there been an unusual increase in AS-REQ requests followed by AS-REP responses for specific accounts? Are there PowerShell commands detecting accounts with preauthentication disabled? Do the activities originate from unusual or unrecognized IP addresses or accounts? Is the frequency of requests unusually high for typical network behavior? |
| Decision for Escalation | Escalate to Tier 2 if there is: confirmation of high volume AS-REQ without preauthentication from suspicious sources, evidence of PowerShell use for enumeration against LDAP targeting preauth-disabled accounts, unusual patterns in the Kerberos logs pointing to potential credential cracking activity, or if cracked hash details align with reported credentials used anomalously across the network. |
| Additional Analysis Steps for L1 | Correlate instances of AS-REQ and AS-REP with known user behavior and network activity patterns. Validate whether the requesting IP or account aligns with expected operational behavior. Review history for any recent changes to account configurations that might explain preauthentication disabling. Gather additional context about the IP address, host, or account in question to identify any historical issues or security alerts. |
| T2 Analyst Actions | Perform deep-dive analysis on logs to map all AS-REP replies to their corresponding AS-REQ requests. Verify whether password cracking tools were employed post-AS-REP responses by examining endpoint and user activity. Cross-check the flagged activities against user and network baseline behavior. If compromises are found, identify affected accounts and assess the extent of access gained through cracked credentials. |
| Containment and Further Analysis | Use directory service configuration to enforce preauthentication on accounts previously disabled for it. Isolate networks or systems that generated suspicious activity for further forensic analysis. Start resetting any potentially compromised account credentials and monitor for any residual activity post-account resets. Conduct a network-wide review to patch or reconfigure systems that might allow similar exploits in the future. Use threat intelligence feeds to ascertain the threat actor profiles frequently exploiting this vulnerability. |
