# System_Binary_Proxy_Execution:_Regsvr32 - T1218010

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1218.010 |
| MITRE Sub-TTP | T1218.010 |
| Name | System Binary Proxy Execution: Regsvr32 |
| Log Sources to Investigate | To investigate the suspicious use of Regsvr32, the following log sources should be considered: 1. Windows Security Logs: Check for Event ID 4688 (A new process has been created) that logs when regsvr32.exe is executed.<br>2. PowerShell Logs: If Regsvr32 is used in conjunction with PowerShell, logs may show corresponding script executions.<br>3. Network Traffic Logs: Examine for unusual traffic patterns, such as requests to external URLs linked to Regsvr32 executions. 4. Application Whitelisting Logs: Investigate logs from application control solutions which might flag unusual Regsvr32 usage not in line with typical patterns. 5. Endpoint Detection and Response (EDR) Platform Logs: These can provide insights into process lineage and telemetry, involving regsvr32.exe as a parent process. |
| Key Indicators | Key indicators of a possible malicious use of Regsvr32 include: 1. Regsvr32.exe execution from non-standard directories.<br>2. Command line arguments that include URLs, indicating potential Squiblydoo exploitation.<br>3. Unscheduled or anomalous associations of regsvr32 with sensitive or unexpected programs. 4. Network connections by regsvr32 to remote servers that are known malicious or are outside usual usage patterns (e.g., IPs not associated with typical business functions). 5. Registration or execution attempts without prior user action or task scheduling. |
| Questions for Analysis | To assess the legitimacy of the detection, consider these questions: 1. Was the execution of Regsvr32 aligned with any scheduled tasks or expected IT processes?<br>2. Are the URLs or network destinations involved recognized as part of legitimate business processes?<br>3. Is there any abnormal behavior observed in user accounts associated with the Regsvr32 execution? 4. Have there been previous incidents involving Regsvr32.exe on this system? 5. Is the DLL executed by Regsvr32 known and trusted within the environment? |
| Decision for Escalation | Escalate to Tier 2 if: 1. Regsvr32.exe was executed with potentially malicious URLs or unknown network destinations.<br>2. The DLLs or COM objects registered/executed are not recognized as trusted within the enterprise context.<br>3. Associated user account activities demonstrate anomalies that indicate potential compromise. 4. There is a connection to known malicious IPs or domains. 5. Standard environmental baselines or whitelisting policies are violated. |
| Additional Analysis Steps for L1 | Initial steps for Tier 1: 1. Verify the command-line argument details involving the use of regsvr32.exe using EDR or appropriate logging tools.<br>2. Cross-check the URLs with threat intelligence feeds for any possible reputation issues.<br>3. Review the user and system activity logs immediately preceding and following the regsvr32 events. 4. Confirm the time of activity with organization usual working hours to identify anomalies. 5. Gather and document findings accurately for escalation if necessary. |
| T2 Analyst Actions | Upon escalation, Tier 2 should: 1. Conduct a deeper analysis of the network traffic associated with regsvr32.exe execution.<br>2. Investigate historical data involving regsvr32 on the host to identify any recurring patterns.<br>3. Determine if there are any lateral movements or credential theft associated with the account. 4. Perform forensic analysis on the affected system's memory image or file artifacts. 5. Correlate data with any active threat actor campaigns targeting the organization. |
| Containment and Further Analysis | Containment steps are critical: 1. Isolate affected systems from the network to prevent further malicious activity or potential exfiltration.<br>2. Disable suspicious user accounts if suspected of being compromised.<br>3. Block malicious IPs or domains involved with the regsvr32.exe execution on the firewall. 4. Track and potentially block regsvr32.exe invocation that matches suspicious patterns using application control policies. 5. Engage in a root cause analysis to discover initial access vectors and deploy mitigation strategies organization-wide. |
