# Obfuscated_Files_or_Information:_Polymorphic_Code - T1027014

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1027.014 |
| MITRE Sub-TTP | T1027.014 |
| Name | Obfuscated Files or Information: Polymorphic Code |
| Log Sources to Investigate | Focus on logs that can capture execution and mutation activities such as: <br>1. Endpoint Detection and Response (EDR) logs: Look for execution of unexpected binaries or scripts. <br>2. Antivirus/Antimalware logs: Look for instances where polymorphic code caused repeated signature-based detection failures. <br>3. Application and System Event logs: Identify unusual application execution patterns. <br>4. File Integrity Monitoring (FIM): Changes in binary or script files' hashes. <br>Examples include Windows Event Logs, Linux syslogs, and third-party security tool logs. |
| Key Indicators | 1. Frequent changes in hash values of specific executables or scripts. <br>2. High entropy values indicating code obfuscation. <br>3. Failure patterns in antivirus detections targeting the same piece of malware with different signatures. <br>4. Presence of mutation engines or libraries often used to create polymorphic code.<br>5. Multiple or unexpected packers or compressors used on executable files. |
| Questions for Analysis | 1. Do the logs indicate repeated execution attempts of the same process with different file hashes? <br>2. Is there evidence of failed signature-based detections at similar timestamps across logs? <br>3. Are there any known indications of a mutation engine (specific calls or libraries) in the file or process being executed? <br>4. Are the observed files or processes known to have legitimate uses within the organization? |
| Decision for Escalation | Escalate to Tier 2 when: <br>1. The investigation shows persistent undetected execution attempts with changing hashes. <br>2. There is confirmed use of polymorphic code libraries without a legitimate business need. <br>3. Found significant overlap with known threat actor TTPs involving polymorphic malware. |
| Additional Analysis Steps for L1 | 1. Verify whether the executables suspected of being polymorphic have any known legitimate use in the organization. <br>2. Cross-reference hashes of detected files against threat intelligence databases and sources. <br>3. Consult antivirus logs for patterns of detection and misleading error messages. <br>4. Communicate with users or business units to confirm legitimacy of identified processes. |
| T2 Analyst Actions | 1. Perform deeper static and dynamic analysis of suspicious files to verify polymorphic properties. <br>2. Update signatures within antimalware tools to address identified polymorphic variants. <br>3. Engage in threat hunting to identify further instances or patterns of polymorphic attacks. <br>4. Review network traffic associated with the polymorphic code executables to identify any additional malicious activity or C2 communication. |
| Containment and Further Analysis | 1. Isolate affected systems from the network to prevent further spread. <br>2. Perform forensic analysis to comprehensively understand the changes and behavior of the polymorphic malware. <br>3. Clean the system of any persistent polymorphic malware presence by restoring from a trusted backup and applying updated security patches. <br>4. Coordinate with incident response teams for potential breaches and further examine threat intelligence on identified campaign to preempt further attacks. |
