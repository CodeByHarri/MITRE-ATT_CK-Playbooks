# Proxy:_Multi-hop_Proxy - T1090003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Command and Control |
| MITRE TTP | T1090.003 |
| MITRE Sub-TTP | T1090.003 |
| Name | Proxy: Multi-hop Proxy |
| Log Sources to Investigate | Network traffic logs, firewall logs, and proxy logs should be examined to identify multiple proxy hops or unusual patterns of communication. Specifically, look into logs from network detection and response (NDR) systems, SIEM platforms, or traffic monitoring tools to detect anomalies. Examples include Blue Coat, Cisco Umbrella logs, or NetFlow data to identify unexpected TOR traffic (excessive encrypted outbound connections) and uncommon TCP/UDP ports usage. |
| Key Indicators | Look for multiple outbound connections made in rapid succession to different destinations that could indicate a chained proxy setup. Frequent changes in source IPs for outbound connections, connections to known TOR exit nodes, or IPs associated with VPS providers anonymously with short-lived connections, as well as unusual ICMP traffic patterns, could indicate the presence of multi-hop proxying. |
| Questions for Analysis | Is there encrypted traffic going to and coming from TOR entry/exit nodes? Are there multiple connections in short succession pointing to different parts of the globe? Are there known compromised endpoint devices being used as a proxy? Is there evidence of custom code on network devices indicating potential compromise? |
| Decision for Escalation | Escalate to Tier 2 analysts if there is evidence of connections to multiple known proxy services or TOR network, or if there are indicators of layered encryption that cannot be immediately explained. Additionally, escalate if any compromised devices are identified or if lateral movement through the network is suspected beyond initial ingress. |
| Additional Analysis Steps for L1 | Check connection timestamps and frequency. Validate IP reputation to determine if endpoints are linked to anonymization services like VPNs or TOR. Review any associated domain names for reputational concerns using threat intelligence feeds. Verify if any internal network devices are generating unusual traffic patterns. |
| T2 Analyst Actions | Conduct deeper packet inspection where possible to analyze payloads for patterns indicating known malicious operations. Assess and review compromised devices for signs of further exploitation. Cross-check identified exit nodes with threat intelligence to validate malicious associations. Evaluate chain of proxies through netflow analysis or other network telemetry tools. |
| Containment and Further Analysis | Block identified malicious IPs and domains at firewalls to prevent ongoing connections. Isolate affected network devices to prevent further communication. Review and update firewall and proxy configurations to detect and mitigate usage as exit nodes. Investigate the potential exploitation path used to install custom proxy software on devices and patch identified vulnerabilities. Consult with internal incident response teams to ensure comprehensive containment and review telemetry data for residual malicious traffic. |
