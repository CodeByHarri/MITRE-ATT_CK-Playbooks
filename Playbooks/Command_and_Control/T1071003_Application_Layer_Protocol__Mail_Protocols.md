# Application_Layer_Protocol:_Mail_Protocols - T1071003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Command and Control |
| MITRE TTP | T1071.003 |
| MITRE Sub-TTP | T1071.003 |
| Name | Application Layer Protocol: Mail Protocols |
| Log Sources to Investigate | Examine email server logs such as those from Microsoft Exchange, Postfix, or other SMTP services that capture details like sender, recipient, and metadata of email communications. Inspect network traffic logs from firewall or intrusion detection/prevention systems (IDS/IPS) for anomalies in SMTP/S, POP3/S, and IMAP traffic. Review endpoint logs for unusual activity related to email clients, such as unauthorized access to mailboxes or unexpected email sending events. Utilize SIEM integrations to correlate these logs for pattern identification. |
| Key Indicators | Unusual increase in outbound emails within a short time frame, particularly to external addresses. Presence of suspicious encoded commands or attachments in email content. Abnormal connection patterns to unknown or irregularly contacted mail servers, especially with encrypted traffic. Unexpected login attempts to email services, possibly from non-standard geographic locations or IP addresses listed in threat intelligence feeds. |
| Questions for Analysis | Are there any anomalies in the volume of email traffic or patterns, such as time of sending or recipients? Do the email headers or content have encoded data or scripts that could signal command and control communication? Are there any login attempts to email services that deviate from normal user behavior, in terms of time and location? |
| Decision for Escalation | Escalate if there is evidence of communication with known malicious IP addresses or domains, significant deviations in email communication patterns without a clear business justification, or detection of encoded or encrypted content in email traffic that aligns with known attack techniques. |
| Additional Analysis Steps for L1 | Validate the normal baseline of email traffic for the organization to distinguish legitimate variance. Check email headers for unusual metadata or identifiers that may indicate spoofing or relay attempts. Correlate with threat intelligence to identify if any of the email servers or recipients are flagged for suspicious activities. |
| T2 Analyst Actions | Conduct deep packet inspection of the email traffic to decode possibly concealed messages or commands. Engage with threat intelligence to narrow down potential adversary tactics related to detected anomalies. Perform historical analysis to identify any prior related incidents or data exfiltration activities. Engage with users involved in the suspicious email transactions to verify the legitimacy of communication. |
| Containment and Further Analysis | If malicious communication is confirmed, block the identified malicious IPs or domains at the network perimeter. Quarantine affected user accounts and conduct a comprehensive review of their email logs for further signs of compromise. Notify affected stakeholders and initiate the incident response plan. Consider deploying mail filtering solutions to enhance detection of suspicious email patterns in the future. |
