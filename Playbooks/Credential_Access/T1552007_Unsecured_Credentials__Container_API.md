# Unsecured_Credentials:_Container_API - T1552007

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1552.007 |
| MITRE Sub-TTP | T1552.007 |
| Name | Unsecured Credentials: Container API |
| Log Sources to Investigate | Investigate logs related to container orchestration systems such as Docker and Kubernetes. This includes:<br>1. Docker Daemon logs - can reveal unauthorized API access attempts.<br>2. Kubernetes API server logs - look for unusual service account activities.<br>3. Audit logs from cloud platforms if containers are hosted in the cloud, which might log accesses to container-related services.<br>4. Network logs that can trace API calls made from suspicious IP addresses or hosts.<br>5. Pod logs from Kubernetes, especially focusing on operations related to secret management.<br>Example: /var/log/docker.log for Docker and /var/log/kube-apiserver.log for Kubernetes. |
| Key Indicators | 1. Unusual or unauthorized API requests to Docker or Kubernetes API endpoints.<br>2. Access attempts from unfamiliar IP addresses or using unauthorized service accounts.<br>3. Retrieval of secrets or API credential data from pods unexpectedly.<br>4. Elevated access or permissions modifications to service accounts or API access tokens.<br>5. Anomalous patterns in network traffic to API endpoints, such as spikes in access rates or data exfiltration-like activities. |
| Questions for Analysis | 1. Were there any unauthorized or unexpected API calls detected in the logs?<br>2. Is there any evidence of access to sensitive resources such as credentials or secrets?<br>3. Are there indications that service account permissions have been altered or exploited?<br>4. Does network traffic show access to API endpoints from unfamiliar sources?<br>5. Have there been any changes to API configurations that could indicate tampering? |
| Decision for Escalation | Escalate to Tier 2 if:<br>1. Unauthorized access to API logs reveals access to critical credentials or data.<br>2. There are brute force attempts or multiple failed API authentication logs.<br>3. Discovery of lateral movement attempts via service accounts within the container environment.<br>4. Confirmed unauthorized changes or access to critical API configurations or secrets. |
| Additional Analysis Steps for L1 | 1. Verify the source of any unauthorized API calls using network logs.<br>2. Review access control policies around API credentials and service accounts.<br>3. Assess if there are any recent changes or deployments that coincide with the suspicious activity.<br>4. Check for known vulnerabilities or misconfigurations in container environments and APIs.<br>5. Validate any alerts with cross-referencing to unrelated logs or alerts for correlation. |
| T2 Analyst Actions | 1. Perform a deeper dive into network traces to understand the scope and source of the access.<br>2. Investigate lateral movement patterns and signs of persistence establishment.<br>3. Validate if accessed credentials have been used elsewhere in the infrastructure.<br>4. Analyze patch levels on container management systems to check for exploitation of known vulnerabilities.<br>5. Conduct a risk assessment to understand potential impact and exposure. |
| Containment and Further Analysis | 1. Isolate affected containers or pods to prevent further unauthorized access.<br>2. Rotate compromised service account credentials and API keys immediately.<br>3. Implement additional monitoring on API endpoints for anomalous behavior.<br>4. Engage incident response team to assess and remediate potential exploitations.<br>5. Update and audit configurations and security policies related to API access controls. |
