# Steal_or_Forge_Authentication_Certificates - T1649

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1649 |
| MITRE Sub-TTP | T1649 |
| Name | Steal or Forge Authentication Certificates |
| Log Sources to Investigate | Investigate Windows Event Logs for certificate-related events, such as EID 4624 (Logon), 4670 (Permissions on an object were changed), and 4906 (Certificate service completed), as well as any unusual enrollment requests or renewals of certificates. Look for logs from certificate services (AD CS), which may indicate unauthorized or suspicious certificate requests or renewals. Additionally, review file access logs on certificate storage locations and trace command-line activity with logging tools like Sysmon or PowerShell logging to capture certificate manipulation actions. |
| Key Indicators | Look for newly issued/renewed certificates that were not requested through typical administrative processes, especially those with EKU values that grant high-level access. Identify abnormal access to encrypted storage locations for certificates, such as the Windows Certificate Store or the Registry. Monitor for the use of crypto API functions that interact unnaturally with certificates, file operations on certificate files by strange or new processes, and large export logs of certificates using tools that interact with certificate stores. |
| Questions for Analysis | Has there been any unusual level of access or permissions change on key certificate files or certificate services? Are there any unauthorized certificate requests or renewals? Do the accessed certificates or certificate requests have abnormal EKU or SAN values? Is there a pattern of behavior indicating lateral movement associated with the certificates being inspected? |
| Decision for Escalation | Escalate to Tier 2 if there are indications of unauthorized access to the certificate server, such as suspicious certificate issue/renewal patterns, odd or unauthorized SSH/command execution logs, changes to certificate authority permissions, or identifiers linked to high-risk TTPs like 'golden' certificates. |
| Additional Analysis Steps for L1 | Cross-reference certificate access events with user account activity over the same period. Verify the legitimacy of recent certificate requestors by reviewing Active Directory account activity. Check any accessed SANs against known legitimate names and look for anomalies. Utilize correlation techniques to determine if certificate activities resulted in abnormal network communications. |
| T2 Analyst Actions | Conduct a deep dive into affected systems, meticulously reviewing the certificate logs for signs of data manipulation. Perform a review of historical certificate issuance policies and look for discrepancies in current policy configurations. Contact certificate requestors if necessary and verify intent. Use detailed forensic tools to analyze possibly compromised hosts for signs of harmful certificate tools. |
| Containment and Further Analysis | Revoke any unauthorized or suspicious certificates immediately to prevent further misuse. Initiate containment on systems showing evidence of certificate-related tampering. Reconfigure CA policies to require stricter validation for certificate issuance. Conduct a patch and fortification review of the Certificate Authority infrastructure. Use threat intelligence feeds to identify known IOCs linked to adversaries exploiting authentication certificates. |
