# OS_Credential_Dumping:_LSASS_Memory - T1003001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1003.001 |
| MITRE Sub-TTP | T1003.001 |
| Name | OS Credential Dumping: LSASS Memory |
| Log Sources to Investigate | Monitor Windows Event Logs, specifically the Security and System logs for suspicious activity related to LSASS and process creation. Collect and analyze logs from Sysmon for process creation events (Event ID 1) where 'procdump', 'rundll32.exe' with 'comsvcs.dll', or similar tools are used. Security Event ID 4688 logs may also capture process creation with suspicious command-line arguments. Monitor Registry changes to HKLM\SYSTEM\CurrentControlSet\Control\Lsa for potential unauthorized SSP DLL entries. Collect and monitor Windows Error Reporting logs that might indicate abuse of WerFault.exe. |
| Key Indicators | Unusual process creations involving 'procdump', 'rundll32.exe', or accessing LSASS memory. Changes to LSA related registry keys, such as additions to Security Packages Registry keys. Evidence of LSASS memory dumps, file creation events for .dmp files. Abnormal use of 'WerFault.exe' potentially indicating silent process exit mechanism exploitation. |
| Questions for Analysis | Was the process creation associated with known, legitimate administrative activity? Is the executing user or process running as SYSTEM or a privileged account? Are there corresponding logs indicating legitimate use of process dump tools? Are there known threats or alerts related to LSASS memory dumps or credential access? Has there been a recent change in administrative personnel or IT activities scheduled? |
| Decision for Escalation | Escalate to Tier 2 if there's evidence of unauthorized access to LSASS memory with suspicious tools or command lines without a clear business justification. Escalate if Registry entries related to LSA have been modified without documented change management. Any evidence of potential credential dumping should be escalated. |
| Additional Analysis Steps for L1 | Confirm whether the processes related to LSASS dumps correlate with authorized activities or scheduled tasks. Verify the legitimacy of the user or service account executing these processes. Check for any associated alerts that capture anomalous behavior or activity post credential dumping attempt. |
| T2 Analyst Actions | Conduct a thorough investigation of the timeline surrounding suspicious activities to identify potential lateral movement attempts. Analyze forensic artifacts from impacted hosts to detect unauthorized credential access. Review historical changes to the Registry keys associated with LSA. Conduct network analysis to identify any indicators of compromise or connections to known malicious URLs/IPs that might indicate exfiltration or further compromise. |
| Containment and Further Analysis | Isolate the affected system(s) to prevent further potential credential access or lateral movement. Remove or revert unauthorized Registry modifications related to LSA. Patch and update systems to mitigate exploitation vulnerabilities used in the attack. Consider resetting affected credentials or implementing additional authentication mechanisms, such as MFA, to prevent future unauthorized access. Monitor for any repeating patterns or recurring indicators of compromise. |
