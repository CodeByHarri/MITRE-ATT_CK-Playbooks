# Credentials_from_Password_Stores:_Keychain - T1555001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1555.001 |
| MITRE Sub-TTP | T1555.001 |
| Name | Credentials from Password Stores: Keychain |
| Log Sources to Investigate | Investigate logs from macOS security-related events, especially focusing on Keychain access events. Specific logs to check include:<br>- System logs located in '/var/log/system.log' for Keychain access attempts.<br>- Audit logs available via Apple's Unified Logging System using the 'log' command with predicates filtering for Keychain or security.<br>- Endpoint detection and response (EDR) solutions that monitor command-line activities, especially for the 'security' command involved in Keychain operations. |
| Key Indicators | Look for:<br>- Execution of 'security dump-keychain' command, particularly with '-d' option.<br>- Unusual access to Keychain file paths such as '~/Library/Keychains/login.keychain-db' outside of normal usage patterns.<br>- Sudden changes or edits in the Keychain Access application logs.<br>- Access attempts from non-standard or unauthorized user accounts.<br>- Failed attempts to access Keychain if incorrect passwords were supplied. |
| Questions for Analysis | Tier 1 analysts should ask:<br>- Was there a legitimate reason for accessing Keychain files during this period?<br>- Are there any corresponding user actions that justify such access patterns, such as system admin tasks?<br>- Was this activity observed within a usual working timeframe for the user/account involved?<br>- Has the user/system previously accessed the Keychain in this manner or is this a deviation from the norm? |
| Decision for Escalation | Escalate to Tier 2 if:<br>- Unauthorized access is detected without clear justification or legitimate user activity.<br>- The access pattern is anomalous from historical behavior.<br>- Associated suspicious activities such as concurrent failed logins or indicators of compromise are observed.<br>- The Keychain access coincides with indicators of ongoing exploit attempts or data exfiltration. |
| Additional Analysis Steps for L1 | L1 analysts should:<br>- Correlate Keychain access logs with user activity logs to verify patterns.<br>- Confirm whether the 'security' command usage could be tied to legit administrative or maintenance tasks.<br>- Determine any repeated patterns of access attempts especially those that failed, indicating brute-force or scripted activities. |
| T2 Analyst Actions | Tier 2 should:<br>- Conduct deeper forensic analysis on the system to uncover hidden activities or signs of compromise.<br>- Use threat hunting techniques to search for additional indicators such as unusual network traffic or processes initiated by unauthorized accounts.<br>- Reconstruct usage timelines to understand the context of the access attempts and correlate them with other alerts or known threats. |
| Containment and Further Analysis | Containment steps include:<br>- Temporarily locking the user account involved to prevent further unauthorized access.<br>- Isolating the affected system from the network to prevent data exfiltration.<br>- Resetting credentials and implementing additional access controls on the keychain.<br>Further analysis should include:<br>- Comprehensive review of the system for any malware signatures or artifacts.<br>- Detailed audit of account activities to ensure no lateral movement or privilege escalation has occurred.<br>- Update and strengthen security policies to mitigate future risks, including user education on potential phishing tactics targeting credentials. |
