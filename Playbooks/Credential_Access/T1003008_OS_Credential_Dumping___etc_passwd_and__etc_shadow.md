# OS_Credential_Dumping:__etc_passwd_and__etc_shadow - T1003008

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1003.008 |
| MITRE Sub-TTP | T1003.008 |
| Name | OS Credential Dumping: /etc/passwd and /etc/shadow |
| Log Sources to Investigate | Monitor system logs, especially /var/log/auth.log and /var/log/secure to detect unauthorized access or activities indicating privilege escalation. Analyze command history logs, such as bash history, for suspicious commands like 'unshadow' usage. Also, examine /var/log/syslog for unusual processes or file access patterns. Leveraging Linux audit framework logs (auditd) can be key to capturing access to /etc/passwd and /etc/shadow files, as well as any file creation under suspicious directories like /tmp. |
| Key Indicators | Key indicators include attempts to access or read the /etc/shadow file, especially by non-root users or unexpected processes. The presence of the 'unshadow' command execution, output files like /tmp/crack.password.db, especially if created without proper administrative privileges, and any unexplained use of tools known for password cracking like John the Ripper in non-standard environments. |
| Questions for Analysis | Did any unauthorized user or process attempt to access /etc/shadow? Were there any anomalies in user login patterns or unauthorized root logins around the time of access? Is the use of 'unshadow' and other password cracking utilities consistent with legitimate system administration activities? Are there any suspicious outbound connections following this activity potentially indicating data exfiltration? |
| Decision for Escalation | Escalate to Tier 2 if there is evidence of unauthorized access to /etc/passwd or /etc/shadow, unusual command usage, or if key indicators align with possible credential dumping or password cracking activities. Immediate escalation is warranted if there is potential compromise of privileged accounts or detection of active usage of password cracking tools without legitimate context. |
| Additional Analysis Steps for L1 | Verify the integrity of /etc/passwd and /etc/shadow by checking for unauthorized modifications. Review system logs to confirm any suspicious account activities and validate the root permissions on sensitive files. Identify recent logins and map IP addresses to known company assets to detect any anomalies. |
| T2 Analyst Actions | Perform a deeper forensic analysis of the affected systems, including memory and disk analysis if possible. Investigate network traffic data for signs of exfiltration or abnormal connections. Conduct a thorough audit of nearby timestamps against other critical system logs to determine lateral movement or further compromise. |
| Containment and Further Analysis | Immediately revoke suspicious sessions or tokens related to compromised accounts. Change credentials for affected users, especially if sensitive hashes are suspected to be leaked. Enable enhanced monitoring on compromised systems and adjust firewall rules to block potential exfiltration pathways identified. Collaborate with the security team to conduct a post-incident review and reinforce defenses against such attacks in the future. |
