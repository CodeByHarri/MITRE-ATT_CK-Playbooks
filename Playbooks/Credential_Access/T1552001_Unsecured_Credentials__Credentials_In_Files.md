# Unsecured_Credentials:_Credentials_In_Files - T1552001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1552.001 |
| MITRE Sub-TTP | T1552.001 |
| Name | Unsecured Credentials: Credentials In Files |
| Log Sources to Investigate | 1. File access logs - Monitor logs that record file access to identify unauthorized attempts to read or copy credential files. Examples include audit logs on Windows or Linux systems.<br>2. Network file share logs - Check logs that track access to shared resources. Unauthorized access to servers hosting configuration or credential files can be indicative.<br>3. Cloud access logs - For environments like AWS CloudTrail or Azure Activity Logs, which may show access to configuration files containing credentials. 4. Command execution logs - Review logs from monitoring tools such as Sysmon or auditd to detect suspicious processes that involve access to credential files. |
| Key Indicators | 1. Unusual user accounts or service accounts accessing credential files, especially if it's outside of normal operating hours or from unexpected locations.<br>2. Commands in shell history suggesting attempts to access or copy credential files, such as 'cat', 'grep', 'copy', 'scp'.<br>3. Access to Group Policy Preferences XML files which may contain credential information. 4. Elevated privileges used inappropriately to access sensitive file paths. |
| Questions for Analysis | 1. Was the access attempt to the credential file initiated by a known and trusted application or user?<br>2. Is the file access consistent with the user's behavior or role?<br>3. Are there any anomalies in access patterns or geolocations that suggest this might be unauthorized access? 4. Are there failed access attempts preceding a successful access? |
| Decision for Escalation | Escalate to Tier 2 if: 1. There's evidence of unauthorized access or exfiltration of credential files.<br>2. Access was made by an unexpected or unauthorized user, especially if using elevated privileges.<br>3. Suspicious network activity correlates with file access, such as data exfiltration indicators. 4. If repeated access to sensitive files indicates potential credential scanning or harvesting. |
| Additional Analysis Steps for L1 | 1. Verify the legitimacy of the user or application accessing the credential files.<br>2. Cross-reference with company policy to determine whether the file access was authorized.<br>3. Gather context around the access event, such as user authentication logs, to further understand the situation. 4. Look for concurrent suspicious activities in system and network logs. |
| T2 Analyst Actions | 1. Conduct deeper forensic analysis on the host to determine how the access was initiated.<br>2. Review surrounding network traffic for potential lateral movement or data exfiltration activities.<br>3. Correlate events with other internal or external intelligence to understand if this is part of a broader attack. 4. Analyze other endpoints or servers that may show signs of similar unauthorized access attempts. |
| Containment and Further Analysis | 1. Isolate the affected systems if unauthorized access is confirmed.<br>2. Reset credentials for compromised accounts or applications.<br>3. Implement network segmentation to restrict access to sensitive files. 4. Enhance logging and monitoring to capture detailed events of similar incidents in the future. 5. Perform a security audit of current credential storage practices to address any vulnerabilities. |
