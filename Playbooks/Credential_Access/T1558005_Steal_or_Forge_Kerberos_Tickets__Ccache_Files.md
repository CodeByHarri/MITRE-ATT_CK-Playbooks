# Steal_or_Forge_Kerberos_Tickets:_Ccache_Files - T1558005

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1558.005 |
| MITRE Sub-TTP | T1558.005 |
| Name | Steal or Forge Kerberos Tickets: Ccache Files |
| Log Sources to Investigate | 1. File Access Logs: Monitor access to and modification of ccache files, typically located in /tmp directory on Linux (e.g., krb5cc_%UID% or krb5.ccache).<br>2. Process Logs: Look for processes executing kinit, klist, or unauthorized access scripts/tools (like Kekeo).<br>3. Authentication Logs: Review for unusual or unauthorized login attempts or reuse of authentication tokens. 4. System Logs: Check for changes to /etc/krb5.conf or alterations to the KRB5CCNAME environment variable. |
| Key Indicators | 1. Unusual time-stamped access or modification of ccache files.<br>2. Execution of uncommon or unauthorized tools (like Kekeo) for Kerberos ticket manipulation.<br>3. Sudden or unexplained clear-text credentials usage where such actions are not expected. 4. Suspicious changes in environment variables related to Kerberos ticket storage. |
| Questions for Analysis | 1. Were any legitimate administrative activities logged that could explain recent ccache file access?<br>2. Has there been an increase in failed authentication attempts around the time of the observed activities?<br>3. Are the users or systems involved typically associated with the observed types of access or tools? 4. Is there any user reporting unusual account behavior or lockouts? |
| Decision for Escalation | Escalate to Tier 2 if you observe clear evidence of ccache file tampering or unauthorized use of tools like Kekeo, unexplained changes in Kerberos configurations, or if suspicious access correlates with other potential attack indicators such as brute force attacks or concurrent system alerts. |
| Additional Analysis Steps for L1 | 1. Verify the source of the ccache file access or modification.<br>2. Check for any scheduled tasks or cron jobs that may have triggered the access.<br>3. Correlate file access times with user activity logs or recent updates/changes. 4. Validate if thereâ€™s any newly installed software or scripts executed around the time of the incident. |
| T2 Analyst Actions | 1. Conduct a deeper investigation into user activity logs and cross-reference with other systems logs for patterns.<br>2. Review recent changes to key configuration files related to Kerberos and authentication services.<br>3. Engage with potentially affected users to verify their activities and check for anomalies. 4. Expand the scope to check for lateral movement across the network. |
| Containment and Further Analysis | 1. Isolate affected systems from the network to prevent further unauthorized activity.<br>2. Reset passwords and invalidate sessions for affected user accounts.<br>3. Review and potentially reconfigure Kerberos settings to prevent further exploitation. 4. Conduct a thorough forensic analysis to identify the initial entry point and scale of the breach. 5. Inform impacted teams and stakeholders and review the complete incident response plan tailored to this threat. |
