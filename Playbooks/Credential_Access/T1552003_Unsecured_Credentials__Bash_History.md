# Unsecured_Credentials:_Bash_History - T1552003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1552.003 |
| MITRE Sub-TTP | T1552.003 |
| Name | Unsecured Credentials: Bash History |
| Log Sources to Investigate | Investigate shell command history logs and file modification events, specifically monitoring access to the ~/.bash_history file. Use audit logs or file integrity monitoring solutions to track when this file is accessed or modified. Additionally, review terminal session logs, process execution logs, and potentially relevant authentication logs to check for suspicious command usage and patterns. |
| Key Indicators | Key indicators include unexpected or unauthorized access to the ~/.bash_history file, presence of command sequences in the history file that contain plaintext credentials, and unusual commands executed via Bash that appear to enumerate or search through history files. Other indicators might involve irregular time stamps of .bash_history file access aligned with non-working hours. |
| Questions for Analysis | 1. Was the access to ~/.bash_history expected or did it occur outside normal user behavior patterns?<br>2. Is there evidence of credentials stored in the history file?<br>3. Did the user associated with the access have a legitimate reason to interact with this file?<br>4. Are there related logins or activities that suggest a potential compromise of this user's account?<br>5. Are there other anomalies or unauthorized activities associated with this account? |
| Decision for Escalation | Escalate to Tier 2 if there are unauthorized accesses to ~/.bash_history, any retrieval of plaintext credentials, concurrent anomalies suggesting credential misuse, or if there is a pattern of unusual access to this file. Additionally, escalate if similar activity is observed across multiple accounts or systems. |
| Additional Analysis Steps for L1 | 1. Verify the identity and credentials of the user who accessed the ~/.bash_history file.<br>2. Check if the same pattern of history access is noted across different systems.<br>3. Analyze related command histories for illegitimate use of credentials.<br>4. Establish a timeline of the user's activities and correlate with known events (e.g., logins and logouts). |
| T2 Analyst Actions | 1. Conduct a deeper investigation into potential lateral movement or compromised credentials.<br>2. Utilize threat intelligence to correlate the activity with known attack vectors or adversaries.<br>3. Assess whether there is an ongoing active threat that requires immediate containment.<br>4. Collaborate with IT or security teams to implement controls that could mitigate further risk. |
| Containment and Further Analysis | 1. Notify affected users and initiate a credential reset procedure.<br>2. Implement enhanced monitoring on the system and related accounts to detect further anomalous activity.<br>3. Consider isolating impacted systems to prevent lateral movement.<br>4. If applicable, review and improve user security education around credential storage and command-line practices.<br>5. Document and review the incident, updating security policies and procedures as necessary. |
