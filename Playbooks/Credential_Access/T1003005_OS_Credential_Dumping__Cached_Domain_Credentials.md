# OS_Credential_Dumping:_Cached_Domain_Credentials - T1003005

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1003.005 |
| MITRE Sub-TTP | T1003.005 |
| Name | OS Credential Dumping: Cached Domain Credentials |
| Log Sources to Investigate | Investigate logs from endpoint detection and response (EDR) solutions, host-based intrusion detection systems (HIDS), and Windows Event Logs, specifically Security logs (4624 - Logon event, 4688 - Process Creation), and Audit logs for credential access events. For Linux, check audit logs and system logs for suspicious activity involving SSSD and Quest Authentication Services. Collect data from application logs if services like Mimikatz, secretsdump.py, or Linikatz were executed. Network logs should also be reviewed for any signs of unauthorized access to domain controllers. |
| Key Indicators | User account repeatedly querying for cached credentials or excessive access attempts on `/var/lib/sss/db/cache.[domain].ldb` or `/var/opt/quest/vas/authcache/vas_auth.vdb`. Detection of tools like Mimikatz or Linikatz being executed. Unexpected process creation events tied to 'secretsdump.py'. Abnormal logon attempts or process executions by SYSTEM or sudo users. Anomalous network activity directed at domain controllers that align with login attempts using previously unseen IP addresses. |
| Questions for Analysis | Was there any unauthorized access to SYSTEM or sudo privileges? Are there any unusual patterns in logon attempts associated with specific user accounts? Do timestamps correlate with known legitimate user behavior? Were any credential extraction tools executed against the system? Are there alerts from other security controls during the same timeframe? Have there been recent changes in policies regarding cached credential storage or retention? |
| Decision for Escalation | Escalate if unauthorized SYSTEM or sudo access was gained, if there are signs of Mimikatz, Linikatz, or secretsdump.py execution, or if there is any unusual access pattern to cached domain credentials. Additionally, escalate if visible credential extraction tools or scripts are present without explanation, or if there have been anomalies in account logins suggesting a potential breach. |
| Additional Analysis Steps for L1 | Review the list of users and processes accessing cached credentials. Check for the presence of known credential harvesting tools. Verify current and historical patterns of access to sensitive files. Collate details from vulnerability scans or security tools reports. Consult with users to confirm legitimate use cases if possible. Ensure endpoint protection logs are thoroughly reviewed. |
| T2 Analyst Actions | Perform in-depth analysis using sandbox environments to verify suspicious binaries. Correlate activities with known threat intelligence on tools and tactics associated with the TTP. Identify potential lateral movement by reviewing historical access logs on associated systems. Conduct OSINT to gather more information on attack vectors and threat actors. Collaborate with IT teams to validate any unauthorized configuration changes. |
| Containment and Further Analysis | Isolate affected systems to prevent lateral movement. Restrict or disable compromised accounts and initiate password reset protocol. Collect full disk images for forensic analysis. Review and enhance existing endpoint security rules to detect similar behavior in the future. Consider deploying additional endpoint logging capabilities. Evaluate and update security policies concerning cached credentials. Prepare a report summarizing findings and recommended mitigations. |
