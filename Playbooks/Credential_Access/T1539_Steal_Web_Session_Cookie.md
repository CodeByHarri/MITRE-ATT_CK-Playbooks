# Steal_Web_Session_Cookie - T1539

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1539 |
| MITRE Sub-TTP | T1539 |
| Name | Steal Web Session Cookie |
| Log Sources to Investigate | Log sources to investigate include web server access logs to detect unusual session login events, especially from new or unrecognized locations (e.g., Geo-location changes or login attempts from TOR exit nodes); application logs from users accessing sensitive services or cloud-hosted platforms; endpoint security logs from anti-malware solutions that might catch cookie-stealing malware; and browser logs capturing requests to unauthorized websites, possibly indicating exploitation attempts or cookie exfiltration. |
| Key Indicators | Key indicators include detection of unauthorized login sessions from different geolocations using the same session cookies, similar user-agent strings across multiple and potentially suspicious IP addresses, unexpected or unusual cookie values on user devices indicating manipulation, and increase in JavaScript execution events within browser logs not linked to typical user behavior. |
| Questions for Analysis | Questions for analysis include: Has there been any unexpected login events or attempts from unusual IP addresses or locations? Are there any discrepancies in user-agent strings in session logs suggesting impersonation? Are there any known vulnerabilities or incidents involving the affected user accounts or web services? Have there been any recent successful executions of JavaScript files from unknown sources in the browser? |
| Decision for Escalation | Decision for escalation involves verifying if there is concrete evidence of unauthorized session access or misused session cookies, instances of sensitive data transmission from unauthorized endpoints, multiple users reporting similar issues, or detection of indicators linked to known malicious frameworks like Evilginx2. |
| Additional Analysis Steps for L1 | Additional analysis steps for L1 include verifying user login history and correlating with IP addresses and geolocation data, checking for concurrent logins from vastly different physical locations, cross-referencing any recently executed scripts within browsers, and checking for signs of malware infection like unexpected browser extensions or processes. |
| T2 Analyst Actions | T2 Analyst Actions involve deep packet inspection of network traffic for signs of cookie exfiltration, using threat intelligence to confirm if the observed behavior matches known cookie-stealing toolkits, conducting full host analysis for potentially infected devices, and exploring browser cache/content for anomalous cookies or script artifacts. |
| Containment and Further Analysis | Containment and further analysis steps include invalidating potentially compromised session cookies and forcing re-authentication for affected accounts, implementing additional logging and monitoring for real-time anomaly detection, reinforcing MFA methods for sensitive services, and patching browsers or web applications known to be vulnerable to cookie session theft. Conduct workshops to educate users on recognizing phishing attempts or malicious JavaScript executions. |
