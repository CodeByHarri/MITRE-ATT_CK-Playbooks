# Forge_Web_Credentials - T1606

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1606 |
| MITRE Sub-TTP | T1606 |
| Name | Forge Web Credentials |
| Log Sources to Investigate | Review logs related to authentication attempts, particularly for APIs and web applications. Focus on AWS logs such as CloudTrail for 'AssumeRole' and 'GetFederationToken' API calls, Zimbra server logs involving 'zmprov gdpak' command usage, and web server logs for unusual session initiation or token issuance activities. Security Information and Event Management (SIEM) integrated with cloud provider logs can simplify this task. Also, inspect access logs for SaaS applications and any system logging user credential manipulations. |
| Key Indicators | Unusual or unchecked usage of API calls related to token generation such as 'AssumeRole' and 'GetFederationToken' in the AWS CloudTrail. Zimbra log entries for 'zmprov gdpak' being run unexpectedly. Abnormal issuance of session tokens or session cookies without corresponding legitimate login events. Sudden spikes in access from known administrative tools or logs indicating user session creation without multi-factor authentication completion. |
| Questions for Analysis | Is there any anomalous activity surrounding the generation or usage of tokens, such as at odd timings or from unexpected IPs? Is there a lack of corresponding login attempts for the generated tokens or sessions? Have there been any unauthorized or uncommon API calls related to credential tasks identified in logs? Are there logs indicating the bypass of regular authentication processes (e.g., missing multi-factor authentication)? |
| Decision for Escalation | Escalate to Tier 2 if there is confirmed unusual invocation of token generation APIs without matching user authentication, repeated attempts from unknown IPs, or logs indicating bypass of established authentication workflows. Escalation is also necessary when a forged credential is used to access sensitive resources without multi-factor authentication. |
| Additional Analysis Steps for L1 | Verify the legitimacy of token generation activities by checking IP addresses, timestamps, and cross-referencing with known user behaviors. Analyze the associated user accounts to see if recent breaches occurred. Ensure that any suspicious token usage aligns with legitimate user activity logs. Use threat intelligence to check IPs / domains involved in the process. |
| T2 Analyst Actions | Deep dive into log correlations for broader context, assessing the full scope of potential compromises. Conduct behavioral analysis of users whose credentials may have been forged. Engage with affected users to verify suspected actions. Utilize cloud provider or service-specific tools to further scrutinize token generation anomalies. Analyze the history of API calls and user activity to identify patterns or prior similar events. |
| Containment and Further Analysis | Revoke all impacted or suspicious tokens and cookies immediately, and force-profile a password reset for potentially affected users. Update access tokens on compromised services to render the forged tokens useless. Review and tighten IAM policies to limit the scope of temporal privileges. Engage forensics to determine the root cause and pathway of the attack. Implement additional logging and monitoring improvements to better detect future similar attempts, incorporating threat intelligence and learning from this incident. |
