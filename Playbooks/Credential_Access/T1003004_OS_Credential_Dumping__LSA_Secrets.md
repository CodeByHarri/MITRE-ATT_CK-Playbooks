# OS_Credential_Dumping:_LSA_Secrets - T1003004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1003.004 |
| MITRE Sub-TTP | T1003.004 |
| Name | OS Credential Dumping: LSA Secrets |
| Log Sources to Investigate | Investigate Windows Security Event Logs for suspicious access patterns to LSA secrets, typically involving Event ID 4672 which signifies special privileges assigned to new logon sessions. Also, review Event ID 4656 and 4663 related to access attempts to the Registry's LSA secret keys. Monitor Endpoint Detection and Response (EDR) logs, specifically for suspicious processes accessing the registry path HKEY_LOCAL_MACHINE\SECURITY\Policy\Secrets. Additionally, check Antivirus/Antimalware logs for detections related to tools like Mimikatz and Reg, and review PowerShell logs (Event ID 4104) for any unusual invocation indicating credential dumping. |
| Key Indicators | Indicators include unauthorized access or modification attempts on the registry key HKEY_LOCAL_MACHINE\SECURITY\Policy\Secrets, processes such as 'reg.exe' or 'mimikatz.exe' accessing sensitive registry paths or memory, unusual spikes in privileged account activities, and PowerShell scripts with parameters indicative of credential access or dumping. |
| Questions for Analysis | 1. Is there evidence of a tool like Mimikatz or similar running on the system?<br>2. Are there unexpected process executions with elevated privileges accessing LSA secrets?<br>3. Is there a legitimate need for accessing these registry keys based on user roles and responsibilities? 4. Are there any signs of lateral movement attempts following the credential dumping? |
| Decision for Escalation | Escalate to Tier 2 if unauthorized access to LSA secrets is confirmed, particularly if accompanied by tools historically associated with credential dumping. Escalation is also necessary if there are signs of compromised privileged accounts being used or attempts at lateral movement. |
| Additional Analysis Steps for L1 | Verify the legitimacy of the processes involved by checking process execution times against known work schedules. Cross-reference user account activities with permissions granted during the session. Correlate any triggered alerts with recent security device signatures or updates. Look for repeat offenders or persistent anomalies across different endpoints. |
| T2 Analyst Actions | Conduct a deeper forensic analysis of potentially compromised hosts to capture memory dumps and corroborate any credential access with forensic artifacts. Verify system integrity by assessing hashes of the suspected binaries with a known good database. Inspect network traffic for any anomalies following the credential access, such as unexpected outbound connections to rare endpoints. |
| Containment and Further Analysis | Immediately isolate affected systems from the network to prevent further propagation. Revoke potentially compromised credentials and initiate reset processes for affected accounts. Enhance monitoring on critical systems for similar signs of intrusion attempts. Review and update the system's security policies to prevent recurrence, including stricter access controls and improved logging to catch such attempts earlier. |
