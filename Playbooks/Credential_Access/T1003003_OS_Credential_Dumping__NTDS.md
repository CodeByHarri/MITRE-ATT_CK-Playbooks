# OS_Credential_Dumping:_NTDS - T1003003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1003.003 |
| MITRE Sub-TTP | T1003.003 |
| Name | OS Credential Dumping: NTDS |
| Log Sources to Investigate | Investigate logs from Windows Security Event Logs, specifically focusing on Event ID 4662 which indicates an attempt to read directory service objects. Also, review logs from Volume Shadow Copy operations, typically found in system event logs, to check for unauthorized creation or access of shadow copies. Additionally, assess any alerts from security monitoring tools for activity from tools like secretsdump.py which may be detected by its specific behaviors and signatures, and review file access logs for unexpected reads of ntds.dit. Logs from backup operations should also be examined for improper access attempts. |
| Key Indicators | Detection of Volume Shadow Copy creation without proper authorization, unusual execution of ntdsutil.exe, artifacts left by secretsdump.py (network traffic patterns, unique log entries), usage of Invoke-NinjaCopy script from unexpected accounts, and any unauthorized access attempts to %SystemRoot%\NTDS\Ntds.dit. Additionally, look for non-standard access times or accounts accessing NTDS.dit. |
| Questions for Analysis | Was the NTDS.dit file accessed recently without a legitimate maintenance rationale? Were any Volume Shadow Copies created or accessed by non-administrative users? Is there evidence of command-line activity or tools execution like secretsdump.py or ntdsutil that seems out of the ordinary? Have backup logs or related alerts flagged any attempted access by suspicious accounts or at unusual times? |
| Decision for Escalation | Escalate to Tier 2 if NTDS.dit file access was unexpected or unauthorized, if there is evidence of Volume Shadow Copy usage linked to potential credential dumping activities, or if tools like secretsdump.py or ntdsutil.exe are executed from accounts lacking the necessary privileges for such actions. Also, escalate if backup files mimicking NTDS content are accessed without legitimate cause. |
| Additional Analysis Steps for L1 | Correlate the timestamps of suspicious activities with known legitimate administrative tasks to rule out false positives. Verify if the accounts involved in accessing NTDS or shadow copies belong to authorized personnel and check if these actions align with scheduled operations. Monitor any further suspicious actions or access patterns linked to the same accounts or systems. |
| T2 Analyst Actions | Perform deeper investigations on system logs and network activities related to the identified suspicious events. Conduct a behavioral analysis of involved accounts and systems, focusing on any previous or subsequent activities indicating further compromise. Cross-reference with threat intelligence databases for known IOCs related to credential dumping tools. |
| Containment and Further Analysis | Immediately restrict access for accounts involved in suspicious activities to prevent further potential data exfiltration. Isolate compromised systems for forensic analysis. Utilize endpoint detection responses (EDR) to identify and halt ongoing malicious processes. Coordinate efforts with IT to restore the integrity of affected domain controllers if necessary. Perform a comprehensive review of security policies to detect and rectify any vulnerabilities exploited during the incident. |
