# Taint_Shared_Content - T1080

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Lateral Movement |
| MITRE TTP | T1080 |
| MITRE Sub-TTP | T1080 |
| Name | Taint Shared Content |
| Log Sources to Investigate | Monitor file system access logs for network shares, focusing on frequent access or modification patterns. Review logs from version control systems, such as Git, for unusual commit activities. Examine Sysmon logs for unexpected process creations and modifications linked to shared directory files. Pay attention to Windows Event Logs, particularly Security Event ID 4663 (An attempt was made to access an object) and 5145 (A network share object was checked for access). Network traffic logs should be inspected for anomalous connections related to shared drive access. Example log sources include Windows Event Viewer, Sysmon, Git logs, and network monitoring tools like NetFlow or Zeek. |
| Key Indicators | Unusual modification of .LNK files in shared directories, especially those linking to unexpected executables. Presence of hidden files that mimic real directories in file shares. Changes to binary files such as .EXE or .DLL in network shares. Anomalous access patterns on shared drives, such as multiple accesses from a single user account, particularly out-of-hours. Detection of scripts or executable modifications in shared locations, and unexplained increase in file size or hash changes of legitimate executables. |
| Questions for Analysis | Are there recent modifications to critical shared files or directories that are not attributed to normal administrative tasks? Have there been abnormal access patterns to shared network directories recently? Have any .LNK files been recently changed that do not correspond with software updates or administrative actions? Are there anomalies in access times, like access attempts during off-hours or from unusual locations? |
| Decision for Escalation | Escalate to Tier 2 if suspicious file alterations are verified, especially if they involve binary files or if there are consistent access pattern anomalies not explained by business operations. Immediate escalation is warranted if there are signs of reinfection or widespread suspicious access across multiple user accounts. |
| Additional Analysis Steps for L1 | Validate any modifications or access against known software updates or administrative changes. Check user activity for legitimate changes or access patterns. Isolate any suspicious files and obtain hashes for further comparison against malware databases. Collaborate with IT to determine if any legitimate processes could have triggered alerts. |
| T2 Analyst Actions | Perform deep forensic analysis of affected shared content, particularly focusing on altered .LNK files and hidden directories. Verify any undocumented changes to files on network shares by comparing file hashes and timestamps with known good states. Assess the scope of the potential compromise by reviewing historical access logs for patterns of similar activity. Conduct detailed user behavior analytics to identify potential lateral movement attempts. Use threat intelligence sources to confirm if the observed activities match known threat actor tactics. |
| Containment and Further Analysis | Immediately isolate affected network shares to prevent further access. Remove or clean any tainted shared files, and restore verified clean backups. Engage endpoint detection and response (EDR) tools to remediate infected endpoints. Implement monitoring of all shared content for unauthorized modifications or access attempts. Conduct a comprehensive review of access control lists (ACLs) and group policies involved in managing network shares. Reassess security measures and awareness training to prevent future attacks. |
