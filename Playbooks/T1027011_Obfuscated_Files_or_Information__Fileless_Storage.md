# Obfuscated_Files_or_Information:_Fileless_Storage - T1027011

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1027.011 |
| MITRE Sub-TTP | T1027.011 |
| Name | Obfuscated Files or Information: Fileless Storage |
| Log Sources to Investigate | To investigate T1027.011 - Fileless Storage, analysts should focus on the following log sources: <br><br>1. **Windows Event Logs** - Review logs related to the Windows Registry and WMI service operations. Look for unusual modifications or high-frequency access to keys or namespaces. <br>2. **Sysmon Logs** - Capture event IDs relating to registry modifications (event ID 13), WMI activity (event ID 19), and process creation (event ID 1) for unusual command-line activity. <br>3. **Security Information and Event Management (SIEM)** - Use correlated data from various sources to baseline normal system behaviors and detect anomalies. <br>4. **Memory Forensics and Volatility** - Analyze live memory to identify injected and loaded modules not present in typical file I/O operations. <br>5. **Linux /var/log files** - Check directory contents mentioned in suspicious activity, particularly under shared memory-like `/dev/shm`, `/run/shm`, `/var/run`. <br>6. **Network Traffic Logs** - Monitor for anomalous data exfiltration patterns, especially over non-standard ports. |
| Key Indicators | Key indicators of fileless storage activities include: <br><br>1. Unusual spikes in registry reads/writes or calls to Windows Management Instrumentation (WMI). <br>2. Processes with high entropy or significant change in memory structure with no corresponding disk I/O. <br>3. Events of encoded bases, scripts or executables being passed via command-line or through WMI commands. <br>4. Unexpected system behavior, such as unauthorized registry key modifications (e.g., persistence-related keys). <br>5. Anomalies in /dev/shm or /run/shm use in Linux systems, such as presence of abnormal executables or data processes. <br>6. Sudden increase or decrease in memory usage without corresponding runtime indicators. |
| Questions for Analysis | 1. Are there unexplained registry or WMI access patterns linked to known processes? <br>2. Have any unauthorized changes been reported in the sensitive parts of the Registry or WMI repository? <br>3. Are there suspicious scripts or executables stored or executed from memory-only locations? <br>4. Have any endpoints shown extraordinary spikes in in-memory operations unrelated to user activity? <br>5. Are system behavioral anomalies corroborated by correlated network logs suggesting potential data exfiltration? |
| Decision for Escalation | Escalate to Tier 2 if: <br><br>1. Unexplainable registry modifications or WMI activity is detected and linked to no documented software updates or normal activity. <br>2. Encoded or encrypted payloads suggest active concealment attempts. <br>3. Anomalous memory-only executable activities cannot be mapped to legitimate use cases or sanctioned activities. <br>4. There is evidence of staged data potentially ready for exfiltration. <br>5. Suspicious connections to C2 infrastructure corroborated by unusual registry/WMI behavior. |
| Additional Analysis Steps for L1 | 1. Cross-reference suspicious registry or WMI entries with known threat intelligence or legitimate application updates. <br>2. Use endpoint security tools to scan memory space for known patterns of injected code. <br>3. Gather timeline data for each unique modification event across log sources. <br>4. Evaluate whether unauthorized changes coincide with known organizational changes or updates. |
| T2 Analyst Actions | 1. Conduct deeper scans using memory forensics to uncover hidden processes or modules. <br>2. Perform detailed threat hunting based on identified anomalies. <br>3. Develop detection mechanisms using behavioral baselining and anomaly detection tuning. <br>4. Validate and prioritize reported exposures by comparing with threat intelligence about active threats. |
| Containment and Further Analysis | 1. Isolate compromised systems and terminate suspicious processes while maintaining evidence integrity. <br>2. Patch any detected vulnerabilities that may have facilitated the attack. <br>3. Implement stricter monitoring and controls for WMI and registry access. <br>4. Reverse engineer any malicious binaries if detected to understand capabilities. <br>5. Conduct a post-incident review to update response strategies and fortify resilience against future fileless attacks. |
