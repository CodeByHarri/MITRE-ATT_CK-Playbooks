# Command_and_Scripting_Interpreter:_PowerShell - T1059001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Execution |
| MITRE TTP | T1059.001 |
| MITRE Sub-TTP | T1059.001 |
| Name | Command and Scripting Interpreter: PowerShell |
| Log Sources to Investigate | Investigate Windows Event Logs, particularly Windows PowerShell logs (Event ID 4103 for PowerShell script block logging, Event ID 4104 for script block text, and Event ID 4105 for commands started using system-wide transcripts). Review Security logs for unusual logins around the execution time. Examine Sysmon logs if available, focusing on process creation events to detect instances of PowerShell being invoked. Network logs should be reviewed for any suspicious outbound connections initiated by PowerShell for file downloads from the internet. |
| Key Indicators | Unexpected execution of powershell.exe, especially with unusual parameters such as '-enc' or '-w hidden'. Network activity associated with PowerShell, including download of files from uncommon or unauthorized domains. Traces of PowerShell scripts or commands executed from locations that donâ€™t typically use PowerShell. Detection of the use of cmdlets like 'Invoke-Command' or 'Start-Process' in non-standard operational contexts. |
| Questions for Analysis | Is the execution of PowerShell script aligned with authorized user actions or business processes? Are there any records indicating download of scripts or executables from external networks? Does the PowerShell command include obfuscation techniques or encoded content? Is the account executing the PowerShell script known to frequently use PowerShell? |
| Decision for Escalation | Escalation is necessary if PowerShell scripts include obfuscated code, encoded commands, or access external networks suspiciously. Also escalate if the usage pattern deviates from the known baseline of normal activity for the account or system involved, or if PowerShell is leveraged by a non-administrative account in an unusual manner. |
| Additional Analysis Steps for L1 | Correlate timestamps of detected PowerShell activity with user login events to determine if user presence was legitimate. Compare activity against established baselines for typical PowerShell usage. Identify additional context such as recent changes to the environment or rare execution contexts. Gather network traffic details related to PowerShell executions. |
| T2 Analyst Actions | Conduct deep analysis of identified PowerShell scripts to determine intent and origin. Reverse engineer any suspicious scripts or code blocks. Analyze network traffic data to trace back suspicious external communications initiated by PowerShell. Validate all route paths of invoked PowerShell scripts across systems involved. |
| Containment and Further Analysis | Implement network isolation for affected hosts to prevent further outbound suspicious connections. Remove or quarantine identified malicious scripts and executables. Reset credentials of any accounts showing compromised activity. Conduct a comprehensive security audit on impacted systems to detect potential lateral movement or persistent threats. |
