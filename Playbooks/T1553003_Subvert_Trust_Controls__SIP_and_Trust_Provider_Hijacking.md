# Subvert_Trust_Controls:_SIP_and_Trust_Provider_Hijacking - T1553003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1553.003 |
| MITRE Sub-TTP | T1553.003 |
| Name | Subvert Trust Controls: SIP and Trust Provider Hijacking |
| Log Sources to Investigate | 1. Windows Security Event Logs: Monitor for events related to registry modifications, particularly under paths like HKLM\SOFTWARE\Microsoft\Cryptography\OID and HKLM\SOFTWARE\Microsoft\Cryptography\Providers. <br>2. Sysmon Logs: Use Sysmon to detect process creation and registry events (Event IDs 13 for registry modification, Event ID 10 for process accessed).<br>3. Application Logs: Logs from applications that perform signature validations may show discrepancies if trust mechanisms are tampered with.<br>4. File Integrity Monitoring (FIM) Logs: Set up to capture changes to key registry paths and Windows system directories.<br>5. Network Logs: Sudden outgoing network connections from new or unexpected DLLs being loaded. |
| Key Indicators | 1. Registry changes under the path HKLM\SOFTWARE\Microsoft\Cryptography\OID\EncodingType 0 for SIP GUID modifications.<br>2. Modifications to DLLs in TLS, kernel, or user directories - especially if timestamp or signed signature discrepancies are noted.<br>3. Unusual DLL load order events captured via Sysmon or other endpoint detection tools indicating potential DLL Hijacking.<br>4. Behavioral changes in how SIPs and trust providers such as abnormal signature verification success for untrusted files.<br>5. Execution of new or unusual processes that interact with signature verification functions after registry changes. |
| Questions for Analysis | 1. Have there been any registry changes related to SIP or trust provider hijacking paths recently?<br>2. Do there appear to be any anomalies in the behavior of applications involved in signature checks?<br>3. Are there unexpected or wrongly signed processes and DLLs executing on the system?<br>4. Is there evidence of unusual network activity following registry or DLL change?<br>5. Were there known vulnerabilities or attack patterns associated with the SIP GUIDs that were modified? |
| Decision for Escalation | 1. Escalate if unauthorized registry changes in SIP or trust provider paths are detected without proper change management records.<br>2. Escalate if there is evidence of unknown DLLs being used for any cryptographic functions related to signature validation.<br>3. Escalate if legitimate application behavior suddenly includes unexpected signature verification outcomes.<br>4. Escalate if there are unauthorized changes to DLLs in critical system directories related to SIPs and trust providers. |
| Additional Analysis Steps for L1 | 1. Verify the legitimacy of registry changes by cross-referencing with change management logs.<br>2. Perform a cross-check on modified DLLs against known good versions and validate their signatures.<br>3. Use process monitoring to identify any newly loaded DLLs post registry modification involving SIP GUID paths.<br>4. Review application and security channels for logs indicating signature validation anomalies. |
| T2 Analyst Actions | 1. Conduct a thorough review of the modified registry entries to verify potential tampering or misconfigurations.<br>2. Perform static and dynamic analysis on suspicious DLLs for malicious activities and origins.<br>3. Utilize threat intelligence to correlate any observed indicators with known malicious campaigns or tools.<br>4. Collaborate with IT teams to verify if changes were part of legitimate software updates or installations. |
| Containment and Further Analysis | 1. Isolate affected systems from the network to prevent further exploitation or lateral movement.<br>2. Restore registry configurations from a clean baseline backup if unauthorized modifications are confirmed.<br>3. Conduct retrospective analysis to identify when the illicit modifications commenced and consider further systems review.<br>4. Engage the Incident Response team to contain and eradicate the threat across the network environment.<br>5. Implement protections and monitoring controls to prevent reoccurrence, including enhanced logging and alerts for future SIP or trust provider hijack attempts. |
