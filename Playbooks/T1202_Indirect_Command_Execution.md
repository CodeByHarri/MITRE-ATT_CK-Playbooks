# Indirect_Command_Execution - T1202

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1202 |
| MITRE Sub-TTP | T1202 |
| Name | Indirect Command Execution |
| Log Sources to Investigate | To effectively investigate this TTP, focus on the following log sources: <br>- Windows Event Logs, particularly PowerShell and Scripting logs (Event IDs 4688 for process creation and 4100 for PowerShell script block logging). <br>- Application logs from security solutions monitoring script executions and command line activity. <br>- Sysmon logs, specifically looking for event IDs related to process creation (Event ID 1). <br>- Logging from endpoint detection and response (EDR) tools to observe indirect invocation of command-line utilities. |
| Key Indicators | Indicators might include: <br>- Execution of uncommon binaries like Forfiles.exe, pcalua.exe, or scriptrunner.exe. <br>- Frequent process creation patterns involving command-line obfuscation or known Windows utilities used suspiciously. <br>- Unusual parent-child process relationships, such as non-standard applications invoking shell commands. <br>- High frequency of script execution events that bypass typical command-line restrictions. |
| Questions for Analysis | Consider the following: <br>- Is the execution of these utilities consistent with routine administrative activity or scripting? <br>- Are there previous instances of these utilities being used in legitimate contexts within this environment? <br>- Do the command arguments or scripts indicate obfuscation or typical malicious patterns? <br>- Are there timestamp correlations with other potentially suspicious activities or alerts? |
| Decision for Escalation | Escalate to Tier 2 if: <br>- The execution of utilities is determined to be inconsistent with known baseline activities. <br>- There is evidence of obfuscation or patterns indicative of malicious intent. <br>- Multiple alerts indicate a concerted effort to evade defenses within a short timeframe. <br>- Attempts to execute commands align with known threat actor TTPs or IOC (Indicators of Compromise). |
| Additional Analysis Steps for L1 | L1 analysts should: <br>- Verify the parent process of the suspicious command execution and check against a list of known good processes. <br>- Compare the frequency of these utility executions against a historical baseline. <br>- Capture and review any script contents or command line arguments associated with the utility invocation. <br>- Check for alerts from correlated security tools like antivirus or intrusion detection systems. |
| T2 Analyst Actions | Tier 2 analysts should: <br>- Conduct deeper analysis on execution traces and patterns to confirm evasion or exploitation attempts. <br>- Cross-reference utility execution with historical incident data for repeated patterns. <br>- Conduct endpoint and network forensics to identify any data exfiltration or lateral movement. <br>- Engage with threat intelligence to understand current trends associated with these utilities. |
| Containment and Further Analysis | Containment measures include: <br>- Temporarily restrict the execution of identified utilities until a verified legitimate use case is provided. <br>- Review and update Group Policies or endpoint security rules to better monitor and control indirect command execution paths. <br>- Educate users and IT staff about the risks and ensure only privileged users can invoke such utilities. <br>- Continuous monitoring post-event to ensure no further breaches or policy circumventions occur. |
