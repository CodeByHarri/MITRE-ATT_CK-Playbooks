# Permission_Groups_Discovery:_Cloud_Groups - T1069003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1069.003 |
| MITRE Sub-TTP | T1069.003 |
| Name | Permission Groups Discovery: Cloud Groups |
| Log Sources to Investigate | 1. Cloud Service Provider Logs: Collect logs from Azure, AWS, and Google Cloud for any use of the respective APIs or CLI tools. For example, monitor Azure Active Directory logs for 'az ad user get-member-groups' commands.<br>2. PowerShell Script Logs: Track the execution of PowerShell scripts through Windows Event Logs to identify any usage of 'Get-MsolRole'.<br>3. IAM Activity Logs: From AWS, extract logs that include 'ListRolePolicies', 'ListAttachedRolePolicies', and 'GetBucketAcl' API calls. 4. GCP API Access Logs: Monitor for any access to 'https://cloudidentity.googleapis.com/v1/groups'. |
| Key Indicators | 1. Unusual API Calls: Detection of API calls such as 'az ad user get-member-groups', 'GET https://cloudidentity.googleapis.com/v1/groups', 'ListRolePolicies', and 'GetBucketAcl' in cloud logs that are not typical for normal business operations.<br>2. Unauthorized PowerShell Commands: Use of 'Get-MsolRole' in environments where this is not commonly used.<br>3. Time and Location Anomalies: Execution of these commands from uncommon IP addresses or at unusual times. 4. Elevated Access Attempts: Attempts to enumerate permissions by non-privileged accounts. |
| Questions for Analysis | 1. Is the observed API or command execution part of an expected business process or regular administrative task?<br>2. Does this activity align with the user's job role and responsibilities?<br>3. Was the API call or command initiated from an approved device and location? 4. Are there any correlated alerts or recent changes in access rights for the concerned user account? |
| Decision for Escalation | Escalate to Tier 2 if: 1. The activity is carried out by a user who does not typically require such access.<br>2. The source IP or device is not recognized as legitimate for this type of access.<br>3. There is a concurrent warning or critical alert related to this user account. 4. The action was performed outside of standard operational hours without documented approval. |
| Additional Analysis Steps for L1 | 1. Verify recent logins and user behaviors for suspicious patterns or anomalies.<br>2. Cross-reference with other warnings or security events that may have occurred in close time proximity.<br>3. Check for any recent creation or changes to user or group policies that may explain the activity. 4. Gather context by checking the user's access history and behavior. |
| T2 Analyst Actions | 1. Conduct a deeper investigation into the accounts involved using previous access audit trails.<br>2. Engage with the user or their manager to verify if the actions were authorized.<br>3. Utilize threat intelligence feeds to check for any indicators of compromise that correlate with the observed activity. 4. Review detailed logs to identify any attempts to leverage this information for unauthorized access. |
| Containment and Further Analysis | 1. If unauthorized access is confirmed, immediately disable the affected credentials and audit recent changes made by these accounts.<br>2. Conduct a review of the access permissions and roles to limit excessive privileges.<br>3. Implement enhanced monitoring for the specific user accounts or IP ranges identified in the incident. 4. Initiate a full investigation into how the access was obtained and identify potential vulnerabilities in IAM configurations or security policies. |
