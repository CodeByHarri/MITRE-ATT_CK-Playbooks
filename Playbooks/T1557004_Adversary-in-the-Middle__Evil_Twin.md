# Adversary-in-the-Middle:_Evil_Twin - T1557004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Collection, Credential Access |
| MITRE TTP | T1557.004 |
| MITRE Sub-TTP | T1557.004 |
| Name | Adversary-in-the-Middle: Evil Twin |
| Log Sources to Investigate | 1. Wi-Fi Network Logs: Monitor logs related to wireless access points (WAP) and rogue access point detections to identify any unauthorized SSIDs mimicking known networks.<br>2. Device Connection Logs: Check for device connection histories to identify connections to unauthorized or unusual SSIDs.<br>3. IDS/IPS Logs: Look for alerts related to suspicious network activities, particularly those within public Wi-Fi zones. 4. User Credential Storage and Access Logs: Investigate logs that capture instances of credential access or misuse post-connection to Wi-Fi, suggesting malicious intent. Examples include Cisco Wireless Logs, Aruba Clearpass, and Palo Alto Network Threat logs. |
| Key Indicators | 1. Detection of unauthorized SSIDs with names resembling legitimate networks.<br>2. Unusually high signal strength from rogue access points compared to known access points.<br>3. Devices receiving de-authentication packets, indicating potential forced disconnection tactics. 4. Capture of probe requests and responses that match known trusted network SSIDs without network configuration updates. 5. Presence of unexpected or altered network certificates indicating potential HTTPS interception. |
| Questions for Analysis | 1. Has the SSID in question been previously recognized as part of the legitimate network?<br>2. Is there an unusual pattern of connections from the same set of devices to this suspicious SSID?<br>3. Are there logs indicating attempts to capture credentials, such as multiple failed login attempts on a captive portal? 4. Is the same SSID appearing in multiple public locations, suggesting a transient rogue access point? |
| Decision for Escalation | Escalate to Tier 2 if there is evidence of credential harvesting attempts (e.g., phishing login pages), repeated unauthorized SSID detections, or confirmed HTTPS interception attempts. Also, escalate if user reports corroborate detection data of network issues or suspicious activity. |
| Additional Analysis Steps for L1 | 1. Correlate device connection logs with hours of operation to understand the scope of rogue AP influence.<br>2. Verify whether network certificates are authentic by comparing them with originals stored in the system.<br>3. Validate if the affected devices show any signs of data leakage or unexpected outbound connections post Wi-Fi connection. |
| T2 Analyst Actions | 1. Conduct a thorough investigation to identify the source and location of the rogue access point using Wi-Fi triangulation and analysis tools.<br>2. Perform packet analysis on captured traffic to identify if there is any manipulation or interception occurring.<br>3. Engage with affected users for more information and potential warnings about specific times or locations where attacks may have occurred. |
| Containment and Further Analysis | 1. Deploy wireless intrusion prevention systems (WIPS) to block and quarantine rogue SSIDs and prevent access to unauthorized devices.<br>2. Conduct user training and awareness campaigns focusing on secure Wi-Fi usage and signs of malicious networks.<br>3. Review and update Wi-Fi security settings, including enforcing WPA3, where possible, and ensuring regular network scanning for rogue access points. 4. In alignment with findings, implement geofencing within known high-risk areas (e.g., coffee shops, airports) where devices are more vulnerable to these attacks. |
