# Boot_or_Logon_Autostart_Execution:_Shortcut_Modification - T1547009

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1547.009 |
| MITRE Sub-TTP | T1547.009 |
| Name | Boot or Logon Autostart Execution: Shortcut Modification |
| Log Sources to Investigate | 1. File System Logs: Monitor changes to the file system, especially creations or modifications within the 'Startup' directory (e.g., C:\Users\<Username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\).<br>2. Security Information and Event Management (SIEM) Systems: Aggregating data could provide a broader context of behavior patterns — for instance, a spike in shortcut creations.<br>3. Endpoint Detection and Response (EDR) Tools: Should be configured to monitor suspicious shortcut (.lnk) activities. 4. Windows Event Logs: Specifically, check for events like Event ID 4663 (File Access) or Event ID 4688 (Process Creation). |
| Key Indicators | 1. Creation or modification of .lnk files within known startup folders.<br>2. Presence of unknown processes executing from .lnk files.<br>3. Abnormal behaviors like newly created shortcuts with unusual target paths or paths to uncommon executables. 4. Modified properties of existing legitimate shortcuts that alter their target paths. 5. Use of file paths or process names that mimic legitimate software (Masquerading). |
| Questions for Analysis | 1. Are there recent changes to shortcuts in startup directories that weren't initiated by normal system processes or administrators?<br>2. Do any modified shortcuts point to suspicious or uncommon executable paths?<br>3. Is there evidence of masquerading, such as mismatched file paths and expected file hashes? 4. Are there any external indicators (correlation with threat intelligence) suggesting these changes are associated with a known threat actor or campaign? |
| Decision for Escalation | Escalate to Tier 2 if: 1. There are indications of a persistent threat, such as repeated creation of suspicious shortcuts after removal.<br>2. Detection involves critical systems or high-value targets.<br>3. Correlation with threat intelligence suggests a link to an active threat. 4. The scope or impact of activity cannot be definitively determined at Tier 1. |
| Additional Analysis Steps for L1 | 1. Verify the time and origin of shortcut modifications — compare against administrative timelines and authorized changes.<br>2. Check the reputation and intended behavior of any executables linked within the shortcuts using a threat intelligence service.<br>3. Conduct sandbox analysis of unrecognized executables referenced in new shortcuts. 4. Cross-reference file changes with recent authorization logs to ascertain legitimacy. |
| T2 Analyst Actions | 1. Perform deeper file system analysis to identify and map out the full list of modified shortcuts.<br>2. Utilize threat intelligence to investigate any intersections with known campaigns or TTPs, specifically those involving shortcut abuses.<br>3. Analyze network traffic for connections associated with newly created or modified shortcuts. 4. Coordinate with IT to verify legitimacy and authorization of changes. |
| Containment and Further Analysis | 1. Isolate affected systems to prevent lateral movement if suspicious activity is confirmed.<br>2. Revert or remove unauthorized shortcut modifications to restore system to known good state.<br>3. Perform a comprehensive scan to detect any additional modifications or malicious files. 4. Capture memory dumps and network traces for in-depth forensic analysis. 5. Communicate findings to relevant stakeholders and update detection capabilities to prevent recurrence. |
