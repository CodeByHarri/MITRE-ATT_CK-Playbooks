# Traffic_Signaling - T1205

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Command and Control, Defense Evasion, Persistence |
| MITRE TTP | T1205 |
| MITRE Sub-TTP | T1205 |
| Name | Traffic Signaling |
| Log Sources to Investigate | Network traffic logs should be prioritized to detect unusual sequences of packets and potential port knocking attempts. Examples include firewall logs, intrusion detection/prevention system (IDS/IPS) alerts, and packet capture files. Monitoring logs from network devices, especially routers and switches, can also be crucial. Additionally, system logs on host machines that indicate unusual port activity or changes, such as opening a previously closed port, should be examined. |
| Key Indicators | Key indicators include sequences of failed connection attempts to closed ports followed by successful connections, the presence of unusual packet flags, or specific string patterns in network traffic that seem anomalous. Unusual or undocumented changes in firewall settings that open additional ports or services are also significant indicators. Observing magic packets sent to systems that were previously powered down, triggering system wake-ups, is a telltale sign of Wake-on-LAN abuse. |
| Questions for Analysis | What specific ports were targeted in the sequence of connection attempts? Were these ports previously documented as in use? Are the source IPs associated with known legitimate users or locations? Is there any documented reason for the use of custom or unusual packet sequences? Was there a legitimate network maintenance activity correlating with this event? |
| Decision for Escalation | Escalate to Tier 2 when: a sequence of failed port connections immediately precedes a successful connection, especially if associated with high-value systems or sensitive networks; unusual packet characteristics are detected that cannot be readily explained; evidence suggests a system was unexpectedly powered on via Wake-on-LAN during a time it should have been off; or if this activity correlates with other suspicious behaviors like data exfiltration or lateral movement attempts. |
| Additional Analysis Steps for L1 | Verify whether the port sequences appear in normal operational patterns or were used by legitimate network applications. Check if similar activities have been recorded in the past and their outcomes. Investigate the source IPs for any known blacklists or previous security alerts. Look for correlated events that occurred around the same time, such as unusual login attempts or large data transfers. |
| T2 Analyst Actions | Conduct deeper packet analysis to understand the contents and structure of the suspicious packets. Profile the source and destination of the traffic to identify patterns suggesting illicit control. If possible, reproduce the signals in a controlled environment to confirm their effects on the targeted systems. Seek corroborating evidence in other logs or alerts to understand the broader context of the intrusion attempt. |
| Containment and Further Analysis | Block the offending IP addresses at the firewall to prevent further signaling attempts. Review and possibly reset network configurations to close any inadvertently opened ports. Identify and disable/remediate any malicious code or processes scheduled to listen for magic values. Consider segmenting the network to limit access from potentially compromised or misconfigured endpoints. Conduct a thorough assessment of affected systems to identify any unauthorized changes or installed malware. Document all findings for further investigation and incident response efforts. |
