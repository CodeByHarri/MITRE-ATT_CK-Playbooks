# Browser_Session_Hijacking - T1185

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Collection |
| MITRE TTP | T1185 |
| MITRE Sub-TTP | T1185 |
| Name | Browser Session Hijacking |
| Log Sources to Investigate | Relevant log sources to investigate include web server logs, proxy server logs, and browser extension telemetry. Examples are:<br>1. Web server logs to identify unusual patterns in user-agent strings, referrer URLs, or unusual request volumes which may indicate hijacked sessions.<br>2. Proxy logs to detect redirection or tunneling requests that bypass traditional network traffic patterns.<br>3. Browser extension logs to monitor for unauthorized or unusual extension installations that might facilitate hijacking.<br>4. Authentication logs to identify anomalies such as simultaneous logins from different locations or devices.<br>5. Endpoint detection logs for monitoring changes in browser process integrity or privilege escalation attempts. |
| Key Indicators | Important indicators include:<br>1. Unusual or unauthorized installation of browser extensions.<br>2. Presence of anomalous cookies or authentication tokens in web traffic.<br>3. Browser processes running with elevated privileges (e.g., SeDebugPrivilege).<br>4. Web traffic patterns indicating the use of browser pivoting, such as visiting unknown or internal sites not typical of the user's regular behavior.<br>5. Detection of proxy settings changes or additional proxy processes on an endpoint. |
| Questions for Analysis | 1. Are there any newly installed or unauthorized browser extensions?<br>2. Is there any evidence of elevated privileges being requested or granted for browser processes?<br>3. Has the user's account been accessed from unfamiliar IP addresses or locations?<br>4. Are there any signs of unusual browsing patterns, such as unexpected internal sites being navigated?<br>5. Have there been any attempts to modify browser settings or inject processes into browser sessions? |
| Decision for Escalation | Escalate to Tier 2 if:<br>1. Unauthorized extensions or modifications to browser settings are confirmed.<br>2. Anomalous use of elevated privileges in browser processes is detected.<br>3. There is evidence of network redirection or proxy activity that could indicate an adversary's attempt to pivot.<br>4. The user's authentication tokens or session cookies appear compromised based on log analysis.<br>5. Cross-reference anomalies with threat intelligence to verify if they align with known TTPs. |
| Additional Analysis Steps for L1 | 1. Validate detected browser extensions against a whitelist of approved extensions.<br>2. Correlate browser process hash values with known malicious hashes in threat intelligence databases.<br>3. Cross-check unusual IP addresses or locations with geolocation databases for known threats.<br>4. Review the historical pattern of logged sites and look for deviations from typical user behavior.<br>5. Verify if two-factor authentication methods have been bypassed or disabled. |
| T2 Analyst Actions | 1. Conduct a deep dive analysis with packet captures or endpoint forensics to confirm or refute session hijacking.<br>2. Review system event logs for signs of privilege elevation targeting the browser.<br>3. Investigate communication between potentially compromised endpoints and known C2 or suspicious IP addresses.<br>4. Compile all gathered indicators and match them against advanced threat databases for similar intrusion cases.<br>5. Liaise with network teams to possibly isolate the affected segment until root cause analysis is complete. |
| Containment and Further Analysis | 1. Remove unauthorized browser extensions and reset browser configurations to default settings.<br>2. Implement and enforce network segmentation to minimize lateral movement if pivoting is confirmed.<br>3. Reissue authentication tokens or cookies where compromises have occurred, ensuring all affected accounts have immediate password resets.<br>4. Recommend installing endpoint protection tools to flag or block anomalous browser behavior.<br>5. Conduct post-incident analysis to identify vulnerabilities exploited and reinforce security policies to prevent recurrence. |
