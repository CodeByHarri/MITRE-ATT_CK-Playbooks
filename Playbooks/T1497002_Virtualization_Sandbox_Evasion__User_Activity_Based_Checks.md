# Virtualization_Sandbox_Evasion:_User_Activity_Based_Checks - T1497002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Discovery |
| MITRE TTP | T1497.002 |
| MITRE Sub-TTP | T1497.002 |
| Name | Virtualization/Sandbox Evasion: User Activity Based Checks |
| Log Sources to Investigate | Monitor logs related to mouse and keyboard activity, such as those from user activity monitoring software or security information and event management (SIEM) solutions. Look into web browser logs for unusual patterns in browser history access, cache, and bookmarks. File system monitoring logs are important for changes in common directories such as 'home' or 'desktop'. Examine application logs, particularly from office applications that might be used to open documents requiring specific user interactions (e.g., macros). Examples include Windows Event logs, especially for Task Scheduler events, application usage, and USB plug/unplug events. |
| Key Indicators | Rapid sequence of identical mouse movements or clicks that do not mimic normal user behavior. Access patterns in browser artifacts that suggest automated processes instead of regular user browsing. Unusual modifications or access to files in the common directories. Indications of conditional execution based on user actions, such as a script that activates upon document closure or specific user interaction like double-clicking. |
| Questions for Analysis | Is there evidence of abnormal user activity, such as rapid mouse movement patterns or unusual file access times? Are there any changes in browser cache or history that do not align with typical user behavior? What processes were executed shortly before or after detecting the suspicious user activity? Have any files been modified or accessed that would be unusual for the user's role and typical daily activity? |
| Decision for Escalation | Escalate if the user activity logs indicate abnormal patterns that are not easily explainable, such as continuous identical mouse movements or unexplained file access. If scripts or processes align with common TTPs indicating conditional payload execution based on user behavior, escalate to Tier 2. Unexpected, rapid changes in browser-related artifacts could warrant escalation as well. |
| Additional Analysis Steps for L1 | Review recent historical data for the user account involved to establish a baseline of normal activity. Compare current user activity logs with previous logs to identify deviations. Validate whether there are legitimate applications or processes that may cause similar patterns and rule out false positives. |
| T2 Analyst Actions | Conduct deeper forensic analysis of the affected host to determine the presence of suspicious processes or scripts that align with T1497.002. Use threat intelligence sources to correlate identified behavior with known threat actors' TTPs. Confirm whether the conditional logic in scripts is tailored to avoid sandboxing evasion, and identify payloads related to detected suspicious indicators. |
| Containment and Further Analysis | Isolate the affected system to prevent potential lateral movement while ensuring system backups and integrity remain unaffected. Perform artifact collection, such as memory dumps and disk images, for detailed analysis. Examine related systems to ensure the potential threat has not spread. Employ behavior analysis tools to validate whether identified malware exhibit the user activity evasion techniques detailed in T1497.002. |
