# Office_Application_Startup:_Office_Template_Macros - T1137001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence |
| MITRE TTP | T1137.001 |
| MITRE Sub-TTP | T1137.001 |
| Name | Office Application Startup: Office Template Macros |
| Log Sources to Investigate | Monitor file system activity for modifications or creations related to Office template files, like Normal.dotm and Personal.xlsb, especially in user profiles under C:\Users\<username>\AppData\Roaming\Microsoft\Templates\ and C:\Users\<username>\AppData\Roaming\Microsoft\Excel\XLSTART\. Windows Security event logs should be checked for registry modifications, especially focusing on changes to the GlobalDotName registry key. Application logs from Microsoft Office containing macro execution events should also be considered, as well as any alerts from endpoint detection and response (EDR) systems identifying suspicious Office process behaviors or macro activities. |
| Key Indicators | Unusual modifications to Office template files such as Normal.dotm and Personal.xlsb in user directories. Changes to the GlobalDotName registry key. Unexpected or unauthorized macro activity alerts from Office applications. Office applications executing child processes or network connections that are atypical of normal usage. Absence of legitimate user actions correlating with these modifications or executions. |
| Questions for Analysis | Was there a legitimate business justification for the modification of the template file? Are there corresponding logs or evidence of normal user activity around the time of template modification? Is there any known update or patch that could account for registry or template changes? Are there other signs of compromise on the system, such as unusual process behavior or network activity from Office applications? |
| Decision for Escalation | Escalate if the modification of template files or registry changes are not explained by legitimate user activity or IT administrative actions. Escalate if there is evidence of unauthorized macro execution or if Office applications perform unexpected operations like spawning new processes or making external network connections. Escalate if user awareness or patching does not account for observed changes. |
| Additional Analysis Steps for L1 | Verify user activity logs to correlate any modifications with legitimate usage. Check EDR system for any alerts or indicators of suspicious macro or script activities from Office applications. Review recent IT changes or software updates that might explain modifications. Confirm whether affected files are located in trusted paths or registered as trusted documents. |
| T2 Analyst Actions | Conduct a deeper forensic analysis on the affected systems, focusing on any script execution environments and looking for potential payloads or other indicators of compromise. Verify the legitimacy of templates by contacting the user or department to confirm changes. Review search order hijacking attempts or unintended external registry modifications. Engage with threat intelligence sources to correlate observed TTPs with known threat actors or campaigns. |
| Containment and Further Analysis | Isolate the affected system(s) from the network to prevent further compromise. Restore modified template files from known good backups where possible. Remove or block malicious macros or scripts. Update Enterprise Security policies to restrict macro execution where possible. Conduct a thorough review of user permissions and system hardening measures to prevent further abuse. Work with IT to address any potential security configuration gaps found during investigation. |
