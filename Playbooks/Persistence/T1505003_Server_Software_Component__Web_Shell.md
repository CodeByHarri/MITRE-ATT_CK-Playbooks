# Server_Software_Component:_Web_Shell - T1505003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence |
| MITRE TTP | T1505.003 |
| MITRE Sub-TTP | T1505.003 |
| Name | Server Software Component: Web Shell |
| Log Sources to Investigate | Investigate web server access logs to identify unusual patterns of access. This includes frequent access to specific pages or scripts typically not interacted with by regular users. Examples include access logs (e.g., Apache or IIS logs), application logs that may show script execution, and firewall/router logs that can highlight unexpected incoming or outgoing traffic. Additionally, review antivirus or security software logs for alerts related to known web shell scripts. |
| Key Indicators | Look for unauthorized or suspicious files on the web server, especially scripts placed in directories accessible over the web, such as .php, .asp, .aspx files without proper authorization. Monitor for high-volume or unexpected HTTP requests, especially POST requests which could be used to upload commands. Unexpected changes in file permissions or timestamps, and sudden surges in web server resource utilization can also be indicators. |
| Questions for Analysis | Is there an abnormal number of requests to specific web server locations? Are there indications of uploads or changes to files that shouldn't normally be modified? Are there any alerts from the security solutions that correlate with known web shell signatures? Is there a corresponding spike in network activity around your web servers from suspicious or foreign IP addresses? |
| Decision for Escalation | Escalate if there are confirmed access patterns aligning with known web shell activity, such as repeated POST requests to uncommon PHP/ASP files. Escalate if you confirm unauthorized script files or changes to web server directories. Any threat intelligence hits or security alerts identifying web shells should be escalated. |
| Additional Analysis Steps for L1 | Review recent patches and updates to the web server and corresponding software to ensure no late-breaking vulnerabilities are being exploited. Scan the web server directories for scripts or files with unusual permissions or ownership. Correlate any suspicious IP addresses with threat intelligence databases for known malicious activity. |
| T2 Analyst Actions | Perform a manual review of the web server files against known-good baselines to identify unauthorized scripts. Review authentication and authorization logs to identify potential compromises of admin accounts. Perhaps use a web application firewall (WAF) to monitor and potentially block suspicious activities in real-time. Analyze network traffic to determine the data exfiltration or communication between the server and external entities. |
| Containment and Further Analysis | Immediately isolate the affected web server from the rest of the network to prevent lateral movement. Coordinate with network teams to block malicious IP addresses identified through analysis. Conduct a forensic copy of web server data for further investigation while maintaining the integrity of evidence. Perform a full backup, then execute a thorough malware and security scan using updated signatures. Finally, assess and patch identified vulnerabilities, review firewall and access control configurations, and implement additional monitoring for early identification of similar future threats. |
