# Phishing:_Spearphishing_Attachment - T1566001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Initial Access |
| MITRE TTP | T1566.001 |
| MITRE Sub-TTP | T1566.001 |
| Name | Phishing: Spearphishing Attachment |
| Log Sources to Investigate | Email gateway logs to identify the sender's domain and IP, email headers for any anomalies or mismatches, attachment information for file names and types, and security appliance logs for attachment scanning results. SIEM alerts related to user execution events, endpoint protection logs, and host-based intrusion detection systems should also be reviewed. Investigate file downloads or execution attempts logged by endpoint devices and network traffic logs for unusual communications post-email receipt. Examples include Microsoft Exchange message tracking logs, Cisco IronPort Email logs, and Windows Event Logs for executed files. |
| Key Indicators | Presence of email with attachments such as Microsoft Office documents, PDFs, or executable files from untrusted sources. Suspicious file names or extensions mismatched to the apparent file type (e.g., .pdf.exe, .docx.wsf). Commands seen post-execution suggesting a command line or script initiated from the document. User complaints about unexpected emails or behavior upon opening attachments. Repeated failed attempts to open a file or bypassing of security warnings, indicated in application logs or user reports. |
| Questions for Analysis | Was the email received from a known and trusted source? Did the email request any unusual action such as enabling macros or scripts? Are there any signs of social engineering attempts in the email content? Have similar emails been reported by other users? Was there any logged attempt to execute the attachment upon opening? Did the attachment lead to any suspicious network connections or process behaviors? |
| Decision for Escalation | Escalate if the attachment results in execution of a process not typically associated with the file type, unusual network connections occur after opening an attachment, multiple users report similar suspicious emails, the originating IP or domain is associated with known malicious activity, or if any other indicators of compromise are observed. Also, escalate if attempts to execute restricted or risky actions such as running scripts are logged post email. |
| Additional Analysis Steps for L1 | Verify the source and legitimacy of the email sender. Examine the email header for signs of spoofing. Check if the attachment file type is consistent with its extension. Look for instances of similar emails sent to other users. Monitor for any executions from the attachment and subsequent activities like script execution or network connections initiated. Collect user feedback regarding suspicion or unexpected behavior after interacting with the email or attachment. |
| T2 Analyst Actions | Perform deep-dive analysis on the attachment to identify any embedded macros, scripts, or malicious code. Utilize sandbox environments to safely execute and observe attachment behavior. Analyze any extracted scripts or payloads for indicators of compromise. Correlate email content with other known phishing campaigns. Review endpoint detection logs for anomalies post-email attachment execution. |
| Containment and Further Analysis | Quarantine the affected email and attachment from inboxes. Block the senderâ€™s domain or IP if identified as malicious. Remove any suspicious files from endpoints and scan for additional malicious artifacts using antivirus or EDR solutions. Review and update email filtering policies to catch similar attacks in the future. Conduct user training focused on recognizing spearphishing attempts and secure handling of attachments. Document findings from the analysis for threat intelligence sharing and historical reference. |
