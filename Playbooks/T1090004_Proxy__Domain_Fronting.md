# Proxy:_Domain_Fronting - T1090004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Command and Control |
| MITRE TTP | T1090.004 |
| MITRE Sub-TTP | T1090.004 |
| Name | Proxy: Domain Fronting |
| Log Sources to Investigate | Network traffic logs, specifically those capturing HTTPS requests, can provide insights into domain fronting activities. Firewall logs or web proxy logs that record SNI (Server Name Indication) and HTTP Host field values are crucial. NetFlow or packet capture (PCAP) data can also be useful to identify mismatched domains. Examples of relevant log sources include logs from network monitoring solutions like Wireshark, Snort, or Zeek, as well as logs from web proxies like Squid or network security appliances such as firewalls. |
| Key Indicators | Look for instances where the SNI field in TLS headers contains a domain different from the one in the HTTP Host header. Alert on network flows where there are sudden, unexpected changes in SNI values without a corresponding change in the HTTP Host field. Also, examine traffic patterns indicative of domainless fronting, such as blank SNI fields combined with valid HTTP Host values. High frequency of disparate domain pairs appearing in SNI and Host fields may also indicate domain fronting. |
| Questions for Analysis | 1. Are there frequent mismatches between SNI and HTTP Host fields observed in network traffic?<br>2. Is there a pattern of traffic involving blank SNI fields with legitimate HTTP requests?<br>3. Are the domains involved known to use CDNs? 4. Is there any legitimate reason or business justification for such domain(SNI) and Host mismatches within the organization? |
| Decision for Escalation | Escalate to Tier 2 if SNI to HTTP Host mismatches are observed with high frequency, particularly if they involve unfamiliar or suspicious domains or coincide with potential indicators of compromise elsewhere in network traffic logs. Also, escalate if suspicious patterns persist after initial investigation, or if the involved domains have ties to known malicious activities. |
| Additional Analysis Steps for L1 | 1. Verify and validate network anomalies by checking if the domains in question are customers of the same CDN.<br>2. Cross-reference unusual domain activity with threat intelligence to identify potential connections to known malicious activities.<br>3. Check for any internal documentation or business justification that might explain the domain fronting activity. |
| T2 Analyst Actions | Conduct deeper forensic analysis on the network traffic to determine the full scope and origin of the observed fronting attempts. Utilize threat intelligence services to gather additional context around the domains involved. If suspicious activity is confirmed, prepare detailed incident reports and work closely with IT to determine the impact on systems and data integrity. |
| Containment and Further Analysis | Implement network-level rules to block or isolate traffic related to confirmed domain fronting activity. Initiate endpoint scans for signs of compromise associated with domain fronting activity. Review and, if necessary, adjust CDN and network access configurations to prevent exploitation via domain fronting. Continue monitoring for reinfection attempts or related anomalous network behaviors. |
