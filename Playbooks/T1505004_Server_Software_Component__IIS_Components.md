# Server_Software_Component:_IIS_Components - T1505004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence |
| MITRE TTP | T1505.004 |
| MITRE Sub-TTP | T1505.004 |
| Name | Server Software Component: IIS Components |
| Log Sources to Investigate | To investigate this TTP, focus on IIS server logs, Windows Event Logs (specifically Security and Application logs), audits of file changes on server directories, and network traffic logs. Examples include monitoring logs for DLL file registration on IIS, unexpected changes to IIS configurations, and anomalous incoming/outgoing web traffic that may indicate proxying activities. Security Information and Event Management (SIEM) solutions or tools like Microsoft Defender for Endpoint can also be valuable in correlating events. |
| Key Indicators | Look for indicators such as the installation of unexpected DLL files in IIS-related directories (e.g., ISAPI or module directories), changes in IIS configuration files (e.g., applicationHost.config), unusual or unauthorized ISAPI extensions and filters, processes executing unexpected modules or commands associated with IIS, and anomalous HTTP traffic patterns, such as modification of HTTP responses or unexpected amount/query patterns in requests. |
| Questions for Analysis | Are there recent changes in the IIS server configuration or installation of new modules/extensions? Do the identified DLLs align with known or legitimate IIS components? Is there unusual HTTP traffic that redirects to unknown destinations or contains suspicious payloads? Is there evidence of command execution or proxy-like behavior in logs? Have these activities occurred out of normal hours or from atypical IP addresses? |
| Decision for Escalation | Escalate to Tier 2 if there are confirmed unauthorized changes to IIS configurations, discovery of suspicious DLL files without a clear legitimate source, evidence of command execution through IIS, signs of HTTP traffic modification, or if initial investigation suggests a potential compromise. |
| Additional Analysis Steps for L1 | Review recent changes in IIS server configuration files and check for unknown ISAPI extensions or IIS modules. Validate the legitimacy of DLL files in IIS directories by examining file properties and comparing with known signatures. Monitor HTTP traffic patterns and look for deviations from baseline activity. |
| T2 Analyst Actions | Conduct deeper inspection into the origin of suspicious DLL files, including hash analysis and cross-reference with malware databases. Analyze HTTP traffic in detail to identify specific patterns of modification or command/control behavior. Engage with the server team to validate and potentially rollback unauthorized changes to IIS configurations. Collaborate with network teams to isolate anomalous network patterns. |
| Containment and Further Analysis | Isolate the impacted IIS server to prevent further unauthorized access or data leakage. Remove or revert unauthorized IIS extensions/modules. Conduct forensic imaging of affected systems for deeper analysis. Implement tighter security controls on IIS, such as application whitelisting for deployed DLLs, and enhance monitoring on key log sources to detect similar activities in the future. |
