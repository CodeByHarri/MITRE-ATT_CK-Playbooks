# System_Script_Proxy_Execution:_PubPrn - T1216001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1216.001 |
| MITRE Sub-TTP | T1216.001 |
| Name | System Script Proxy Execution: PubPrn |
| Log Sources to Investigate | Focus on Windows Event Logs, particularly: <br>- Script Block Logging (Event ID 4104) to capture script execution details.<br>- Process Creation Events (e.g., Event ID 4688) to identify cscript.exe execution with PubPrn.vbs.<br>- PowerShell logs if script execution migrates to PowerShell execution techniques.<br>- Network logs to identify unusual outbound web requests to domains associated with remote scriptlets.<br>- Application whitelisting logs, if available, to recognize bypass attempts related to script execution. |
| Key Indicators | Indicators of potential malicious activity include:<br>- Execution of cscript.exe with PubPrn.vbs in command parameters.<br>- Network requests made to non-corporate domains especially those ending in .sct.<br>- Presence of abnormal PubPrn.vbs execution patterns.<br>- Modified PubPrn.vbs scripts or an unusual number of execution attempts in a short period.<br>- Processes executed within the time frame of PubPrn activity that are not common in the environment. |
| Questions for Analysis | 1. Does the machine executing the script have a legitimate reason to run PubPrn.vbs?<br>2. Are there any known vulnerabilities in PubPrn.vbs specific to the organization's current OS version?<br>3. Is the remote domain in question known or associated with any past incidents or threat actor activities?<br>4. Does the user or account executing the script have a history of running scripts, or is this behavior anomalous?<br>5. Are there any other correlated alerts or logs pointing towards compromise or lateral movement activity? |
| Decision for Escalation | Escalate to Tier 2 if:<br>- The script accesses known malicious or untrusted domains.<br>- PubPrn.vbs execution is observed on hosts where such activity is unexpected.<br>- Atypical user accounts or administrative rights are involved in running the script.<br>- There are other signs of potential compromise such as concurrent alerts or the presence of unusual lateral movement tactics.<br>- Repeated unsuccessful execution attempts with variations in parameters suggesting evasion techniques. |
| Additional Analysis Steps for L1 | 1. Verify script execution against known software/configurations used in the environment.<br>2. Check for correlation with other suspicious activities on the same system or user account.<br>3. Validate the legitimacy of the domains being accessed by scripts.<br>4. Collect and document process execution details for PubPrn.vbs including timestamps, user accounts, and network activity.<br>5. Examine neighboring events in the log timeline to identify related activities prior to and following script execution. |
| T2 Analyst Actions | 1. Conduct a deeper investigation into network connections initiated by PubPrn.vbs.<br>2. Determine if there are any similar instances across multiple hosts indicating a broader compromise.<br>3. Analyze the contents of the remote scriptlet files for malicious code or payloads.<br>4. Correlate the activity with threat intelligence feeds to identify known tactics or indicators.<br>5. Review account activity involved in the execution for signs of compromise or privilege escalation attempts. |
| Containment and Further Analysis | 1. Isolate affected host(s) to prevent further communication with malicious domains.<br>2. Suspend or block suspicious user accounts or access permissions until verification.<br>3. Remove or quarantine identified malicious files and scripts from hosts.<br>4. Initiate a threat hunt to identify any further instances of similar execution across the environment.<br>5. Implement or update logging and monitoring to detect similar attempts in the future ensuring PubPrn.vbs exploits are covered. |
