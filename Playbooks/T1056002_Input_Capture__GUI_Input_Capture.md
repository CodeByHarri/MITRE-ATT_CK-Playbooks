# Input_Capture:_GUI_Input_Capture - T1056002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Collection, Credential Access |
| MITRE TTP | T1056.002 |
| MITRE Sub-TTP | T1056.002 |
| Name | Input Capture: GUI Input Capture |
| Log Sources to Investigate | Investigate system logs that can reveal instances of GUI component creation, which may include application logs, operating system logs, and shell command history. Examples include: 1. Windows Event Logs: Check for events related to application execution, privilege elevation requests, and PowerShell activity (Events 4688, 7045, and associated PowerShell logs).<br>2. MacOS Console Logs: Examine for AppleScript activities and any unusual GUI prompts in the Console application logs.<br>3. Linux Syslog/Command History: Review for bash or other shell script execution logs attempting to create GUI components. |
| Key Indicators | 1. Unusual execution of AppleScript, PowerShell, or Unix shell commands that create GUI prompts.<br>2. Elevated privilege prompts occurring without user-initiated actions.<br>3. Credentials entered into GUI prompts presented by non-standard or suspicious processes. 4. High frequency of authentication prompt presentations in a short period. 5. Execution of known suspicious or non-signed binaries mimicking legitimate GUI components. |
| Questions for Analysis | 1. Is there a legitimate reason for an application to request elevated privileges at this time?<br>2. Does the executable requesting elevated privileges have a valid digital signature?<br>3. Have similar credential prompt events been observed across multiple systems in the environment? 4. Was the GUI prompt from a recognized application or an unknown/suspicious source? 5. Were there user complaints or reports regarding unexpected permission dialogs and access requests? |
| Decision for Escalation | Escalate to Tier 2 if: 1. Credential prompts are detected from applications without valid digital signatures or not matching known software.<br>2. Frequent credential prompt attempts from the same system indicate persistence.<br>3. A pattern is detected across multiple systems indicating a broader attack (e.g., same script, application, or timestamp of events). |
| Additional Analysis Steps for L1 | 1. Correlate the timing of credential prompts with user activity to identify anomalies.<br>2. Verify the digital signature of binaries responsible for GUI prompts.<br>3. Review process creation logs to ensure application requesting credentials is legitimate. 4. Check system for known IoCs related to GUI spoofing attacks. |
| T2 Analyst Actions | 1. Perform deeper forensic analysis on the system to identify any background scripts or scheduled tasks correlated with the credential request.<br>2. Evaluate network traffic for unusual outbound connections following credential requests.<br>3. Assess other endpoints for similar activities to determine scope of attack. 4. Manually verify the application or binary hashes against threat intelligence sources for legitimacy. |
| Containment and Further Analysis | 1. Quarantine affected systems to prevent lateral movement.<br>2. Remove any unauthorized applications or scripts found responsible for credential prompts.<br>3. Change credentials that may have been compromised. 4. Update EDR solutions with new indicators to detect and block identified threats. 5. Conduct a post-incident review to improve detection and response capabilities related to GUI input capture attacks. |
