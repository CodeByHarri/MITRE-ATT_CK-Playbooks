# Event_Triggered_Execution:_Netsh_Helper_DLL - T1546007

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Persistence, Privilege Escalation |
| MITRE TTP | T1546.007 |
| MITRE Sub-TTP | T1546.007 |
| Name | Event Triggered Execution: Netsh Helper DLL |
| Log Sources to Investigate | Collect and analyze logs from Windows Event Logs (especially focusing on Application, Security, and System logs), Registry monitoring logs (to capture changes in HKLM\SOFTWARE\Microsoft\Netsh), endpoint detection and response (EDR) solutions for process execution monitoring, file integrity monitoring for DLL modifications in Netsh related directories, and network traffic analysis logs for anomalous connections initiated by netsh.exe. |
| Key Indicators | Presence of unknown or unusual entries in the HKLM\SOFTWARE\Microsoft\Netsh registry key. Unusual DLL loading by netsh.exe. Frequent or unexpected execution of netsh.exe, particularly if it coincides with known malware DLLs. Anomalies in process creation events showing netsh.exe launched without expected user interaction. Network connections initiated by netsh.exe to suspicious or unexpected external IP addresses. |
| Questions for Analysis | Is the DLL associated with netsh.exe on the watchlist for known malicious indicators (hashes, signatures)? Is there a recent anomalous or unauthorized registry modification in the netsh helper directory? Did netsh.exe execute during an unusual time frame (after hours, weekends)? Are there network activities associated with netsh.exe that seem suspicious (unusual endpoints, unexpected protocols)? |
| Decision for Escalation | Escalate to Tier 2 if the associated DLLs have known malicious indicators or match threat intelligence reports. If the registry changes were unauthorized and coincide with known malicious TTPs. If there are signs of lateral movement or data exfiltration related to netsh.exe activity. |
| Additional Analysis Steps for L1 | Verify the legitimacy of newly registered netsh helpers by cross-referencing with known software inventories. Perform a quick review of endpoint detection alerts for similar activities on other systems. Search for any related alerts or incidents in the past 30 days that might indicate a broader, coordinated attack. |
| T2 Analyst Actions | Conduct a detailed timeline analysis of the system focusing on execution time, user accounts, and process ancestry of netsh.exe events. Correlate these findings with any similar activities across the environment. Interrogate the system memory and network connections for IOCs using deeper forensic tools. Review historical registry and file system activity for contextual information. |
| Containment and Further Analysis | Isolate the affected endpoint from the network to prevent lateral movement or data exfiltration. Reverse engineer the suspicious DLLs involved to understand their behavior. Remove or replace malicious DLLs from the netsh helper configuration. Audit and review similar configurations across other systems for similar malicious activities. Deploy updated detection rules to identify similar attempts in the future. Conduct a full incident response with a focus on eradicating the threat actor's foothold and reinforcing network defenses. |
