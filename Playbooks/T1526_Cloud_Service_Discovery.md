# Cloud_Service_Discovery - T1526

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1526 |
| MITRE Sub-TTP | T1526 |
| Name | Cloud Service Discovery |
| Log Sources to Investigate | 1. Cloud service management logs: These may include AWS CloudTrail logs, Azure Activity logs, and Google Cloud Audit logs that record API calls and resource management actions. Example: AWS CloudTrail logs provide detailed logs of activity within an AWS account.<br>2. Identity and Access Management (IAM) audit logs: These logs track the authentication and authorization activity, providing insights into which identities attempted the discovery. Example: AWS IAM Access Analyzer logs.<br>3. Network flow logs: Capture data transactions within the cloud environment that can help identify unusual patterns. Example: VPC Flow Logs in AWS or Azure NSG Flow logs. 4. Application logs: Logs from cloud-native applications or platforms where adversaries might attempt enumeration. Example: Logs from AWS Lambda or Azure Functions when accessed inappropriately. |
| Key Indicators | 1. Unusual API calls: Monitor for unusual API calls related to resource listing or permissions. Example: AWS DescribeInstances, Azure List resources API calls.<br>2. Anomalous access patterns: Increased frequency of resource enumeration calls or access from atypical locations or times.<br>3. Access denied events: Repeatedly failed attempts due to access denials shortly followed by successful API calls indicating privilege escalation. 4. New or unscheduled use of enumeration tools: Detect executions of tools like Stormspotter or Pacu that are not part of regular operations. |
| Questions for Analysis | 1. Is the user or service account performing the enumeration activity a legitimate and expected actor for such actions?<br>2. Is the access to cloud services occurring from an expected geographic location or IP address?<br>3. Are the tools or methods used for discovery known to the security or operation teams? 4. Are there any correlated alerts indicating possible lateral movement or privilege escalation that could relate to cloud service enumeration? |
| Decision for Escalation | Escalate to Tier 2 if: 1. The activity is performed by a non-standard user or service account.<br>2. Enumeration activity originates from known malicious IP addresses, or unusual location patterns.<br>3. There are contextual alerts indicating a broader attack pattern such as privilege escalation, lateral movement, or attempted exfiltration. 4. Tool usage or activity patterns are novel and not documented in previous threat intelligence. |
| Additional Analysis Steps for L1 | 1. Verify the identity and role of the user or service account performing the activities.<br>2. Check user activity logs for additional context on access patterns and any associated alerts.<br>3. Review API call logs for details on the operations performed. 4. Correlate with any ongoing alerts or incidents related to cloud management activities. |
| T2 Analyst Actions | 1. Deep-dive analysis of the user or entity behavior analytics to identify deviations or anomalies.<br>2. Perform threat intelligence research on IP addresses, tools, or methods used related to the activity.<br>3. Conduct network forensic analysis to trace origin or intent of the activities. 4. Coordinate with cloud security teams to review and potentially revoke any unsecured access paths or permissions. |
| Containment and Further Analysis | 1. Temporarily halt suspicious accounts or sessions exhibiting unauthorized enumeration activity.<br>2. Implement geo-fencing and additional authentication steps to mitigate access from suspicious locations.<br>3. Review and enforce IAM policies to ensure proper permissions and reduce the attack surface. 4. Follow-up with a post-incident review to understand used techniques and strengthen cloud security posture. |
