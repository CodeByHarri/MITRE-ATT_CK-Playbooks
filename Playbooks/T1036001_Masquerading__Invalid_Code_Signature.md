# Masquerading:_Invalid_Code_Signature - T1036001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1036.001 |
| MITRE Sub-TTP | T1036.001 |
| Name | Masquerading: Invalid Code Signature |
| Log Sources to Investigate | Investigate logs pertaining to execution of binaries and code signing validation attempts. Key sources include: <br>1. Endpoint Detection and Response (EDR) solutions, which can track attempts to execute binaries and any associated alerts related to invalid signatures.<br>2. Security Information and Event Management (SIEM) systems capturing signature validation failures from operating system logs (e.g., Microsoft-Windows-CodeIntegrity/Operational logs on Windows).<br>3. Application Control logs (e.g., Microsoft AppLocker or macOS Gatekeeper) which may flag attempted executions of unsigned or incorrectly signed binaries.<br><br>Example log entry formats would include an EDR alert stating 'Signature validation failed for executed binary' and an SIEM event with details on the mismatch compared to valid signature templates. |
| Key Indicators | 1. Execution attempts of binaries with failed code signature validation.<br>2. Presence of files with signature metadata mimicking legitimate software but failing checks upon validation.<br>3. Unusual addition of new binaries in directories that typically contain signed software.<br>4. Rapid creation or modification of executable files without corresponding valid process lineage or source. |
| Questions for Analysis | 1. Does the file in question have a recent creation or modification date that is unusual for its apparent type?<br>2. Are there any known legitimate sources or developers for the binary, and can their signature information be verified? <br>3. Is there evidence of the binary being distributed through non-standard means, such as email attachments or download from unfamiliar URLs?<br>4. Are there any correlated alerts or logs indicating concurrent suspicious activity, such as credential access or network anomalies? |
| Decision for Escalation | Escalate to Tier 2 if: <br>1. The binary with the invalid signature is attempting to execute critical system functions or services.<br>2. There is corroborated evidence of attempts to distribute the binary across multiple endpoints in a corporate environment.<br>3. The signature metadata convincingly mimics a trusted source leading to potential misuse of trust within the network.<br>4. Initial analysis reveals the file is involved in other malicious activity (e.g., connections to blacklisted IPs). |
| Additional Analysis Steps for L1 | 1. Verify the signature validation status using native tools (e.g., sigcheck on Windows or codesign on macOS) on the suspicious binary.<br>2. Cross-reference the hash of the binary against known threat intelligence databases for any match with malware.<br>3. Gather more context on file origin â€“ check email logs or web traffic to trace potential download sources.<br><br>Document all findings and provide a summary if escalation is needed. |
| T2 Analyst Actions | 1. Conduct a deeper investigation of execution parent processes to determine the initial vector of the binary.<br>2. Review historical execution patterns for any anomalies leading to the binary's critical directories.<br>3. Leverage sandbox analysis to observe behavior of the suspicious binary in an isolated environment.<br>4. Coordinate with IT support to verify the legitimacy of any purported developer if confusion about signature authenticity exists. |
| Containment and Further Analysis | 1. Quarantine the binary on affected systems to prevent further execution while investigation continues.<br>2. Implement blocks through application control policies to prevent execution of binaries exhibiting similar invalid signatures.<br>3. Conduct a comprehensive sweep across endpoints for identical or similarly signed binaries using hashes or signature metadata.<br>4. After analysis, ensure thorough cleanup and recovery steps such as system restores or file removals if necessary, and update prevention mechanisms based on findings to avert repeat incidents. |
