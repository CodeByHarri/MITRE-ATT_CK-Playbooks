# Trusted_Developer_Utilities_Proxy_Execution:_MSBuild - T1127001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1127.001 |
| MITRE Sub-TTP | T1127.001 |
| Name | Trusted Developer Utilities Proxy Execution: MSBuild |
| Log Sources to Investigate | Investigate Windows Event Logs, specifically Security logs (Event ID 4688 for process creation), and Application logs for any errors or suspicious activities related to MSBuild.exe. Check for logs from Endpoint Detection and Response (EDR) solutions for related alerts on MSBuild usage. Additionally, review file system monitoring logs for the creation or alteration of suspicious XML project files typically used by MSBuild. Network logs should be checked for unusual outbound connections from the host executing MSBuild, as these could indicate data exfiltration or command and control communication. |
| Key Indicators | Presence of unexpected MSBuild.exe execution, especially from user directories or unexpected locations. XML project files calling C# or VB.NET code with embedded or referenced scripts. Unexpected network connections initiated by MSBuild.exe. MSBuild.exe being used outside standard development environments or without corresponding legitimate software development processes. |
| Questions for Analysis | Is MSBuild.exe being executed from a non-standard directory? Are there any recent changes to MSBuild-related XML project files? Are there unusual network connections originating from the process associated with MSBuild? Have there been any recent software development activities or projects that justify the use of MSBuild? |
| Decision for Escalation | Escalate to Tier 2 if MSBuild.exe execution is detected in a non-development environment, if there are signs of network communication to known malicious IPs following MSBuild execution, or if there are correlations with other suspicious activities such as known Indicators of Compromise (IOCs). |
| Additional Analysis Steps for L1 | Review the history of MSBuild executions across multiple hosts to detect patterns. Check for simultaneous alerts from other security tools for corroborative evidence of misuse. Validate the presence of XML files used by MSBuild in unauthorized locations. Search for known hashes or signatures of malicious XML files. |
| T2 Analyst Actions | Perform deeper investigation into the code executed via MSBuild by analyzing the XML and extracted inline code. Conduct a memory analysis to uncover any resident malware or ongoing processes initiated by MSBuild. Use sandboxing tools to safely execute suspicious XML files for behavior analysis. Correlate findings with threat intelligence to spot known attack patterns or APT group tactics. |
| Containment and Further Analysis | Isolate affected systems from the network to prevent further communication. Suspend or terminate the MSBuild process if found to be executing malicious code. Conduct forensic analysis on the affected systems to gather more evidence. Monitor for any persistent threats by ensuring continuous scrutiny of logs and network activity. Deploy additional security measures such as enhancing application whitelisting policies to control MSBuild rules. |
