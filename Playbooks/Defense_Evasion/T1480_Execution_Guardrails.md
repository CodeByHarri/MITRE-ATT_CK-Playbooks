# Execution_Guardrails - T1480

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1480 |
| MITRE Sub-TTP | T1480 |
| Name | Execution Guardrails |
| Log Sources to Investigate | Monitor application and system logs for any unusual or unknown processes that start executing conditional checks based on system environment variables like network share names, IP addresses, or attached devices. Network logs should be checked for unusual or suspect user-agent strings that could indicate modified or custom agents. Endpoint Detection and Response (EDR) tools can be used to detect changes in execution behavior on systems, and network intrusion detection systems (NIDS) can be useful to identify unusual HTTP/S traffic based on non-standard user-agent strings. |
| Key Indicators | Unexpected conditional checks based on system configurations such as specific network share names, local/external IP addresses, or the presence of physical devices. Detection of user-agents that do not match the standard format or contain uncommon data indicative of tampering or spoofing. Monitoring for applications that terminate prematurely or only execute under certain system configurations, could point towards presence of guardrails. |
| Questions for Analysis | Are there any discrepancies in the user-agent strings logged in network communications? Do the systems displaying execution guardrails behavior connect to network shares or domains of interest? Is there any correlation to recent changes in the system configurations or network setups? Are there repeated checks or comparisons against specific environment variables? |
| Decision for Escalation | Escalate to Tier 2 if guardrail checks are occurring on critical enterprise systems or if there are consistent attempts to match specific network configurations or use spoofed user-agents. Also, escalate if there is detection of rare or modified applications attempting such checks, as this could indicate a more targeted and sophisticated threat actor. |
| Additional Analysis Steps for L1 | Verify if the behavior is consistent with normal operations of legitimate software by checking application documentation or vendor communication. Look for any network communication attempts during the check process and ensure they are to known and approved IPs and domains. Cross-reference potentially malicious user-agent strings with threat intelligence sources. |
| T2 Analyst Actions | Conduct a deeper forensic analysis of the systems exhibiting unusual guardrail activity. Analyze the system configurations and network traffic related to suspect user-agents for malformed strings or unusual data patterns. Leverage threat intelligence to correlate activity with known tactics and techniques used by adversaries using execution guardrails. |
| Containment and Further Analysis | Isolate affected systems to prevent further potential propagation of threats. Apply temporary network segmentation policies if necessary. Capture memory and disk images for further forensic analysis. Work with IT to reset potentially affected environment-specific configurations like network shares or domain trusts. Enhance monitoring for similar attempts in the future and consider deploying honeypots to detect potential adversary profiling efforts. |
