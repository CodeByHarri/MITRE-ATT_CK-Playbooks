# Impair_Defenses:_Indicator_Blocking - T1562006

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1562.006 |
| MITRE Sub-TTP | T1562.006 |
| Name | Impair Defenses: Indicator Blocking |
| Log Sources to Investigate | Investigate logs from host-based sensors such as ETW logs, Windows Event Logs, Sysmon logs, and any centralized logging solutions like Splunk or ELK. Examine the Windows Registry changes, especially alterations to keys under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Security. Analyze logs from network monitoring solutions for blocked or dropped traffic related to telemetry reporting, and review firewall logs for any unexpected rules targeting SIEM hosts. In Linux, check syslog, auditd, and any modifications to logging configuration files for syslog or nxlog. |
| Key Indicators | Alterations in Windows Registry, specifically the 'File' value under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Security. Unusual PowerShell activity, particularly involving the Set-EtwTraceProvider cmdlet. Unexpected or unauthorized host-based firewall rule changes. In Linux environments, changes to syslog configurations or process logs indicating logging service stoppages. Network logs showing telemetry traffic being blocked or anomalous process terminations related to log forwarding. |
| Questions for Analysis | Has there been any unauthorized changes to Registry keys associated with event logging? Are there any unrecognized or abnormal PowerShell commands logged? Is there newfound absence or reduction of expected telemetry data flowing to SIEM or other centralized systems? Are there unexpected firewall rules established? For Linux, are there recent modifications in logging configurations or stoppage of logging services? |
| Decision for Escalation | Escalate to Tier 2 if there is confirmation of Registry modifications without authorization, evidence of PowerShell misuse in relation to ETW, suspicious alterations in firewall rules affecting telemetry traffic, or logging configuration changes inconsistent with routine changes. Additionally, escalate if legitimate indicators of compromise cannot be adequately explained by normal operations. |
| Additional Analysis Steps for L1 | Correlate reported changes with authorized user activity within the organization. Validate any detected PowerShell usage against legitimate administrative scripts. Compare current firewall and logging configurations with historical baselines to identify unauthorized modifications. Collaborate with the network team to identify any suspicious traffic patterns or process terminations. |
| T2 Analyst Actions | Perform deeper forensic analysis on affected systems, focusing on timeline reconstruction of Registry or configuration changes. Engage in more granular network traffic analysis to determine the scope of traffic blocking. Coordinate with system administrators to ascertain intentions behind noticed PowerShell activities. Conduct interviews if internal misuse is suspected to gather context. |
| Containment and Further Analysis | If unauthorized changes are confirmed, the immediate action is to correct affected Registry settings and log configurations. Roll back suspicious firewall rules and re-enable stopped services. Enhance monitoring on the affected systems for further unauthorized actions. Isolate the systems involved for a detailed malware or threat actor investigation, considering memory analysis and disk forensics to capture any volatile artifacts. |
