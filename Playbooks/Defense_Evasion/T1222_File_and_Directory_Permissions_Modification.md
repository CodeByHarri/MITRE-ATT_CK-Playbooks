# File_and_Directory_Permissions_Modification - T1222

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1222 |
| MITRE Sub-TTP | T1222 |
| Name | File and Directory Permissions Modification |
| Log Sources to Investigate | Investigate system logs related to file and directory permission changes such as Security Event logs on Windows (e.g., Event IDs 4670 for permission change), and audit logs on Unix/Linux systems using commands like 'auditctl'. Also, examine file system metadata from forensic tools that track ACL changes. Check endpoint detection and response (EDR) solutions for alerts related to unauthorized file permission modifications. Include logs from file integrity monitoring solutions that detect alterations to permission attributes. |
| Key Indicators | Unauthorized changes to file or directory permissions or attributes, especially for critical system files or directories. Frequent modifications in a short time span from irregular user accounts or privileged accounts unfamiliar to the system. Occurrences of suspicious commands like 'icacls', 'chmod', and 'setfacl' executed via cmd or scripts. Changes to permissions of symbolic links pointing to sensitive files or directories or involving remote paths. |
| Questions for Analysis | Was there any authorized user or scheduled task expected to make the permission change at the observed time? Are the changes observed in legitimate system files or directories used for daily operations? Is the user account associated with the changes showing any other signs of compromise, such as login anomalies or privilege escalations? |
| Decision for Escalation | Escalate to Tier 2 if permission modifications were performed using a non-administrative account or from accounts that have indications of compromise. Escalate if the modifications allow execution, writing, or deletion on critical system or security-related files by unauthorized users. Also, escalate if the changes coincide with other indicators of ongoing attack sequences, such as abnormal process execution or network traffic. |
| Additional Analysis Steps for L1 | Verify the user account and process that performed the modifications. Correlate with recent authentication events to assess if there was any unusual access. Review similar logs in recent history for a pattern or anomaly. Ensure that system files or directories affected have not been altered apart from permissions, by checking file hashes against known good values or backups. |
| T2 Analyst Actions | Perform deeper dive on unusual accounts identified, investigating account creation and associated processes. Correlate with other potentially malicious activities within the same timeframe, such as new processes reversing permissions in Event logs. Conduct behavioral analysis to determine if thereâ€™s a larger compromise or persistence mechanism in action. Consider employing file integrity monitoring to assess further file alterations retrospectively. |
| Containment and Further Analysis | Reverse unauthorized permission changes back to the original state, ensuring critical files have their permissions locked down to prevent further compromise. If malicious activity is detected, isolate the affected system from the network to prevent lateral movement. Conduct a full forensic analysis on the isolated system to identify potential malware or persistence mechanisms and remediate them. Strengthen file system monitoring policies to detect and notify similar unauthorized attempts in the future. |
