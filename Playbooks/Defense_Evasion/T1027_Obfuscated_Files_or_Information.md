# Obfuscated_Files_or_Information - T1027

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1027 |
| MITRE Sub-TTP | T1027 |
| Name | Obfuscated Files or Information |
| Log Sources to Investigate | To investigate T1027 - Obfuscated Files or Information, review log sources such as:<br>1. File Integrity Monitoring systems for changes to files, especially those with uncommon file extensions or high entropy.<br>2. Endpoint Detection and Response (EDR) logs for signs of suspicious file executions or script activities that could indicate obfuscation.<br>3. Network traffic logs and packet captures for unusual file transfers, encrypted payloads, or encoded data in transit.<br>4. Application logs, especially from systems that handle compressed or encrypted files such as email clients or productivity software.<br>5. Anti-virus/Malware detection logs for alerts on files identified with generic detections or heuristics suggesting obfuscation. |
| Key Indicators | Key indicators of T1027 activity include:<br>1. Presence of files with random or obfuscated names, high entropy, or uncommon file extensions like .xyz, .enc, or others not typically used in the environment.<br>2. Execution of commands with encoded scripts or PowerShell commands with parameters such as `-EncodedCommand`.<br>3. Multiple file decompression operations within a short time frame that are uncommon for usual user behavior.<br>4. Observed packing or encryption algorithms in use (e.g., UPX, Themida) on executable files across the network.<br>5. Anomalies in user activities, e.g., users accessing or executing files they wouldn't normally interact with. |
| Questions for Analysis | Tier 1 analysts should consider:<br>1. Are the identified files/tools known and expected within the network? Are they signed by a trusted source?<br>2. Does the timeframe and pattern of obfuscation correlate with any ongoing legitimate infrastructure changes?<br>3. Have similar alerts been identified in logs from other systems that may indicate a broader pattern?<br>4. Is there evidence of user activity that suggests the files were knowingly executed (e.g., records of user action logs)?<br>5. Are there any reports of new or recurring external threats that might match the observed behavior? |
| Decision for Escalation | Escalate the alert to Tier 2 if:<br>1. Files or scripts identified as being obfuscated are found on critical systems or servers.<br>2. There are related alerts indicating phishing attempts or other vectors of compromise around the same time period.<br>3. Attempts to deobfuscate or access additional information seem to be initiated without typical user involvement or under privileged accounts.<br>4. Identified activity matches indicators from recent threat intelligence feeds or known attack patterns. |
| Additional Analysis Steps for L1 | L1 analysts can:<br>1. Correlate detected obfuscated files/executions with known good processes to rule out false positives.<br>2. Verify file hashes against known malware repositories or threat intelligence databases.<br>3. Gather context from related alerts to derive the scope of potential incidents.<br>4. Check network logs for associated IP addresses or domains known for malicious activities.<br>5. Validate user activity logs to ensure identified actions were performed by legitimate users. |
| T2 Analyst Actions | Tier 2 analysts should:<br>1. Conduct deeper forensic investigation into affected endpoints to understand the full extent of obfuscation.<br>2. Extract and analyze payloads using deobfuscation tools to identify any malicious components.<br>3. Use threat intelligence and behavioral analytics to link activities to specific attack groups or campaigns.<br>4. Work with incident response teams to establish whether data exfiltration has occurred.<br>5. Provide recommendations on strengthening defenses against identified obfuscation techniques. |
| Containment and Further Analysis | To contain the identified threat:<br>1. Identify, isolate, and remove any compromised or suspicious files or programs from active systems.<br>2. Monitor network traffic closely for continued or residual activity from the threat inputs.<br>3. Update signatures and rules in security tools to detect and block similar obfuscation attempts.<br>4. Inform stakeholders and relevant teams regarding the incident resolution steps and potential future preventive measures.<br>5. Conduct a retrospective analysis to improve detection capabilities and update the knowledge base with findings and lessons learned. |
