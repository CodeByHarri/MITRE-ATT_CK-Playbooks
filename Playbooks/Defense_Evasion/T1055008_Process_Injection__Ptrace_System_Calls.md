# Process_Injection:_Ptrace_System_Calls - T1055008

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Privilege Escalation |
| MITRE TTP | T1055.008 |
| MITRE Sub-TTP | T1055.008 |
| Name | Process Injection: Ptrace System Calls |
| Log Sources to Investigate | ['System calls and process activity logs capturing ptrace system calls, such as PTRACE_ATTACH, PTRACE_SETREGS, PTRACE_POKETEXT, and PTRACE_POKEDATA. These can be collected via auditd on Linux.', 'Detailed logs from endpoint detection and response (EDR) solutions that monitor process injection activities.', 'Kernel debug logs, if enabled, to track low-level system actions including ptrace interactions.', 'Security Information and Event Management (SIEM) solutions can aggregate these logs for correlation and further analysis.'] |
| Key Indicators | ['Unusual PTRACE_ATTACH requests where non-debugging processes attach to other processes.', 'Execution of PTRACE_SETREGS, PTRACE_POKETEXT, or PTRACE_POKEDATA by non-legitimate debugging tools.', 'Unexpected invocation of ptrace-related system calls by processes that typically do not perform debugging operations.', 'High frequency of suspicious memory writes or register modifications in a short time span by processes.'] |
| Questions for Analysis | ['Is the PTRACE call originating from a process that normally performs debugging tasks?', 'Is the target process running with elevated privileges compared to the attaching process?', 'Is the system configured to allow non-root users to perform ptrace system calls on these processes?', 'Is there any legitimate software or updates that might trigger ptrace system call patterns on this host?'] |
| Decision for Escalation | ['Escalate if the PTRACE call is initiated by an unexpected or unauthorized process.', 'Escalate if unauthorized memory or register modifications are detected in sensitive or privileged processes.', 'Escalate if processes involved in ptrace activity correspond to known malicious or unauthorized software.'] |
| Additional Analysis Steps for L1 | ['Verify the process initiating PTRACE calls with a known baseline to identify unusual behavior.', 'Correlate any triggered security alerts or anomalies captured around the same time as critical pointers to ptace activity.', 'Review user permissions and recent logins to determine if the action aligns with typical user activity.'] |
| T2 Analyst Actions | ['Conduct a deeper investigation into the source process of the ptrace call, verifying against known threat intelligence data.', 'Analyze the memory space modifications and ascertain if they contain shellcode or executable code.', 'Check for rootkits or other signs of compromise that might have enabled unauthorized ptrace invocation.'] |
| Containment and Further Analysis | ['Immediately isolate the affected systems to prevent further unauthorized actions or compromises.', 'Perform a comprehensive scan for other signs of compromise, such as unexpected open ports, new user accounts, or unexpected scheduled tasks.', 'Review and tighten ptrace and system call audit policies to ensure better monitoring and identification of future incidents.'] |
