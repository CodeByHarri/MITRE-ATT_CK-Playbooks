# Hijack_Execution_Flow:_Dynamic_Linker_Hijacking - T1574006

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Persistence, Privilege Escalation |
| MITRE TTP | T1574.006 |
| MITRE Sub-TTP | T1574.006 |
| Name | Hijack Execution Flow: Dynamic Linker Hijacking |
| Log Sources to Investigate | 1. Process creation logs (e.g., Sysmon on Windows, Linux audit logs): Check for processes initiated with suspicious environment variables such as LD_PRELOAD and DYLD_INSERT_LIBRARIES.<br>2. File system monitoring tools: Look for modifications to files or directories related to dynamic linker configurations, such as /etc/ld.so.preload on Linux.<br>3. Command-line activity logs: Examine shell history or command-line logs for export, setenv, or putenv commands that set LD_PRELOAD or DYLD_INSERT_LIBRARIES variables. 4. Application logs: Investigate logs of applications for unusual or unexpected library load activities. 5. Network monitoring tools: Check for unusual patterns of network activity associated with compromised processes. |
| Key Indicators | 1. Usage of export to set LD_PRELOAD or DYLD_INSERT_LIBRARIES in process creation logs.<br>2. Creation or modification of /etc/ld.so.preload file with unknown libraries.<br>3. Unusual or unauthorized libraries appearing in process memory space that originate from suspicious paths. 4. Unexpected network connections initiated by processes whose environment includes hijacked dynamic linker variables. |
| Questions for Analysis | 1. Is the LD_PRELOAD or DYLD_INSERT_LIBRARIES variable set for processes that do not commonly use custom library loads?<br>2. Are there known legitimate use cases or developer activities for setting these environment variables on the affected systems?<br>3. Are the specified libraries coming from known or trusted directories, or are they residing in unusual locations? 4. Has there been any recent history of training or developer activities explained that could justify these settings? |
| Decision for Escalation | Escalate to Tier 2 if there is no legitimate explanation for the presence of dynamic linker hijacking strategies, such as unexpected library paths or unauthorized database/process access attempts associated with the affected variables. Escalate if combined with other indicators of compromise, such as lateral movement or data exfiltration activities. |
| Additional Analysis Steps for L1 | 1. Verify the source and path of suspicious libraries loaded via LD_PRELOAD or DYLD_INSERT_LIBRARIES.<br>2. Contact system owners or developers to confirm if the observed behavior is known and authorized.<br>3. Review recent changes in system configurations or installed packages that may have introduced new environment variables. |
| T2 Analyst Actions | 1. Conduct in-depth analysis to identify potential malware signatures or payloads in the suspicious libraries.<br>2. Correlate the detected activities with other logged security events to identify patterns indicative of a breach.<br>3. Use threat intelligence to verify if the libraries or techniques match known adversary tactics. |
| Containment and Further Analysis | 1. Remove or quarantine malicious libraries from affected systems and reset dynamic linker variables to default settings.<br>2. Conduct a comprehensive malware scan and clean-up to ensure system integrity.<br>3. Implement network isolation for affected hosts, if necessary, to prevent further unauthorized network access. 4. Review and update system security policies to limit environment variable manipulation. 5. Perform a full post-incident review to enhance detection and response procedures against such hijacking attempts in future. |
