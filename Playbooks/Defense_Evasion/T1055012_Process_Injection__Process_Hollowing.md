# Process_Injection:_Process_Hollowing - T1055012

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Privilege Escalation |
| MITRE TTP | T1055.012 |
| MITRE Sub-TTP | T1055.012 |
| Name | Process Injection: Process Hollowing |
| Log Sources to Investigate | When investigating Process Hollowing (T1055.012), the following log sources should be examined: <br>1. Windows Security Event Logs: Look for specific events such as process creation events (Event ID 4688) which can show a process created in a suspended state. <br>2. Endpoint Detection and Response (EDR) telemetry: This can provide granular detail on process injection behaviors and memory manipulation. <br>3. Windows API Logging: To capture suspicious API calls like CreateProcess, ZwUnmapViewOfSection, NtUnmapViewOfSection, VirtualAllocEx, WriteProcessMemory, SetThreadContext, and ResumeThread. <br>4. Application and System logs: To check for any anomalies in execution paths or process relationships. |
| Key Indicators | Key Indicators for Process Hollowing include: <br>1. Creation of a process in a suspended state with CreateProcess API calls. <br>2. Use of ZwUnmapViewOfSection or NtUnmapViewOfSection to unmap the process's memory. <br>3. Frequent occurrences of VirtualAllocEx and WriteProcessMemory used together. <br>4. Context switching in threads observed with SetThreadContext and thread resuming with ResumeThread. <br>5. Anomalous execution footprints where benign processes are hosting unknown executables within their space. |
| Questions for Analysis | 1. Is there evidence of a process being started in a suspended state followed by hollowing activity? <br>2. Do logs show the specific sequence of API calls associated with process hollowing? <br>3. Are the involved processes known and expected to perform such memory operations? <br>4. Is the parent process of the hollowed process itself suspicious or known for such malicious behavior? <br>5. Could there be legitimate software known to use these techniques? <br>6. Are there any network connections from the hollowed process that appear suspicious? |
| Decision for Escalation | Escalate to Tier 2 if: <br>1. There is confirmation of API call sequences aligned with process hollowing and the parent process is not whitelisted or recognized as legitimate. <br>2. The investigation uncovers additional suspicious activities like unexpected network communications or lateral movement attempts. <br>3. Multiple process hollowing events detected across systems indicating potential widespread infection. |
| Additional Analysis Steps for L1 | 1. Correlate findings with known software and whitelisted applications to rule out false positives. <br>2. Verify if the process in question is signed by a known and trusted vendor. <br>3. Review historical data for patterns of similar suspicious activities associated with the affected systems. <br>4. Check for other artifacts in the system, like unexpected files or registry changes, which could provide more context. |
| T2 Analyst Actions | 1. Perform in-depth memory analysis on the suspect processes to determine the actual payload injected. <br>2. Use advanced EDR queries or scripts to hunt for similar behavior enterprise-wide. <br>3. Collaborate with threat intelligence to cross-reference any identified malicious hashes or indicators of compromise. <br>4. Analyze any dropped files or executables associated with the event for further insights into potential persistence mechanisms. |
| Containment and Further Analysis | 1. Isolate the affected host(s) to prevent further potential spread while investigating. <br>2. Initiate process and network connection termination where malicious activity is confirmed. <br>3. Collect and preserve forensic data from affected systems for further examination. <br>4. Develop and deploy rules or signatures in network and host-based security controls to block further process hollowing attempts. <br>5. Conduct a review of the organizationâ€™s firewall, IDS/IPS, and endpoint security policies to enhance defenses against similar threats. |
