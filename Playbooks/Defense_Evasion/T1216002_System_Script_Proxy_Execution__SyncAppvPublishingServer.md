# System_Script_Proxy_Execution:_SyncAppvPublishingServer - T1216002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1216.002 |
| MITRE Sub-TTP | T1216.002 |
| Name | System Script Proxy Execution: SyncAppvPublishingServer |
| Log Sources to Investigate | 1. Script/Process Execution Logs: Investigate logs from Sysmon or Windows Event Logs (Event ID 4688 for process creation) to identify execution of SyncAppvPublishingServer.vbs.<br>2. File Integrity Monitoring: Look for changes or execution of scripts within the System32 directory.<br>3. PowerShell Logs: Examine PowerShell logs (Event ID 4104 for script block logging) for unusual or suspicious PowerShell commands invoked. 4. Security Information and Event Management (SIEM): Analyze aggregated data for correlations of script execution and anomalous command-line usage. |
| Key Indicators | 1. Execution of SyncAppvPublishingServer.vbs from unexpected directories or with unusual command line arguments.<br>2. Presence of spikes in PowerShell activity correlated with SyncAppvPublishingServer.vbs execution.<br>3. Network connections initiated by the scripts or associated PowerShell commands to unfamiliar or flagged domains. 4. Logs showing the use of SyncAppvPublishingServer.vbs with 'n; {PowerShell}' as a parameter. |
| Questions for Analysis | 1. Is SyncAppvPublishingServer.vbs executing from the System32 directory or an unexpected location?<br>2. Is the script being used at times when it is typically not executed, such as outside regular business hours?<br>3. Are there any uncommon or unauthorized PowerShell commands being executed, especially those that are obfuscated or accessing suspicious IPs/domains? 4. Are there any correlations with known indicators of compromise (IOCs) related to similar TTPs? |
| Decision for Escalation | Escalate to Tier 2 if: 1. SyncAppvPublishingServer.vbs is running from an unusual location or at suspicious times.<br>2. PowerShell commands associated with the script are obfuscated or involve communication with known malicious domains/IPs.<br>3. Use of the script is part of a broader pattern of suspicious activity observed in the environment. |
| Additional Analysis Steps for L1 | 1. Collect and review script execution logs focusing on timestamps and user context.<br>2. Check for recent changes or anomalies in application virtualization settings or configurations.<br>3. Investigate corresponding PowerShell activity to understand the nature and intent of the commands executed. 4. Cross-reference execution with known good baselines and IOC databases. |
| T2 Analyst Actions | 1. Perform deeper forensic analysis of script and PowerShell execution artifacts.<br>2. Analyze network traffic for anomalies associated with suspicious PowerShell commands.<br>3. Verify the legitimacy of the associated script or PowerShell commands by consulting with system owners or administrators. 4. Review historical data for patterns suggesting persistence or lateral movement attempts. |
| Containment and Further Analysis | 1. Isolate compromised systems if the script execution is confirmed as malicious.<br>2. Block network communications to known malicious IPs/domains discovered during analysis.<br>3. Remove or disable unauthorized scripts and apply patches or updates if they address discovered vulnerabilities. 4. Conduct root cause analysis to determine how the adversary gained access to trigger the script and enhance preventative controls to mitigate future risks. |
