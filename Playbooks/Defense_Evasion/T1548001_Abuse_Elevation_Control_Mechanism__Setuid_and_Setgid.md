# Abuse_Elevation_Control_Mechanism:_Setuid_and_Setgid - T1548001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Privilege Escalation |
| MITRE TTP | T1548.001 |
| MITRE Sub-TTP | T1548.001 |
| Name | Abuse Elevation Control Mechanism: Setuid and Setgid |
| Log Sources to Investigate | Examine system logs such as /var/log/auth.log or /var/log/secure on Linux and the /var/log/system.log on macOS for unexpected setuid or setgid binary executions. Analyze logs related to file permission changes, particularly those involving the chmod command. Monitor process execution logs for unusual child processes of setuid/setgid programs. Collect logs from file integrity monitoring tools to track changes to binaries with setuid/setgid bits. |
| Key Indicators | Presence of binaries with setuid or setgid permission where none existed previously. Use of chmod commands to set setuid/setgid bits, especially by non-privileged users. Execution of programs with setuid/setgid permissions by non-standard users. Frequent use of the find command searching for setuid/setgid binaries. Log entries showing unexpected or unauthorized privilege escalation attempts. |
| Questions for Analysis | Has there been a recent change in setuid/setgid permissions on any critical binaries? Who executed the chmod command that changed these permissions? Are there legitimate business reasons for these permissions to be altered? Is there any correlation between the presence of these binaries and suspicious user account activities? Are there previous incidents involving the affected binaries? |
| Decision for Escalation | Escalate to Tier 2 if there is evidence of unauthorized changes to setuid/setgid permissions, especially involving critical system binaries or files. Also, escalate if permission changes are linked to suspicious accounts or if there is any indication of privilege escalation attempts. Escalate if multiple indicators connect to potential compromise or a wider intrusion pattern. |
| Additional Analysis Steps for L1 | Verify the ownership and recent changes to the setuid/setgid binaries using file metadata. Review the user activity logs at the time the chmod command was executed. Check for anomalies in user behavior such as unusual login times or atypical command usage. Cross-reference the affected binaries with known security alerts or vendor advisories. |
| T2 Analyst Actions | Perform a deeper inspection of the affected systems, checking for additional indicators of compromise or lateral movement. Examine the involved user accounts for unusual behaviors or potential hijacking. Analyze network traffic for communication attempts with known command and control servers. Use threat intelligence sources to see if the detected patterns match any known malicious toolkits or campaigns. |
| Containment and Further Analysis | Reset the permissions of affected files to secure defaults and ensure no other unauthorized changes are present. Isolate compromised accounts and perform required password changes or multi-factor authentication enforcement. Conduct a full malware scan of the system to uncover any additional threats. If a specific malware is identified, use vendor-supplied removal tools or guidelines. Regularly update all systems and apply necessary patches or security measures. |
