# Impair_Defenses:_Safe_Mode_Boot - T1562009

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1562.009 |
| MITRE Sub-TTP | T1562.009 |
| Name | Impair Defenses: Safe Mode Boot |
| Log Sources to Investigate | Collect and analyze event logs related to Windows Boot Configuration Data (BCD) changes, specifically looking at Event ID 13 from the Microsoft-Windows-Kernel-Boot log, which logs boot loader actions. Monitor Security Log for Event ID 4688 (Process Creation) to track execution of 'bcdedit.exe' or other commands associated with boot configuration changes. Gather Windows Registry modification logs, focusing on keys associated with loading services in Safe Mode, such as HKLM\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal and HKLM\SYSTEM\CurrentControlSet\Control\SafeBoot\Network. |
| Key Indicators | Unusual modifications to BCD stores indicating changes to boot configuration for enabling Safe Mode. Creation or modification of registry keys linked to Safe Mode services. Suspicious entries or applications listed in Safe Mode boot processes. Registration of potentially malicious COM objects traced back to recent Safe Mode boots. |
| Questions for Analysis | Have there been any unexpected reboots around the same time as BCD or registry changes? Are there legitimate justifications or related IT tickets for Safe Mode use? Are the modified registry keys associated with known safe applications, or are they linked to unusual or rare programs? Are there any ongoing alerts within the organization for malware or ransomware threats consistent with TTPs that exploit Safe Mode? |
| Decision for Escalation | Escalate to Tier 2 if there are no legitimate justifications for Safe Mode usage, or if Safe Mode modifications are paired with detected or suspected malware activities. Uncommon patterns or tools modifying boot configurations, especially those coming from user machines instead of IT management consoles, should also be escalated. |
| Additional Analysis Steps for L1 | Correlate boot and registry change events with user activity logs to identify if legitimate users or processes are responsible. Check for correlation with known attack patterns or ongoing incidents in threat intelligence databases. Verify the digital signatures of any new or altered services set to run in Safe Mode. Cross-reference with antivirus and EDR alerts for known malware indicators. |
| T2 Analyst Actions | Perform a forensic analysis of BCD and system image captures to identify unauthorized modifications. Use reverse engineering or sandboxing techniques to analyze unfamiliar applications or services now set to run in Safe Mode. Investigate network connections made by modified or newly introduced services for suspicious outbound traffic. Look for lateral movement techniques following Safe Mode boot. |
| Containment and Further Analysis | Roll back unauthorized BCD and Registry changes to secure normal boot procedures. Isolate affected systems from the network to prevent potential spread or lateral movement. Deploy network scans to check if other systems have pending configuration changes for Safe Mode. Conduct a wider threat hunt for indicators of known malware related to the suspicious Safe Mode configuration detected. |
