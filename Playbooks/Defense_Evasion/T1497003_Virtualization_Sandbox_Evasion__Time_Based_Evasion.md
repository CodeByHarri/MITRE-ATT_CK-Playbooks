# Virtualization_Sandbox_Evasion:_Time_Based_Evasion - T1497003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Discovery |
| MITRE TTP | T1497.003 |
| MITRE Sub-TTP | T1497.003 |
| Name | Virtualization/Sandbox Evasion: Time Based Evasion |
| Log Sources to Investigate | 1. Process Execution Logs: Monitor logs for suspicious use of sleep commands or repetitive tasks such as ping loops, which may indicate time-based evasion tactics.<br>2. Scheduled Task Logs: Review scheduled tasks to identify any suspicious delays configured to prolong task execution.<br>3. API Call Logs: Examine logs for excessive or repetitive use of Native API calls, which may be a sign of API hammering. 4. Network Traffic Logs: Look for irregular traffic patterns that may indicate delayed execution of malicious activities. 5. System Clock and Uptime Logs: Check for discrepancies or unusual patterns in system time updates or resets that could indicate environment manipulation. |
| Key Indicators | 1. High frequency of sleep commands within script or process.<br>2. Repetitive execution of benign commands like ping in a short period.<br>3. Sudden changes in system time or unexplained adjustments in system uptime. 4. Excessive and abnormal API calls targeting system-native functionalities. 5. Scheduled tasks set with significant delays without justifiable operational reasons. |
| Questions for Analysis | 1. Does the sequence of events suggest excessive delays typically not used in normal operations?<br>2. Are there any known benign reasons for the observed use of sleep or delay tactics?<br>3. Is there incoming or outgoing network communication associated with the processes using time-based evasion techniques? 4. Are there any patterns that suggest attempts to evade automated analysis or sandbox environments? |
| Decision for Escalation | 1. Escalate if there is evidence of scripted automation using repetitive commands without a legitimate purpose.<br>2. Escalate upon detecting suspicious changes in system time or uptime that cannot be attributed to routine processes.<br>3. Escalate if there are strong correlations between suspicious scheduling tasks and potential unauthorized access indicators. |
| Additional Analysis Steps for L1 | 1. Validate whether the observed delays or repetitive activities align with scheduled maintenance or operational tasks.<br>2. Correlate suspicious processes with active network connections to identify potential communication with known malicious IPs/domains.<br>3. Review historical logs for patterns of similar behavior indicating broader or repeated use of evasion tactics. |
| T2 Analyst Actions | 1. Perform deeper manual analysis of suspicious processes to identify embedded time-based evasion code.<br>2. Engage in threat intelligence to determine if observed behaviors match known TTPs associated with identified threats.<br>3. Use sandbox environments to test suspicious binaries or scripts for their full operational capacity and detect evasion strategies. |
| Containment and Further Analysis | 1. Isolate affected systems from the network immediately to prevent further potential compromise.<br>2. Update threat detection signatures to specifically target identified time-based evasion techniques.<br>3. Conduct a full forensic analysis of affected machines to understand the extent of their interaction with the malware. 4. Remediate compromised systems by restoring them to a known-good state and applying appropriate security patches. |
