# Indicator_Removal:_Clear_Network_Connection_History_and_Configurations - T1070007

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1070.007 |
| MITRE Sub-TTP | T1070.007 |
| Name | Indicator Removal: Clear Network Connection History and Configurations |
| Log Sources to Investigate | Investigate logs that may contain indications of network connections being removed or altered. Primary sources include Windows Registry keys related to RDP connections, specifically 'HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default' and 'HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers'. File paths such as 'C:\Users\%username%\Documents\Default.rdp' and 'C:\Users\%username%\AppData\Local\Microsoft\Terminal Server Client\Cache\' should be checked for unusual modifications. For macOS and Linux, examine system logs stored in '/Library/Logs' and '/var/log/'. Additional attention should be paid to logs relating to network configurations, such as firewall settings or proxy configurations in '/etc/sysconfig/iptables' on Linux or '/etc/pf.conf' on macOS. |
| Key Indicators | Alterations or deletions in RDP registry keys or local cache files without corresponding legitimate user actions are suspicious. Unexplained removal of log entries in system logs that typically record network connection history. Sudden modifications to firewall rules without logged administrative access or process initiations relating to network settings being altered. Rapid, consecutive logins and deletions in RDP-related paths could indicate malicious activity. |
| Questions for Analysis | Were there any legitimate maintenance activities scheduled that might have warranted such changes? Were there any administrative accounts used during the time these changes were made? Is there a history of similar changes made on the same device or by the same user account? Are there any known vulnerabilities or exploits that correlate with the timing of these changes? |
| Decision for Escalation | Escalate if unauthorized modifications or deletions are detected. If there were no planned administrative activities or if the changes correlate with indicators of further compromising actions. If the same user account has been implicated in previous incidents or if a pattern of similar activity is observed across multiple devices. |
| Additional Analysis Steps for L1 | Verify any administrative logs or support tickets for evidence of planned maintenance or configuration changes. Check if there were any alerts triggered by IDS/IPS systems around the time the modifications occurred. Look for any correlated security alerts or entries in the SIEM related to account anomalies or attempts to clear logs. |
| T2 Analyst Actions | Conduct a deeper investigation of associated user accounts, reviewing their recent activities and login patterns. Use endpoint detection and response (EDR) tools to check for any undetected malware or processes that might have caused these changes. Correlate network logs with known malicious IP addresses or domains. Analyze network traffic around the detected timeframe for any unusual outbound connections. |
| Containment and Further Analysis | Isolate the affected assets to prevent further unauthorized access. Restore modified registry keys or configuration files from backups, if available, to maintain system integrity. Implement enhanced monitoring on affected systems to capture any repetitive or new malicious attempts and to assist in defense strategy development. Conduct a security awareness session if human factors contributed to the breach. |
