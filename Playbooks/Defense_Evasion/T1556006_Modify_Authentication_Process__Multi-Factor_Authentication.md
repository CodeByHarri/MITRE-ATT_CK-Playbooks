# Modify_Authentication_Process:_Multi-Factor_Authentication - T1556006

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access, Defense Evasion, Persistence |
| MITRE TTP | T1556.006 |
| MITRE Sub-TTP | T1556.006 |
| Name | Modify Authentication Process: Multi-Factor Authentication |
| Log Sources to Investigate | Investigate logs from Identity and Access Management (IAM) systems such as Azure AD, Okta, or Duo Security to detect anomalies in MFA settings and user access patterns. Additionally, review Windows Event Logs, especially those related to file modifications, such as changes to the Windows hosts file. Network traffic logs that include DNS queries can provide insight into any unusual modifications redirecting MFA servers to localhost. |
| Key Indicators | Look for MFA configuration changes, such as removed or modified MFA methods or policies, notably exclusions in Conditional Access Policies. Monitor for new MFA devices or apps that were registered without user participation. Track any edits or writes to critical system files like the 'hosts' file on Windows systems, or indications of network traffic to localhost when expecting MFA server interactions. |
| Questions for Analysis | 1. Are there any recent changes to MFA configurations or policies that were not authorized by a security admin? <br>2. Have there been any anomalous registrations of MFA methods or devices?<br>3. Is there evidence of unauthorized access attempts following the MFA changes?<br>4. Are there any known vulnerabilities in recently registered MFA methods?<br>5. Is there a pattern of 'fail open' logins after MFA server traffic was redirected? |
| Decision for Escalation | Escalate to Tier 2 if there is evidence of unauthorized changes to MFA configurations or if unusual patterns of logons are detected post-MFA modification, especially if these involve previously unknown or unauthorized MFA methods. Escalation should also occur if traffic analysis indicates suspicious redirections akin to those described in known adversarial techniques. |
| Additional Analysis Steps for L1 | Cross-verify user activity logs for unusual logins from new locations or devices. Check for any recent administrative access or roles changes related to MFA configurations. Validate if there were legitimate changes to MFA settings, like new integrations or policy updates, in recent maintenance windows or change control periods. |
| T2 Analyst Actions | Conduct a deeper investigation of the flagged suspicious MFA changes. Validate the identities and source locations associated with any dubious modifications or registrations. Perform threat intelligence checks to match detected indicators with known adversary TTPs. Use endpoint detection tools to analyze any changes to the hosts file or other MFA-related configurations for the presence of malware or unauthorized scripts. |
| Containment and Further Analysis | Immediately revoke any unauthorized MFA changes, such as illegitimate device registrations or policy exclusions. Restore or reconfigure MFA settings to a secure state. Isolate any systems where malicious host file modifications were found. Conduct a thorough network and endpoint sweep for indications of other backdoors or persistence mechanisms. Engage in a full audit of the affected user accounts and their recent network activity to detect further compromise. |
