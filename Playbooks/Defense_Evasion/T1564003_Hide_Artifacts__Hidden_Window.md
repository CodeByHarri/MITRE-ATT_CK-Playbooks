# Hide_Artifacts:_Hidden_Window - T1564003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1564.003 |
| MITRE Sub-TTP | T1564.003 |
| Name | Hide Artifacts: Hidden Window |
| Log Sources to Investigate | Investigate application execution logs and process creation logs, specifically looking for the execution of applications or scripts with window hiding parameters. This includes looking at logs from PowerShell command execution with parameters such as -WindowStyle Hidden. Also, check Desktop Window Manager logs on Windows for the creation of hidden desktops using the CreateDesktop() API. On macOS, inspect plist file alterations, specifically changes to the apple.awt.UIElement tag. Endpoint Detection and Response (EDR) solutions may also provide visibility into processes running with hidden window attributes. |
| Key Indicators | Look for the execution of processes with parameters that suggest hidden window operations, such as powershell.exe -WindowStyle Hidden. Detect unusual creation of hidden desktops, potentially signified by the simultaneous running of multiple explorer.exe processes. On macOS, altered plist files indicating apple.awt.UIElement use or changes. Additionally, hidden VNC sessions can be identified by detecting network communications typical of VNC traffic that does not correspond to a visible VNC application. |
| Questions for Analysis | 1. Is there an unusual number of processes running with hidden window parameters?<br>2. Are there any unexplained hidden desktops or duplicate explorer.exe processes?<br>3. Have there been recent malicious activities or alerts originating from this endpoint?<br>4. Are there any changes in plist files concerning apple.awt.UIElement that are unauthorized or unusual? |
| Decision for Escalation | Escalate if there are confirmed hidden processes or windows, unusual desktop creation logs, or any unexplained or unauthorized changes in plist files indicating obfuscation attempts. Additionally, escalation is needed if there are signs of hidden VNC sessions, especially if combined with other indicators of malicious activity. |
| Additional Analysis Steps for L1 | Review recent process executions using central logging solutions. Verify whether the use of hidden windows aligns with known and legitimate administrative activities. Cross-reference suspicious activity with network traffic logs to identify any corresponding suspicious communication patterns. |
| T2 Analyst Actions | Perform a deeper forensic analysis of the endpoint to confirm the presence of hidden applications or desktops. Analyze system and application logs in detail to trace the origin of the hidden processes. Check for known or common adversary techniques that align with the use of hidden windows. Utilize threat intelligence resources to determine if there are any known campaigns using similar TTPs. |
| Containment and Further Analysis | Isolate the affected endpoint to prevent further adversarial actions. If hidden windows or desktops are confirmed, terminate the associated processes. Conduct a comprehensive investigation to understand the scope of the compromise, including the potential for lateral movement or data exfiltration. Based on findings, perform a system integrity check and consider restoring the system to a secure state using clean backups. |
