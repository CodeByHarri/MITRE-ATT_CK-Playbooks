# Subvert_Trust_Controls:_Install_Root_Certificate - T1553004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1553.004 |
| MITRE Sub-TTP | T1553.004 |
| Name | Subvert Trust Controls: Install Root Certificate |
| Log Sources to Investigate | Monitor security event logs and system change logs related to certificate installation. Examples include Windows Event Logs such as 'Microsoft-Windows-CertificateServicesClient' Operational log, which may show certificate-related activities. On macOS, the Console application or system logs located at '/var/log/system.log' could reveal installation of a trusted root certificate. Network logs and Web Proxy logs can be useful to check for connections to known malicious IP addresses or domains frequently using non-standard ports for HTTPS communication. Utilize Antivirus/Endpoint Detection and Response (EDR) logs for indications of malicious activity relating to certificate management tools. |
| Key Indicators | Unusual or unauthorized installation of root certificates, especially from non-standard paths. Log entries showing the use of certificate management commands, like '/usr/bin/security add-trusted-cert' on macOS. Network traffic to unexpected domains/IP addresses over port 443 (HTTPS), particularly if these destinations are newly observed or have a bad reputation. System changes shortly before or after certificate installation that indicate suspicious behavior or persistence attempts. |
| Questions for Analysis | Are there any known legitimate reasons for the recent addition of a root certificate on the system? Does the certificate appear on any lists of known malicious or suspicious certificates? Was the certificate installation event closely associated with login attempts on browsers or applications not typically used by the user? Have there been any alerts raised by antivirus or EDR solutions regarding certificate tools usage? |
| Decision for Escalation | Escalate to Tier 2 if the root certificate installation was not authorized and matches known malicious certificates. Escalate if the certificate chain links back to suspicious or untrusted certificates, or if associated network activity involves high-risk domains. Additionally, escalate if there are signs of a possible Adversary-in-the-Middle (AitM) attack or if there is repeated installation of certificates on various systems in the network. |
| Additional Analysis Steps for L1 | Verify with system owners or administrators whether the root certificate installation was authorized. Check for recent system updates or installed software that might coincide with the certificate installation. Cross-reference any related alerts or indicators with threat intelligence databases to assess known threats. Look for any other suspicious or unexpected changes in system settings or application configurations coinciding with the event. |
| T2 Analyst Actions | Perform a detailed examination of the certificate and its chain to ascertain trustworthiness. Use threat intelligence sources to analyze the destination domains or IP addresses being contacted after certificate installation. Investigate any potential lateral movement within the network that could stem from this action. Assess system integrity for signs of compromise or persistence techniques being implemented. Collaborate with IT to obtain a list of legitimate root certificates for comparative analysis. |
| Containment and Further Analysis | Quarantine the affected system to prevent potential data loss or further compromise. Revoke any suspicious certificates, and if needed, replace them with legitimate ones. Conduct a broader network sweep for other instances of the same certificate to determine the scale of the breach. Remove or disable any tools or scripts involved in the unauthorized certificate installation. Collect forensic data for further investigation and evidence preservation. |
