# File_and_Directory_Permissions_Modification:_Linux_and_Mac_File_and_Directory_Permissions_Modification - T1222002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1222.002 |
| MITRE Sub-TTP | T1222.002 |
| Name | File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification |
| Log Sources to Investigate | Monitor logs from Linux auditd, macOS's unified logging or any endpoint detection and response (EDR) tools that capture file and directory changes. Focus on events related to the use of 'chmod' and 'chown' commands. Relevant log files may include /var/log/auth.log, /var/log/secure, and specific logs for file permission changes at /var/log/audit.log on Linux systems. For macOS systems, review logs available through the Console app that track filesystem events. |
| Key Indicators | Look for the execution of 'chmod' and 'chown' commands, particularly by non-administrative users, or outside of normal operational windows. Alerts can be set for instances where files or directories inside critical folders (e.g., /etc/, /usr/, /var/, ~/.bashrc, ~/.zshrc) are modified. Additionally, unauthorized users becoming owners of system files or directories should be flagged. Command occurrences with unusual or sensitive file paths and sudden permission changes in quick succession are telltale signs. |
| Questions for Analysis | 1. Does the user account have a legitimate reason for modifying file or directory permissions?<br>2. Is the 'chmod' or 'chown' command being executed during normal operational hours or by an authorized user?<br>3. Are there concurrent or preceding suspicious activities logged for this user or system? 4. Is the modified file or directory part of typical user activities? |
| Decision for Escalation | Escalate if: 1. Permissions changes involve critical system files or directories like /etc/passwd, /bin/bash, etc.<br>2. Changes were made by a user account that has exhibited other suspicious behaviors recently.<br>3. Unexpected changes occur in high-value target paths or sensitive configuration files. 4. Commands executed do not correlate with a legitimate change request or operational need. |
| Additional Analysis Steps for L1 | 1. Verify the user account activity logs around the time of the permission changes.<br>2. Check for recent login attempts and any anomalies in access patterns.<br>3. Investigate if there are any pending or completed change requests related to the modified files/directories. 4. Confirm whether the user is part of any active IT projects that could necessitate such modifications. |
| T2 Analyst Actions | 1. Conduct a more in-depth audit of the system based on user history and activity.<br>2. Cross-reference user's access requests and executed commands with change management logs.<br>3. Look for correlated suspicious activities involving the same user or endpoint, including remote access, command execution patterns, or unauthorized software installations. 4. Analyze the system for any signs of persistence mechanisms and lateral movement attempts. |
| Containment and Further Analysis | 1. Consider isolating the affected system if itâ€™s determined that unauthorized access has likely occurred.<br>2. Revert file permissions to the last known good state using backups or configuration management tools.<br>3. Conduct a forensic analysis of the system to determine the extent of exploitation. 4. Review and tighten current file permission policies and access controls to prevent recurrence. Additionally, ensure that all patches and updates are applied to maintain the security posture. |
