# Hide_Artifacts:_Hidden_Users - T1564002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1564.002 |
| MITRE Sub-TTP | T1564.002 |
| Name | Hide Artifacts: Hidden Users |
| Log Sources to Investigate | Investigate logs from macOS, Windows, and Linux systems for evidence of user manipulation. On macOS, check plist file changes under /Library/Preferences/com.apple.loginwindow, file attribute modifications, and command line history for the dscl and chflags commands. For Windows, review the Registry changes particularly under HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList. Analyze recent Registry writes or changes through Windows Event Logs (Event ID 4657). On Linux, monitor changes in Display Manager settings, especially using the gsettings command on Ubuntu systems or other equivalent commands for different Display Managers. |
| Key Indicators | Creation or modification of user accounts with userID under 500 in macOS. Changes in the IsHidden attribute in account settings or home folder attribute changes using chflags on macOS. Registry modifications in the UserList Registry key setting user value to 0 on Windows systems. Unusual gsettings command execution on Linux systems to hide user accounts in GUI login screens. Unexplained creation or modification of user-related plist files. |
| Questions for Analysis | Are there any legitimate administrative activities scheduled or performed? Have any new software installations or updates occurred around the time of detected activity? Are there any existing known good configurations or baselines that indicate hidden users? Is there any related suspicious activity, such as privilege escalation or unusual network connections? |
| Decision for Escalation | Escalate to Tier 2 if there is any unexplained creation, modification, or deletion of user accounts, especially if associated with hidden user attributes or if detected on sensitive systems. Escalate when there is a lack of legitimate justification for changes or if associated with other suspect activities. Escalate if similar patterns are observed across multiple systems or environments, indicating coordinated activity. |
| Additional Analysis Steps for L1 | Verify the legitimacy of system administrators who might have made the changes. Review past user account activities and changes for context. Correlate user account changes with other system activities to identify any resultant unauthorized access or anomalies. Examine audit logs for execution of relevant commands like dscl, chflags, and registry modifications. |
| T2 Analyst Actions | Conduct a deeper forensic analysis on affected systems, focusing on additional file system changes, process executions, and network activity around the time of the detected changes. Confirm whether the changes correlate with any known threat actor TTPs. Use threat intelligence databases to match patterns or keywords related to the hidden user account techniques. |
| Containment and Further Analysis | Quarantine affected systems to prevent further unauthorized access. Remediate by reversing unauthorized account changes and review security configurations. Strengthen monitoring on similar systems against known indicators. Perform a full network scan to detect any other systems potentially impacted by the same activity. Conclude with a security review, update user account policies, and retrain administrative personnel on secure practices. |
