# Hijack_Execution_Flow:_Executable_Installer_File_Permissions_Weakness - T1574005

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Persistence, Privilege Escalation |
| MITRE TTP | T1574.005 |
| MITRE Sub-TTP | T1574.005 |
| Name | Hijack Execution Flow: Executable Installer File Permissions Weakness |
| Log Sources to Investigate | Review logs from System Event Logs, Application Event Logs, and Security Event Logs, focusing on events related to file modifications or creations in the %TEMP% directory during installation phases. Consider monitoring process execution logs (such as Sysmon) to identify processes executed from the %TEMP% directory. Regular file integrity monitoring (FIM) solutions can also help detect unauthorized changes to installer files or directories. |
| Key Indicators | Detection of unexpected file creations or modifications within %TEMP% directories during software installations, especially if the changes occur to executables (EXE) or dynamic link libraries (DLL). Unusual process execution patterns where processes are spawned from non-standard paths like %TEMP%. Changes to permissions or attempts to overwrite executables in directories created by installers. |
| Questions for Analysis | 1. Are there any recent incidents of unusual file modifications or process executions originating from the %TEMP% directory?<br>2. Are there specific installer logs or events that corroborate the execution or modification of binaries during installation that appear suspicious?<br>3. Is there a history of these types of anomalies associated with other potentially legitimate processes or user actions? |
| Decision for Escalation | Escalate to Tier 2 if there is evidence of unauthorized changes to executable files within the %TEMP% directory during installation processes, especially if binary execution follows. Also, escalate if suspicious privilege escalation attempts are identified or if there's an observed pattern of DLL search order hijacking. |
| Additional Analysis Steps for L1 | Verify the installations in question against known software deployment schedules or incidents. Cross-reference with known safe hashes or digital signatures of legitimate binaries to verify potential tampering. Assess user roles and permissions to identify potential privilege escalation activities. |
| T2 Analyst Actions | Conduct a deeper forensic analysis on the affected system, capturing a snapshot of running processes and analyzing memory to identify malicious code. Use threat intelligence feeds to check if the identified hashes relate to known malicious binaries. Investigate any associated undetected attack vectors, such as lateral movement or persistence mechanisms, within the network. |
| Containment and Further Analysis | Isolate affected systems immediately to prevent further execution of potentially malicious code. Use endpoint protection tools to quarantine malicious binaries and repair compromised installer files. Conduct a thorough audit of the systems involved to ensure no persistent footholds or lingering effects remain. Follow up by ensuring all security patches are applied, and permissions for critical directories are reviewed and implemented as per company policy. |
