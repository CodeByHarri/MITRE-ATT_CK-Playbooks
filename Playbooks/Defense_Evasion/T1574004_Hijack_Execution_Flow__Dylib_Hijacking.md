# Hijack_Execution_Flow:_Dylib_Hijacking - T1574004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Persistence, Privilege Escalation |
| MITRE TTP | T1574.004 |
| MITRE Sub-TTP | T1574.004 |
| Name | Hijack Execution Flow: Dylib Hijacking |
| Log Sources to Investigate | Monitor logs from macOS library loading events, particularly focusing on audit logs and system logs that show dynamic library load activities. Use Endpoint Detection and Response (EDR) tools tailored for macOS, such as Jamf Protect or CrowdStrike, to detect abnormal dylib load events. Leverage file integrity monitoring on directories where dylibs are typically placed to capture unauthorized changes. Check process execution logs for suspicious loading of dylibs. |
| Key Indicators | Unexpected dylib files appearing in directories commonly used by known applications. Dylibs with suspicious or uncommon names, especially those matching missing dylibs specified by legitimate applications. Unusual process paths or execution patterns, such as legitimate applications loading unexpected libraries. Detection of weak linking events (e.g., use of LC_LOAD_WEAK_DYLIB) which can indicate attempted exploitation via missing libraries. |
| Questions for Analysis | Is the dylib in question part of an unapproved software package? Has this dylib been loaded by any high-privilege applications? Does the dylib’s path hint at use of weak linking? Are there logs of similar dylib loads in short succession, suggesting automated deployment? Do user activities align with the time and context of the dylib load? |
| Decision for Escalation | Escalate to Tier 2 if any loaded dylib is confirmed as unauthorized by security policies, is loaded by a high-privilege process, or if there's evidence of lateral movement or potential privilege escalation. Also escalate if there is any indication that the dylib is communicating over the network without a clear reason. |
| Additional Analysis Steps for L1 | Perform basic file analysis on the suspicious dylib, including checking its hash against virus databases and reviewing its creation/modification dates. Compare the dylib’s expected path and name against the application's known dependency list. Verify if user behaviors match the application use around the time of dylib loading. Review historical logs to see if similar dylib patterns were detected. |
| T2 Analyst Actions | Conduct deeper static and dynamic analysis of the suspect dylib to uncover encoded functions or malicious capabilities. Determine if the dylib is part of a larger infection chain by correlating with other anomalous activities or logs. Investigate related processes to assess what privileges were granted and what system resources were accessed. Use threat intelligence to map out potential adversaries or threat actors historically leveraging dylib hijacking. |
| Containment and Further Analysis | Immediately quarantine the machine if the dylib is confirmed as malicious, and block execution of the application suspected of loading it. Clean or remove the malicious dylib and any associated processes or files. Run a full anti-malware scan to detect additional threats. Update security policies and monitoring to detect any recurrence of similar behaviors. Report and share findings with the organization’s security incident response team to update defenses and preventive measures. |
