# System_Script_Proxy_Execution - T1216

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1216 |
| MITRE Sub-TTP | T1216 |
| Name | System Script Proxy Execution |
| Log Sources to Investigate | Monitor logs from the Windows Event Log, specifically the Security, Application, and PowerShell event logs. Pay special attention to events related to script execution, such as Event ID 4688 (Process Creation) and Event ID 4104 (PowerShell Script Execution). Also, examine any logs from Host-based Intrusion Detection Systems (HIDS) and Endpoint Detection and Response (EDR) platforms for suspicious script execution activity. For example, scrutinize logs for signs of Office applications launching scripts or abnormal network activity following script execution. |
| Key Indicators | Look for execution of scripts like mshta.exe, wscript.exe, cscript.exe, or other Microsoft-signed scripts that make network requests or launch additional processes. Indicators include unusual command-line arguments such as those ending in .js, .vbs, or .hta, or references to external URLs. Also note any execution by Service Host processes or unexpected parent-child process relationships (e.g., Excel.exe spawning a script interpreter). |
| Questions for Analysis | Did the script originate from a trusted source? Is the command line execution typical for the user or system? Are there any associated network connections to known malicious IP addresses or domains? Is there a known pattern of this kind of execution in the current environment? Are there any related alerts or indicators from AV or other threat detection systems? |
| Decision for Escalation | Escalate to Tier 2 if the script execution is not part of normal business processes, especially if associated with network connections to potentially malicious domains or if multiple systems are showing this behavior. Also escalate if the process relationships are indicative of known attack patterns or if the user context of the execution is unusual, such as happening under a service account. |
| Additional Analysis Steps for L1 | Validate the script's source and integrity. Check for known file hashes in threat intelligence feeds. Cross-reference alerts with any available threat intelligence. Check for lateral movement or additional signs of compromise on the system or network. Document findings thoroughly. |
| T2 Analyst Actions | Perform deep dive analysis of the suspicious scripts and processes identified. Use threat intelligence to verify if the script or its behavior has been associated with known threats or campaigns. Analyze network traffic patterns for anomalies that coincide with the script execution. Correlate with logs from related systems or endpoints to map potential propagation paths. If the activity is confirmed as malicious, provide a detailed incident report for further containment and eradication measures. |
| Containment and Further Analysis | Isolate the affected systems from the network. Investigate and remove persistent mechanisms, such as registry entries or scheduled tasks. Conduct a comprehensive scan to identify and remove any remnants of the malicious activity. Review firewall and IDS/IPS logs for signs of related network traffic and update rules to prevent further exploitation. Engage with incident response teams if the activity suggests a broader intrusion or if sensitive data may be at risk. Establish monitoring for similar TTP patterns to prevent recurrence. |
