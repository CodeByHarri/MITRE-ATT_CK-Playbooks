# Modify_System_Image:_Patch_System_Image - T1601001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1601.001 |
| MITRE Sub-TTP | T1601.001 |
| Name | Modify System Image: Patch System Image |
| Log Sources to Investigate | Network device configuration logs, system event logs, and access logs should be reviewed. Specific log sources include: <br>- System event logs detailing changes or errors in OS boot processes. <br>- Configuration change logs indicating updates to the system image. <br>- Network traffic logs capturing protocols like TFTP, FTP, and SCP for unusual data transfers. <br>- Authentication logs showing administrative access, especially during times when suspected changes occurred. <br>Example logs: <br>- IOS syslogs showing boot or ROMMON messages.<br>- Network intrusion detection systems (NIDS) monitoring for anomalous network device activities. |
| Key Indicators | Key indicators include: <br>- Unusual or unauthorized uploads of system images via TFTP, FTP, SCP. <br>- Changes in boot configuration pointing to different system images. <br>- Use of debug commands by unauthorized users, which indicates possible tampering. <br>- Modified or unexpected system version numbers in device logs. <br>- Network traffic towards known TFTP/FTP servers not typically used by the organization. |
| Questions for Analysis | 1. Was there an authorized schedule for image updates on the network devices?<br>2. Who last accessed the administrative settings of the network device, and were they authorized?<br>3. Are there any discrepancies in version numbers, and do they correlate with known updates?<br>4. Has there been a recent spike in network traffic involving the downloading/uploading of large files?<br>5. Are there any error or warning messages in the logs indicating bootloader or memory modification attempts? |
| Decision for Escalation | The situation should be escalated to Tier 2 if: <br>- Unauthorized access to network device management interfaces is detected.<br>- Suspicious or unauthorized file transfers of system images are logged.<br>- There is evidence of boot loader tampering or debug command usage by non-administrators.<br>- Any modification attempts on the operating system in memory or storage are suspected based on log anomalies. |
| Additional Analysis Steps for L1 | 1. Review logs for recent changes in device configuration or installed system images. <br>2. Correlate timestamps of configuration changes with user access logs to validate authorized changes. <br>3. Cross-check network traffic logs for unusual patterns or destinations associated with file transfer activities. |
| T2 Analyst Actions | 1. Deep-dive into access logs for detailed events around the suspected change times. <br>2. Utilize forensic tools to verify the integrity of system images on affected devices. <br>3. Assess network traffic patterns for potential exfiltration or unauthorized access to critical infrastructure. <br>4. Collaborate with network administrators to confirm the legitimacy of system images and configurations. |
| Containment and Further Analysis | 1. If unauthorized image changes are confirmed, isolate affected devices from the network to prevent further exploitation. <br>2. Restore network devices with known good configurations and verified system images. <br>3. Increase monitoring on critical network segments to detect similar activities. <br>4. Perform a full audit of all network devices and implement additional security measures like access controls and encrypted communications. |
