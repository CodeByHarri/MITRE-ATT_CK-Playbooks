# Abuse_Elevation_Control_Mechanism:_Elevated_Execution_with_Prompt - T1548004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Privilege Escalation |
| MITRE TTP | T1548.004 |
| MITRE Sub-TTP | T1548.004 |
| Name | Abuse Elevation Control Mechanism: Elevated Execution with Prompt |
| Log Sources to Investigate | Monitor logs related to macOS system events, particularly those involving execution of processes with elevated privileges. Security logs capturing authentication attempts and audit logs for process execution can be crucial. Specifically, review logs for 'AuthorizationExecuteWithPrivileges' API calls, System Integrity Protection logs, and security auditing logs which might show process creation events linked with elevated permissions. Examples include macOS Console logs or unified logging system queries with filters for privilege escalation attempts. |
| Key Indicators | Unusual use of the 'AuthorizationExecuteWithPrivileges' API, especially from non-standard applications or scripts. Logs showing attempts to execute or install software requiring elevated privileges from an unrecognized source. Authentication prompts related to privilege escalation that occur at unusual times or outside normal update/install scopes. Unexpected modifications to writable files or directories used by applications that typically utilize this API. |
| Questions for Analysis | Are there legitimate applications on the system known to utilize 'AuthorizationExecuteWithPrivileges'? Has this API been called by trusted or expected programs? Is there evidence of masquerading, such as processes or binaries with uncommon or misleading names? Are the privilege escalation attempts consistent with normal user activity, such as software installations or updates that the user planned? |
| Decision for Escalation | Escalate to Tier 2 if 'AuthorizationExecuteWithPrivileges' is used by unrecognized or suspicious software, if there are unexplained changes to permissions or writable files, or if the timing and context of the authentication prompt do not align with legitimate user behavior. Any signs of masquerading should also warrant escalation. |
| Additional Analysis Steps for L1 | Examine the context of the API call by checking associated process names, hashes, and paths for legitimacy. Cross-reference with known legitimate software and scheduled tasks to confirm if the API use is expected. Review the timing and frequency of privilege escalation prompts against normal user activity patterns. |
| T2 Analyst Actions | Carry out a more detailed investigation of the process context and origin, including checking file integrity against known good versions. Verify the digital signatures of binaries involved and assess any modified writable files potentially exploited. Conduct threat intelligence gathering on any suspicious process or file identified to assess its popularity and association with malware campaigns. |
| Containment and Further Analysis | Quarantine affected systems if unauthorized use of 'AuthorizationExecuteWithPrivileges' is confirmed. Remove any malicious software installed via this method. Strengthen credential policies to reduce misuse of elevated privileges. Consider employing additional endpoint detection and response (EDR) solutions capable of more granular monitoring and alerting for privilege escalation activities. Conduct a full review of systems logs to identify any lateral movement or further indicators of compromise associated with initial privilege escalation. |
