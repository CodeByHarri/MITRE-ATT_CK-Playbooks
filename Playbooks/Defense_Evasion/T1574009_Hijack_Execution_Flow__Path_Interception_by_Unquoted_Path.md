# Hijack_Execution_Flow:_Path_Interception_by_Unquoted_Path - T1574009

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Persistence, Privilege Escalation |
| MITRE TTP | T1574.009 |
| MITRE Sub-TTP | T1574.009 |
| Name | Hijack Execution Flow: Path Interception by Unquoted Path |
| Log Sources to Investigate | Monitor Windows Event Logs for process creation events, particularly Event ID 4688, where new processes are started. Check for command lines that include paths with spaces that are not quoted. Review the Registry key modifications for keys associated with services (HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services) and shortcut (.lnk) files in user profiles or common start menu locations. File system activity logs that show unexpected or unknown executables being placed in directories such as C:\ or other higher-level directories within application paths are also critical. |
| Key Indicators | Presence of executable files in directories like C:\ or other unexpected locations. Paths in process creation logs that are unquoted and have spaces, such as C:\program files\application.exe. Changes to service paths or shortcuts in the Windows Registry that show unquoted paths. Recently created or modified executables in common path interception locations. |
| Questions for Analysis | Is there a legitimate reason for this executable to be located in this high-level directory? Are there any known software installations or updates that align with the creation or modification of these files? Do the files in question match known hashes of existing legitimate applications? Have there been any recent alerts or incidents involving the same path or executable? |
| Decision for Escalation | Escalate to Tier 2 if there are unquoted paths found associated with critical system services or regularly used applications, if there are unknown executables in interception-prone directories, or if there are anomalous process creations tied to high-risk users or systems. |
| Additional Analysis Steps for L1 | Investigate recent process creation logs for patterns, particularly focusing on the initial directory where the executable is located. Review alerts for any known malicious hash matches. Cross-reference with user activity logs to identify any unusual access or actions leading up to the event. Check the system for recent changes in executables or executables with recent compile dates. |
| T2 Analyst Actions | Conduct a deeper inspection of the suspicious executable using tools like VirusTotal, looking for known IOC matches. Review the full context of the application or service configuration that was potentially intercepted. Determine whether the executable path or configuration change aligns with legitimate administration or deployment actions. Assess if any originally intended executables were either blocked or replaced. |
| Containment and Further Analysis | If identified as malicious, isolate the affected system immediately to prevent further execution of the malicious executable. Restore any altered service or shortcut configurations to their original state. Conduct a threat hunt on other systems to ensure no widespread exploitation of unquoted paths. Provide recommendations for securing path settings, such as ensuring critical services and shortcuts are quoted. |
