# Template_Injection - T1221

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1221 |
| MITRE Sub-TTP | T1221 |
| Name | Template Injection |
| Log Sources to Investigate | Investigate logs from endpoint detection and response (EDR) solutions that might capture suspicious document activity, particularly involving file formats such as .docx, .xlsx, .pptx, and .rtf. Monitor web proxy and firewall logs for unusual or suspicious outbound requests made by office applications to external URLs. Look into LDAP and authentication server logs for anomalous authentication attempts that could indicate forced authentication events. Consider reviewing file integrity monitoring (FIM) logs for unexpected modifications in known safe templates. |
| Key Indicators | Presence of documents with embedded external URL references in template fields. Network activity logs showing Office application making outbound HTTP/HTTPS/SMB requests. Unusually crafted or malformed .rtf or OOXML files possessing template references. Unexpected or failed authentication attempts linked with document-opening actions. Office documents initiating uncommon network traffic upon being opened. |
| Questions for Analysis | Is there a known legitimate business reason for the document's external URL references? Do the external URLs resolved from Office documents match trusted or known domains? Is the observed behavior (e.g., network requests) typical for the user's profile or environment? Have similar document patterns been seen across other users or systems, indicating potential broader distribution? |
| Decision for Escalation | Escalate to Tier 2 if the document contains external template references to unfamiliar or known malicious domains. Escalate if multiple failed authentication attempts are initiated after opening specific documents. Escalate when an anomalously high number of users report receiving or interacting with documents exhibiting similar behaviors. |
| Additional Analysis Steps for L1 | Verify the hash of the suspicious document against known threat databases. Check if the document is part of a larger campaign by examining email headers or original delivery methods. Investigate the external URLs referenced within the document to ascertain their legitimacy using threat intelligence resources. Identify and document patterns of users targeted with similar documents. |
| T2 Analyst Actions | Perform a reverse engineering analysis on the document to uncover any embedded exploits or payloads. Analyze the network traffic generated by opening the document to ascertain the full scope of communication. Correlate authentication logs with document access to evaluate any successful credential harvesting attempts. Review similar cases within the threat intelligence database to provide context or further investigative leads. |
| Containment and Further Analysis | Isolate affected systems from the network to prevent further malicious communication. Notify users and advise them on safe practices regarding document handling. Use endpoint security solutions to remove or quarantine any identified malicious files. Conduct a complete forensic analysis on affected machines to check for any persistent threats. Review patch management procedures and ensure all application software is up to date to prevent exploitation through known vulnerabilities. |
