# System_Binary_Proxy_Execution:_InstallUtil - T1218004

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1218.004 |
| MITRE Sub-TTP | T1218.004 |
| Name | System Binary Proxy Execution: InstallUtil |
| Log Sources to Investigate | To investigate the use of InstallUtil, examine the following log sources: <br>1. Windows Security Event Logs: Check events associated with process creation (Event ID 4688) to identify executions of 'InstallUtil.exe'. <br>2. Sysmon Logs: Look for Sysmon Event ID 1 (Process creation) that logs full command-line details of 'InstallUtil.exe' invocation. <br>3. PowerShell Logs: Though InstallUtil is not directly related to PowerShell, adversaries may use scripts for invocation. Check Module logs (4103) and Script Block Logging (4104).<br>4. Application Control Logs: Investigate logs from tools like Microsoft Defender Application Control or AppLocker for any application control bypass attempts related to 'InstallUtil.exe'.<br>5. Endpoint Detection and Response (EDR) solutions: Monitor for behaviors indicating 'InstallUtil.exe' execution and binary signatures. |
| Key Indicators | Key indicators of suspicious InstallUtil activity include: <br>1. Execution of 'InstallUtil.exe' from uncommon directories or with unusual parameters.<br>2. Presence of '.NET' binaries not typically associated with standard installations.<br>3. Use of '[System.ComponentModel.RunInstaller(true)]' attributes in binary components.<br>4. Abnormal child processes spawned by 'InstallUtil.exe'.<br>5. Network activity or attempts to execute InstallUtil correlated with user logon events unusual for that user or system. |
| Questions for Analysis | 1. Is 'InstallUtil.exe' being executed from its typical .NET framework directories?<br>2. Are there any unusual command-line arguments or parameters used with 'InstallUtil.exe' execution?<br>3. Did 'InstallUtil.exe' spawn any suspicious child processes or network connections?<br>4. Is there historical context of 'InstallUtil.exe' usage on this endpoint or by this user?<br>5. How does the timing of 'InstallUtil.exe' execution correlate with legitimate user activity or maintenance periods? |
| Decision for Escalation | Escalate to Tier 2 if:<br>1. 'InstallUtil.exe' is executed from unusual locations or with suspicious parameters that indicate evasion attempts.<br>2. Abnormal or unknown child processes are spawned by 'InstallUtil.exe'.<br>3. The originating user or system does not typically run installer utilities.<br>4. Detected use aligns with recent changes or suspicious network activity, especially if lateral movement or data exfiltration is indicated. |
| Additional Analysis Steps for L1 | 1. Verify the legitimacy of the 'InstallUtil.exe' executing user by checking user profiles and login history.<br>2. Correlate 'InstallUtil' execution with other security alerts or anomalous network activity.<br>3. Check for any related file modifications or access to sensitive directories.<br>4. Consult known safe lists to ensure actions are part of expected and documented change management. |
| T2 Analyst Actions | 1. Conduct a deeper analysis on the 'InstallUtil.exe' execution pattern, and compare it against baseline behavior metrics.<br>2. Conduct memory analysis if the binary was executed with suspicious parameters.<br>3. Utilize threat intelligence to cross-reference binaries or hashes with known malicious signatures.<br>4. Engage with the system owner and validate any legitimate usage of 'InstallUtil.exe'. Ensure completion of incident documentation for further analysis. |
| Containment and Further Analysis | 1. Quarantine the affected system to prevent potential further lateral movements.<br>2. Initiate a forensic analysis on the system for signs of persistence mechanisms or indicators of compromise.<br>3. Update detection mechanisms to better capture similar indicators in the future.<br>4. Communicate with the IT team to address any potential vulnerabilities or policy violations allowing for such execution. |
