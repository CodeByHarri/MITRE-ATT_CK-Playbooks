# Obfuscated_Files_or_Information:_LNK_Icon_Smuggling - T1027012

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1027.012 |
| MITRE Sub-TTP | T1027.012 |
| Name | Obfuscated Files or Information: LNK Icon Smuggling |
| Log Sources to Investigate | Investigate logs related to file creations and modifications, such as EDR logs showcasing .LNK file activities. Network logs should be scrutinized for unusual outbound URLs or traffic patterns, particularly those attempting to reach external IPs or domains often used in phishing campaigns. Additionally, inspect Windows Event Logs for process execution details and any shell invocations that might suggest an LNK file operation. Example log sources include Sysmon logs for process creation (Event ID 1) and file creation (Event ID 11) events, and security event logs that may indicate suspicious PowerShell executions (Event IDs 4103, 4104). |
| Key Indicators | Unusual .LNK file creations, especially in non-standard directories or associated with suspect email attachments. URLs or IP addresses referenced in the icon location field of LNK files pointing to unfamiliar domains. Processes invoking LNK files, particularly powershell.exe, cmd.exe, or mshta.exe, that might indicate attempts to download and execute external content. Investigate any anomalies in network traffic patterns, such as data exfiltration indications or connections to known malicious sites. |
| Questions for Analysis | Is there a sudden increase in .LNK file activity on the network? Do the LNK files reference external URLs in their icon location field? Are the external URLs or IP addresses recognized as malicious or associated with prior suspicious activity? Is the execution of LNK files linked with known system vulnerabilities or exploits in current use? Are there discernible patterns of concurrent use of scripting interpreters post-LNK execution? |
| Decision for Escalation | Escalate to Tier 2 if the LNK files reference well-known malicious URLs or domains, if there is evidence of communication with a command and control server, or if the behavior exhibits strong correlation with known attack patterns. Escalate if LNK execution is linked to credential dumping or privilege escalation attempts indicating potential lateral movement. |
| Additional Analysis Steps for L1 | Review any incident ticket data correlating to .LNK file threats. Collect and analyze associated traffic logs for associated IPs and domains. Validate the hash of any suspicious LNK file against threat intelligence sources to check for known malicious indicators. Use sandbox environments to test LNK file behaviors in a controlled setting if feasible. Survey endpoints for indicators of tampered or modified .LNK files using endpoint security solutions. |
| T2 Analyst Actions | Perform a comprehensive threat intelligence lookup of URLs or domains referenced in LNK icon fields. Analyze historical data to identify patterns or previous occurrences of similar activities. Conduct deeper investigation into endpoint behaviors focusing on EDR data around the time of LNK executions. Investigate any associated suspicious scripts or executables that might have been downloaded as a result of LNK file execution. |
| Containment and Further Analysis | Isolate affected systems from the network to prevent further malicious activities. Perform endpoint scans to ensure no additional malicious payloads have been deployed. Use incident response tools to delete or disable malicious LNK files discovered. Conduct thorough host-based forensics to ascertain data access and exfiltration. Coordinate with threat intelligence resources to maintain updated indicators of compromise and inform broader security teams. |
