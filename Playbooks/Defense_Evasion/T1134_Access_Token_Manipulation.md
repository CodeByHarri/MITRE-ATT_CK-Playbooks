# Access_Token_Manipulation - T1134

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Privilege Escalation |
| MITRE TTP | T1134 |
| MITRE Sub-TTP | T1134 |
| Name | Access Token Manipulation |
| Log Sources to Investigate | Investigate Windows Security Event Logs, particularly events related to access token operations like Event ID 4672 (Special privileges assigned to a new logon) and Event ID 4648 (A logon was attempted using explicit credentials). Check process creation logs, such as Event ID 4688 (A new process has been created), to detect unusual parent-child process relationships or processes spawned with different user contexts. Examine authentication logs and remote access logs for any anomalies in user authentication or unusual patterns of account logins. |
| Key Indicators | Look for processes being executed under a different user context than the original parent process, especially SYSTEM or other high-privilege accounts. Monitor for the use of tools or commands like 'runas', 'token impersonation' libraries, or any exploitation of Windows API functions related to token manipulations such as OpenProcessToken, DuplicateTokenEx, or SetThreadToken. |
| Questions for Analysis | Are there processes running under unexpected user contexts? Are there any cases where a non-admin account is performing actions that require administrative privileges? Is there evidence of unusual command-line usage related to 'runas' or token manipulation? Are there repeated failed attempts to access tokens, indicating trial and error activity? |
| Decision for Escalation | Escalate to Tier 2 if there is confirmed evidence of access token manipulation, especially if adversary-used tools or unsanctioned API calls are detected that are consistent with known TTPs around token stealing. Escalate if SYSTEM-level processes are spawned from non-SYSTEM parent processes without legitimate justification. |
| Additional Analysis Steps for L1 | Correlate findings with asset criticality; prioritize tokens associated with high-value or sensitive systems. Check for any concurrent or resultant suspicious activities such as lateral movement attempts or privilege escalation. Review historical logs for patterns of similar activity. |
| T2 Analyst Actions | Forensic analysis of systems where token manipulation is detected, including memory dumps to identify tools or scripts used in manipulation. Closely inspect network traffic for exfiltration or communication with known C2 servers. Validate detections against threat intelligence to ascertain the likelihood of compromise and correlate with other ongoing or recent suspicious activities in the network. |
| Containment and Further Analysis | Immediately isolate affected systems from the network to prevent lateral movement or further system compromise. Reset credentials or tokens that may have been compromised, especially for administrative or privileged accounts. Conduct a thorough review and clean-up of access control configurations across affected systems, and conduct a full malware scan to identify any persistence mechanisms employed by the adversary. Post-incident, review and harden token management practices, and deploy enhanced monitoring for similar activities. |
