# Masquerading:_Rename_System_Utilities - T1036003

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1036.003 |
| MITRE Sub-TTP | T1036.003 |
| Name | Masquerading: Rename System Utilities |
| Log Sources to Investigate | Investigate logs from Windows Event Logs, specifically `Security` and `System` logs, as well as Application logs for any anomalies. Use logging from process monitoring tools like Sysmon for event IDs related to process creation (Event ID 1), image load (Event ID 7), and file creation (Event ID 11). Additionally, review PowerShell script block logging and command line auditing for unusual command lines. Endpoint Detection and Response (EDR) logs can provide insights into suspicious process behaviors and utility usage. |
| Key Indicators | Look for instances of common system utilities such as `rundll32.exe`, `cmd.exe`, `powershell.exe`, `regsvr32.exe` being launched with unexpected or obscure names. Also, monitor for file creation of renamed utilities in non-standard directories. Check for process execution from user directories or temporary directories which are uncommon for system utilities. |
| Questions for Analysis | 1. Is the renamed utility executing from a non-standard path?<br>2. Are there preceding events indicating a file operation like a move or rename involving system utilities?<br>3. Are there accompanying suspicious network or registry activities by the renamed utility? 4. Has the process or filename been observed in past legitimate usage within the organization? |
| Decision for Escalation | Escalate to Tier 2 if the utility's renaming is associated with: 1. Execution from a non-standard directory, 2. Unusual privilege escalation attempts, 3. Network connections to known malicious or foreign IP addresses, 4. Absence of legitimate operational context or justification, 5. Correlation with multiple alerts or indicators of compromise. |
| Additional Analysis Steps for L1 | Verify if the renamed utility matches MD5/SHA256 hashes of known system utilities. Cross-reference with threat intelligence sources to check if the renamed utility name and path are known to be associated with malware or attack frameworks. Check user account activity associated with the execution of the process. |
| T2 Analyst Actions | Investigate deeper into the file's metadata, looking for discrepancies in file creation, modification times, and potential spoofing of legitimate file properties. Use additional EDR capabilities to analyze the behavior of the renamed utility post execution, focusing on new processes, threads, and network activity. Compare with baseline behavior for anomalies. |
| Containment and Further Analysis | Isolate the affected system to prevent further compromise. Use endpoint tools to terminate the suspicious process. Quarantine any newly created files correlating with the renamed utility. Conduct a thorough scan for other potential artifacts linked to this tactic, utilizing both automated and manual forensic techniques. Consider implementing YARA rules for detecting similar TTPs in the environment. Draft a report summarizing the incidentâ€™s impact and analysis for further review by threat intelligence and remediation teams. |
