# Hijack_Execution_Flow:_DLL_Search_Order_Hijacking - T1574001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion, Persistence, Privilege Escalation |
| MITRE TTP | T1574.001 |
| MITRE Sub-TTP | T1574.001 |
| Name | Hijack Execution Flow: DLL Search Order Hijacking |
| Log Sources to Investigate | Include Security Event Logs for process creation and module load events, such as Event ID 4688 (Process Creation) and Event ID 7 from Sysmon (Image loaded). Collect file auditing logs from directories where DLLs are commonly loaded, particularly the working directories of target applications. Monitor the Windows Registry for changes associated with DLL redirection. Network monitoring logs may also be useful for identifying remote loading attempts, especially in the context of a program setting its current directory to a remote location. Application logs from affected software may reveal abnormal behavior or errors related to DLL loading. |
| Key Indicators | Look for unusual or unauthorized DLL files in application directories or suspicious locations. Identify processes loading DLLs from unexpected directories, especially the current working directory of an application. Monitor for newly created or altered registry keys related to DLL redirection. Be aware of processes that exhibit unexpected behavior potentially indicative of privilege escalation, such as running with higher privileges than expected. |
| Questions for Analysis | Is the DLL located in a directory that is expected for its loading? Does the name or path of the DLL align with known legitimate files? Has there been any recent change in permissions or execution policies that might explain the loading from this directory? Are there any user or system behaviors that correlate with known malicious patterns? |
| Decision for Escalation | Escalate to Tier 2 if the DLL loads from non-standard directories, especially if coupled with privilege escalation indications. Significant registry changes related to DLL redirection warrant further investigation. Escalate if multiple systems exhibit similar suspicious DLL load behavior, suggesting a coordinated or widespread attack. |
| Additional Analysis Steps for L1 | Review the process tree and command-line arguments for unusual patterns. Check file hashes against threat intelligence feeds for known malicious files. Verify if the same DLL file is present and loading on multiple systems. Cross-reference file creation dates with known attack timelines. |
| T2 Analyst Actions | Conduct deeper analysis of the suspicious DLL file using reverse engineering or sandboxing to understand its behavior. Review system-wide logs for similar activities, potentially indicating lateral movement or further compromise. Engage in threat hunting activities across the network to identify other instances of the TTP. |
| Containment and Further Analysis | Isolate affected systems to prevent further lateral movement or escalation. Remove or rename suspicious DLLs from affected directories. Consider implementing Group Policy or execution policy changes to restrict DLL loading paths if feasible. Update affected applications and systems to mitigate the vulnerability facilitating the DLL hijacking. Coordinate with IT teams to patch potential DLL search order vulnerabilities. |
