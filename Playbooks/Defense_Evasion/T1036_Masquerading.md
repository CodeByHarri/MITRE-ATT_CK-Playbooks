# Masquerading - T1036

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1036 |
| MITRE Sub-TTP | T1036 |
| Name | Masquerading |
| Log Sources to Investigate | Investigate system logs, PowerShell logs, Application logs, and Endpoint Detection and Response (EDR) logs. Specifically, focus on process creation logs that include anomaly detections such as renamed executables, hash mismatches with known utilities, and execution logs of utilities that are not typical for the user or system. Also, monitor file access and file modification logs for discrepancies in file paths and file names that do not match their expected use cases. |
| Key Indicators | Key indicators include processes executed from unusual file paths, executables with known names but different hash values, execution of renamed system utilities, and the presence of known files or tasks with altered names indicative of masquerading. Also, look for manipulation of file metadata such as unexpected changes in file ownership, timestamps, and other attributes. |
| Questions for Analysis | 1. Is the renamed utility or file typically used by the department or application in question?<br>2. Are there any recent changes or updates that could explain the renaming or relocation of files or utilities?<br>3. Are multiple instances of system utilities running simultaneously, particularly from non-standard paths? 4. Is there any correlation with recent suspicious activity or alerts from other TTPs? |
| Decision for Escalation | Escalate to Tier 2 if renamed or relocated files/utilities correspond with known IOCs, if there is no legitimate explanation provided for file discrepancies, or if the activity correlates with other suspicious behavior or security alerts suggesting a potential breach. Also, escalate if there are indications of altered file metadata that do not align with expected security policies. |
| Additional Analysis Steps for L1 | Verify the file paths and hashes of the executed files against a whitelist of known good utilities. Consult application logs to determine if there are legitimate processes or tasks running that could account for the file renaming or relocation. Cross-reference the observed activity with recent user or system updates that might have caused legitimate changes. |
| T2 Analyst Actions | Conduct a deeper investigation including a binary analysis of the suspect files to determine if they have been altered or tampered with. Perform a timeline analysis of the hostâ€™s activity to establish any correlation or pattern with other known malicious activities. Analyze network traffic for potential communication with malicious domains that could indicate exfiltration activities. |
| Containment and Further Analysis | If malicious masquerading is confirmed, isolate the affected systems to prevent further spread or exfiltration. Use endpoint security tools to remediate the affected systems by removing or restoring altered files. Update detection and prevention measures to identify the same or similar tactics in the future. Document the findings and provide feedback to adjust policies for better detection and response capabilities. |
