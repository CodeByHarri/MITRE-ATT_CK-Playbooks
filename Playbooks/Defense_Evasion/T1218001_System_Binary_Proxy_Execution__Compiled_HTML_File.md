# System_Binary_Proxy_Execution:_Compiled_HTML_File - T1218001

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1218.001 |
| MITRE Sub-TTP | T1218.001 |
| Name | System Binary Proxy Execution: Compiled HTML File |
| Log Sources to Investigate | To investigate this TTP, focus on logs that can capture execution events and file integrity activities. Key logs include: <br>- Windows Event Logs, especially Security and Application logs (look for events related to process creation and suspicious executions involving hh.exe).<br>- File system access logs to trace access or the creation of .chm files.<br>- Network traffic logs if there is a possibility .chm files are being downloaded from the internet (focus on outbound connections from hh.exe).<br>- Application control or whitelisting solution logs that capture bypass or anomaly activities. |
| Key Indicators | Identify the following indicators which suggest this TTP is being exploited: <br>- Execution of hh.exe when there are no legitimate .chm help files being used.<br>- Creation or modification of .chm files in temporary directories or user directories.<br>- Persistent internet connections made by hh.exe.<br>- An uptick in application crashes or abnormal behavior around the time .chm files are executed. |
| Questions for Analysis | Tier 1 analysts should ask:<br>- Is there a legitimate need for .chm files on the affected system?<br>- Did the execution of hh.exe originate from a known and trusted source?<br>- Are there known vulnerabilities on the system that could allow for this vector?<br>- Have other systems reported similar activities that could suggest a wider campaign? |
| Decision for Escalation | Escalate to Tier 2 if:<br>- hh.exe was executed without a legitimate reason or associated with known malicious .chm files.<br>- Attempts to terminate hh.exe or any associated processes failed.<br>- There is correlated evidence showing the delivery of the .chm file via suspicious email or download.<br>- The behavior was observed on multiple systems simultaneously, indicating a potential broader threat. |
| Additional Analysis Steps for L1 | For Tier 1 analysts, complete the following:<br>- Cross-reference hh.exe executions with legitimate software usage or help file access.<br>- Check digital signatures of the .chm files and their origin.<br>- Monitor for repeated hh.exe invocations from unusual user accounts or contexts.<br>- Extract and review content within suspicious .chm files if possible using safe practices. |
| T2 Analyst Actions | Tier 2 analysts should:<br>- Deploy endpoint detection measures for further in-depth analysis of processes and network behavior.<br>- Perform a forensic analysis on suspicious .chm files, unpacking them to review embedded scripts.<br>- Review historical log data for signs of recurring attacks or any lateral movement attempts.<br>- Validate findings with threat intelligence sources to determine if this activity matches known campaigns or threat actors. |
| Containment and Further Analysis | To contain the threat:<br>- Isolate infected systems from the network to prevent further spread.<br>- Apply patches and updates immediately, especially those addressing hh.exe vulnerabilities (e.g., Microsoft CVE-2017-8625).<br>- Implement application control policies to prevent execution of unauthorized .chm files.<br>- Engage with affected users to educate and ensure no further user actions enable this vector.<br>- Use filtered firewalls and proxy settings to block known malicious URLs or IPs distributing harmful .chm files. |
