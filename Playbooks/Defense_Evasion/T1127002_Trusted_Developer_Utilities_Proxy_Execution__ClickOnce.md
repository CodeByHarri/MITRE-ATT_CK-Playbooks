# Trusted_Developer_Utilities_Proxy_Execution:_ClickOnce - T1127002

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1127.002 |
| MITRE Sub-TTP | T1127.002 |
| Name | Trusted Developer Utilities Proxy Execution: ClickOnce |
| Log Sources to Investigate | 1. Windows Application and System Event Logs: Look for events related to DFSVC.EXE execution as a child process which might indicate ClickOnce application launches or abnormal child process execution patterns.<br>2. Process Creation Logs: Monitor creation of DFSVC.EXE and any unusual commands or anomalies with rundll32.exe.<br>3. File Monitoring Logs: Document changes or additions to remote user startup folders for .appref-ms or .application files. 4. Network Traffic Logs: Records of HTTP/HTTPS requests to unusual or flagged domains that might host or serve ClickOnce applications. 5. Security Software Logs: Alerts or logs from EDR solutions recording unusual ClickOnce application behavior, privilege changes, or observed malware signatures. |
| Key Indicators | 1. Execution of DFSVC.EXE as a child process of unexpected applications.<br>2. Launch patterns of rundll32.exe with dfshim.dll, particularly with ShOpenVerbApplication1.<br>3. Unexpected or unauthorized .appref-ms and .application files in startup folders. 4. Web traffic to uncommon domains known for hosting ClickOnce packages. 5. Security alerts related to privilege escalation attempts or suspicious ClickOnce activity. |
| Questions for Analysis | 1. Was DFSVC.EXE executed from a known application or process context?<br>2. Are there any known safe-click associations for the domains and applications involved?<br>3. Is the execution of rundll32.exe consistent with legitimate application behavior? 4. Does the user have a legitimate requirement for running ClickOnce applications? 5. Are there any known security incidents related to ClickOnce within the organization? |
| Decision for Escalation | Escalate if: 1. DFSVC.EXE processes are linked to known malicious patterns or domains.<br>2. Unauthorized or unknown ClickOnce applications detected in sensitive areas like startup folders.<br>3. Presence of malware indicators associated with the observed domain or process executions. 4. Unusual user behavior indicating social engineering or phishing attempts. 5. Network traffic shows signs of communication with C2 servers. |
| Additional Analysis Steps for L1 | 1. Verify the source and legitimacy of the ClickOnce application; cross-reference known good applications lists.<br>2. Check process lineage for DFSVC.EXE anomalies.<br>3. Collect hash values of suspicious files and check for known malicious signatures. 4. Examine user activity logs for signs of phishing attempts. 5. Validate web activity logs for recent installations or accesses to malicious URLs. |
| T2 Analyst Actions | 1. Perform deep packet inspection on network traffic to identify any C2 communications.<br>2. Utilize dynamic analysis tools to execute suspicious ClickOnce files in a sandbox environment.<br>3. Conduct a thorough review of affected systems for indicators of persistence or additional compromise points. 4. Collaborate with incident response to gather intelligence on potentially linked threats. 5. Update detection and defense mechanisms based on collected threat intelligence and analysis findings. |
| Containment and Further Analysis | 1. Isolate affected systems from the network to prevent further broadcasting or lateral movement.<br>2. Use memory forensics to capture volatile data and analyze for in-memory indicators or implants.<br>3. Reverse engineer suspicious binaries to understand their capabilities and scope. 4. Clean affected startup folders and registry entries to remove unauthorized ClickOnce applications. 5. Roll out patches or updates to mitigate exploitation risks and improve security measurements against similar threats. |
