# Exfiltration_Over_C2_Channel - T1041

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Exfiltration |
| MITRE TTP | T1041 |
| MITRE Sub-TTP | T1041 |
| Name | Exfiltration Over C2 Channel |
| Log Sources to Investigate | Network traffic logs (e.g., packet capture data, traffic flow logs), firewall logs, intrusion detection system (IDS) alerts, web proxy logs, endpoint detection and response (EDR) logs, DNS logs. Examples include NetFlow data, Palo Alto firewall logs, Snort or Suricata alerts, McAfee EDR activity logs, and Bind DNS query logs. |
| Key Indicators | Unusual increase in outbound traffic on ports typically used for command and control, such as HTTP/S. Presence of outbound connections to known or suspicious IP addresses marked as C2 infrastructure. Data being sent in a way that resembles C2 communication patterns (e.g., regular intervals, using rare protocols like DNS tunneling). Spike in DNS queries correlating with potential data size. Use of encryption or obfuscation methods not typical for the user's profile. |
| Questions for Analysis | Are there records in the network traffic logs of large data transfers during off-peak hours? Is the external IP address listed in threat intelligence sources associated with C2 infrastructure? Do any users or endpoints demonstrate anomalous behavior patterns, such as unexpected connections to foreign or previously uncontacted networks? Are there any IDS alerts indicating suspicious data exfiltration activities around the same time frame? |
| Decision for Escalation | Escalate to Tier 2 if there is a confirmed data exfiltration attempt based on network behavior analysis, or if multiple independent indicators suggest alignment with known threat actor tactics. Also escalate if packet contents show signs of data exfiltration (e.g., large datasets, database or financial data, etc.), or if the external IP has been flagged multiple times. |
| Additional Analysis Steps for L1 | Verify the timestamps of suspicious network traffic against business hours and known maintenance windows. Cross-reference suspicious IP addresses with threat intelligence databases. Review related user or endpoint activity logs for any deviations from standard user models. Use sandbox environments to simulate identified C2 traffic patterns and review any potential data leaks. |
| T2 Analyst Actions | Conduct a deep packet inspection to analyze the contents of suspicious communications if possible. Correlate data transfer events with endpoint activity to ascertain the origin of the exfiltration. Engage in threat hunting to identify other systems potentially targeted by the same actor. Update threat intelligence feeds with any new C2 IP addresses identified. |
| Containment and Further Analysis | Isolate affected systems from the network to prevent further data exfiltration. Initiate a full forensic investigation on any compromised endpoints to determine the extent of data that may have been exfiltrated. Coordinate with legal and compliance teams to fulfill any regulatory requirements arising from the data breach. Implement and monitor enhanced network security measures such as stricter firewall rules and additional IDS signatures. |
