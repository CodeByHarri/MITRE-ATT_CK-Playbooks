# Command_and_Scripting_Interpreter:_Network_Device_CLI - T1059008

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Execution |
| MITRE TTP | T1059.008 |
| MITRE Sub-TTP | T1059.008 |
| Name | Command and Scripting Interpreter: Network Device CLI |
| Log Sources to Investigate | 1. Network device logs: Look for any unauthorized or unusual commands executed in the CLI, changes in configuration logs, or unexpected reboots/updates.<br>2. Authentication logs: Review logs for unexpected login attempts, especially from unfamiliar IP addresses or times outside normal business hours.<br>3. Network flow data: Identify unusual access patterns to CLI services like Telnet or SSH, including unexpected source IPs or anomalous traffic volumes.<br>4. Syslog: Configure network devices to export syslogs; look for alerts regarding configuration changes or critical warnings issued by the device. |
| Key Indicators | 1. Unrecognized user accounts executing high-privilege commands in the CLI.<br>2. Changes to device configurations without corresponding change management records.<br>3. Surge in failed login attempts or logins from unusual geographic locations.<br>4. Traffic redirection or manipulation incidents reported, potentially correlating with CLI access.<br>5. Disabling of logging or security features on network devices. |
| Questions for Analysis | 1. Are there any legitimate change management records or maintenance windows that align with these changes?<br>2. Was the access from a recognized user or known network location?<br>3. Have there been multiple failed login attempts before a successful one?<br>4. Was there any scheduled update or maintenance activity that could account for the configuration change?<br>5. Has there been any report of unusual network behavior or complaints from end-users? |
| Decision for Escalation | Escalate to Tier 2 if: 1. The user login performing critical changes cannot be verified as legitimate.<br>2. There is no documentation supporting the configuration changes observed.<br>3. Access was observed from anomalous source IPs or geographical locations.<br>4. Key network functions or security capabilities were altered without proper authorization.<br>5. Evidence suggests potential data interception or traffic manipulation. |
| Additional Analysis Steps for L1 | 1. Verify the list of authorized users with CLI access and compare against logs.<br>2. Cross-check change management records or IT service tickets.<br>3. Review historical access patterns to identify deviations or new devices connecting to CLI.<br>4. Reach out to network administratosr for confirmation regarding observed changes.<br>5. Monitor ongoing network activity for further suspicious access attempts. |
| T2 Analyst Actions | 1. Conduct a more in-depth forensic analysis of the network device, reviewing logs for root cause analysis.<br>2. Correlate this event with other suspicious activities in the environment.<br>3. Engage with IT and network teams to verify if a rollback or additional security measures are required.<br>4. Analyze the origin of suspicious connections for broader threat hunting across the network.<br>5. Recommend implementation of enhanced authentication mechanisms such as two-factor authentication (2FA) for CLI access. |
| Containment and Further Analysis | 1. Temporarily disable potentially compromised accounts or restrict their access.<br>2. Roll back unauthorized or suspicious configuration changes on devices.<br>3. Deploy monitoring to alert on similar activities, focusing on network traffic analysis.<br>4. Conduct a root cause analysis and trend over time to refine detection mechanisms.<br>5. If evidence of compromise is confirmed, initiate incident response actions including potential notification of affected parties and assessment of impact on operations. |
