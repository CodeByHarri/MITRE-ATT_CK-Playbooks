# Command_and_Scripting_Interpreter:_Cloud_API - T1059009

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Execution |
| MITRE TTP | T1059.009 |
| MITRE Sub-TTP | T1059.009 |
| Name | Command and Scripting Interpreter: Cloud API |
| Log Sources to Investigate | Investigate logs from cloud service providers such as AWS CloudTrail, Azure Activity Log, and Google Cloud's Cloud Audit Logs. These logs should capture details on API calls, including the origin of the request, the specific API endpoint being accessed, and any associated parameters. Additionally, examine logs from any cloud CLI tools, PowerShell command logs, or SDK usage logs for anomalies or unauthorized access patterns. Also, review IAM audit logs for any changes to permissions or unusual account activity. |
| Key Indicators | Key indicators include unusual or unauthorized API calls, particularly those originating from unknown IP addresses or unusual geographic locations. Look for API requests that attempt administrative actions such as creating or deleting large numbers of instances, modifying IAM roles or permissions, or tampering with security configurations. Unusual usage patterns in cloud shell environments or unexplained high volume usage of API services might also be indicative. |
| Questions for Analysis | Did the API call originate from an authorized IP address or geographic location? Are the credentials used for the action associated with valid user accounts, and do they correspond with the user's normal activity patterns? Is there a spike or abnormal pattern in API usage? Have there been any changes in user permissions or configurations closely preceding the event? |
| Decision for Escalation | Escalate to Tier 2 if there are indications of unauthorized access or if the API calls attempt critical actions such as changes in security policies or role permissions. Abnormal spikes in account usage, or when the source of API calls is unrecognized or untrusted, should prompt escalation. |
| Additional Analysis Steps for L1 | Validate the source of each suspicious API call against known authorized IP addresses and user access patterns. Cross-reference any credentials used with recent login attempts and access logs for anomalies. Check for simultaneous logins or access attempts from different locations that could indicate credential compromise. |
| T2 Analyst Actions | Conduct a deeper investigation into the account or system that initiated the API requests. Review any historical context around the IP address and scrutinize the access patterns for the involved account. If applicable, conduct threat hunting exercises focused on unusual command executions via the APIs for a broader perspective. Analyze any linked activities or log entries that could indicate the presence of layered tactics. |
| Containment and Further Analysis | Implement temporary containment measures by disabling suspicious accounts or API keys. Re-evaluate the configuration of IAM policies to ensure no permissions are excessively permissive. Conduct a thorough review of compromised resources and assess any potential impacts or data exposure. If malicious activity is confirmed, initiate a full incident response; this includes restoring affected resources, reinforcing security policies, and communicating findings to relevant stakeholders. |
