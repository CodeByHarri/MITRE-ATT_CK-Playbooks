# Shared_Modules - T1129

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Execution |
| MITRE TTP | T1129 |
| MITRE Sub-TTP | T1129 |
| Name | Shared Modules |
| Log Sources to Investigate | Collect logs from the following sources: <br>1. File System Monitoring: Track the creation, modification, and execution of shared modules such as DLLs on Windows and .so/.dylib files on macOS/Linux. <br>2. Process Execution Logs: Monitor process launches that load these shared modules, particularly via functions like `LoadLibrary`, `dlopen`, and `dlsym`. <br>3. Network Logs: Investigate any network communication that originating from processes executing shared modules, possibly indicating C2 communication. <br>4. Endpoint Detection and Response (EDR) tools: Use these to trace the loading of shared modules and any associated suspicious activities. <br>Examples: Windows Event Logs (Event ID 10 for process creation), Sysmon Logs for DLL loading (Event ID 7). |
| Key Indicators | 1. Uncommon DLLs or .so/.dylib files being loaded by processes. <br>2. DLLs or shared objects loaded from non-standard directories or network paths. <br>3. Newly created shared module files that were not present before. <br>4. Unusual strings or function calls being found in loaded shared modules. <br>5. Cross communication between loaded shared modules and external IPs that are not normally associated with business operations. |
| Questions for Analysis | 1. Is the shared module associated with known legitimate software, or does it coincide with common OS/API libraries? <br>2. Is there a history of similar shared module activities on the affected host? <br>3. Was the shared module creation/modification correlated with any known valid system updates? <br>4. Are there signs of tampering such as altered timestamps or mismatched hashes for shared modules? <br>5. Does network traffic from these modules reach suspicious or out-of-policy destinations? |
| Decision for Escalation | Escalate to Tier 2 if: <br>1. The shared module is identified as malicious or associated with known malware signatures. <br>2. The shared module usage is not justified by legitimate business processes and is originating from suspicious or unknown sources. <br>3. There's confirmed communication with known C2 domains or IPs. <br>4. The module tampering is detected with indicators suggesting compromise. |
| Additional Analysis Steps for L1 | 1. Verify the legitimacy of the shared module by checking against known software and whitelist repositories. <br>2. Examine the process tree to identify the parent process of the entity loading the shared module. <br>3. Correlate the creation or modification time of the shared module with other logged events such as user logins or network access. <br>4. Gather and document detailed metadata about the suspicious files, such as file hashes, sizes, and creation dates. |
| T2 Analyst Actions | 1. Conduct a deeper analysis of the shared module using static and dynamic analysis methods to determine its behavior. <br>2. Use threat intelligence sources to verify whether the shared module or its associated artifacts are related to known threats. <br>3. Review historical data to identify if the system has been communicating with suspicious IPs associated with C2 activity. <br>4. Collaborate with other response teams to assess the scope, ensuring to consider lateral movement or potential secondary payloads. |
| Containment and Further Analysis | 1. Isolate affected systems immediately to prevent further spread or data exfiltration. <br>2. Remove the malicious shared module and associated processes using automated tools or manual intervention. <br>3. Conduct forensic imaging of impacted systems for full offline analysis. <br>4. Update detection systems with new indicators of compromise and ensure compensating controls are in place, like monitoring known files or directories for unauthorized changes. <br>5. Report findings to all relevant stakeholders and update incident documentation to facilitate future response efforts. |
