# System_Binary_Proxy_Execution:_Msiexec - T1218007

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Defense Evasion |
| MITRE TTP | T1218.007 |
| MITRE Sub-TTP | T1218.007 |
| Name | System Binary Proxy Execution: Msiexec |
| Log Sources to Investigate | Monitor Windows Event Logs, specifically Event ID 4688 for new process creation that involves msiexec.exe. Check application and system logs for events related to msiexec.exe activity. Network traffic logs for any unusual outbound connections when msiexec.exe is executed, especially if connecting to unfamiliar or suspicious domains. Forensic analysis of MSI files via any logs generated by endpoint detection and response (EDR) tools and security information and event management (SIEM) platforms for instances where msiexec.exe executes DLLs or MSI files. |
| Key Indicators | Execution of msiexec.exe from unusual directories or with atypical command-line arguments, particularly those that execute from temporary folders or from network shares. Elevated msiexec.exe executions, especially where <code>AlwaysInstallElevated</code> policy is enabled. Network communications initiated by msiexec.exe to external IP addresses or domains, particularly toward known bad reputations or newly registered domains. Presence of msiexec.exe running where it is not expected, such as on a server where installation of software should be controlled and audited. |
| Questions for Analysis | Is msiexec.exe executing from a legitimate source or directory? Are there any accompanying signs of compromise, such as unusual user logons or privilege escalations? Is the system's <code>AlwaysInstallElevated</code> policy set, potentially escalating privileges? Are there any suspicious outbound connections following the msiexec.exe execution? Is the user associated with the process execution authorized to install or execute MSIs? |
| Decision for Escalation | Escalate to Tier 2 if msiexec.exe is executing with SYSTEM privileges without clear justification or authorization. If msiexec.exe is observed communicating with suspicious or known malicious domains/IPs. If there are concurrent indicators of compromise or evidence suggesting lateral movement or data exfiltration attempts. Escalate if there is evidence that the <code>AlwaysInstallElevated</code> policy is being exploited. |
| Additional Analysis Steps for L1 | Verify the origin of the msiexec.exe execution, including the user account and source directory. Check recent changes to the <code>AlwaysInstallElevated</code> policy. Review the command-line arguments used by msiexec.exe for irregularities. Correlate with other security alerts or events around the same timeframe for additional context. |
| T2 Analyst Actions | Perform deeper forensic analysis on the associated MSI or DLL files executed by msiexec.exe. Investigate the context under which msiexec.exe execution occurred, including user activity and network traffic anomalies. Cross-reference with threat intelligence to identify if the observed behavior aligns with known attack patterns. Consider live response actions such as examining system memory for additional malicious artefacts. |
| Containment and Further Analysis | If malicious activity is confirmed, isolate the affected host from the network to prevent further spread. Disable or revert any policy changes related to <code>AlwaysInstallElevated</code>. Examine potentially compromised user accounts and reset passwords as necessary. Conduct a full malware scan and restore the system to a known good state from backups if necessary. Document findings and update detection rules to prevent future exploitation via msiexec.exe. |
