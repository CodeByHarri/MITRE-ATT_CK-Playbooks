# Steal_Application_Access_Token - T1528

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Credential Access |
| MITRE TTP | T1528 |
| MITRE Sub-TTP | T1528 |
| Name | Steal Application Access Token |
| Log Sources to Investigate | To detect potential incidents involving T1528 - Steal Application Access Token, analysts should focus on logs from the following sources: <br>1. API Gateway logs: These logs may show unusual access patterns or requests to APIs using stolen tokens, specifically reviewing any failed or successful access attempts from unexpected IP addresses or at unusual times.<br>2. Cloud provider activity logs (e.g., AWS CloudTrail, Azure Activity Logs): Look for token generation and API calls associated with accounts that do not normally require such access.<br>3. Application logs: Monitor logs from applications that use or validate access tokens. Look for any irregular access attempts or token validation errors.<br>4. OAuth server logs: Check logs for new application registration processes that could indicate an adversary registering a malicious app.<br>5. CI/CD pipeline logs: Review authentication events and investigate any non-standard access patterns or token generations. |
| Key Indicators | 1. Unusual login patterns or use of access tokens originating from geolocations not typical for the user.<br>2. Multiple failed authentication attempts followed by a successful token generation request.<br>3. Access requests using OAuth tokens that do not match typical permission levels or resource access patterns for the user.<br>4. New application registrations or OAuth consent grants not initiated by the legitimate user.<br>5. Access tokens being used outside of the normal time windows for the user or service account. |
| Questions for Analysis | 1. Are there unusual access patterns in the API gateway logs that suggest unauthorized use of tokens?<br>2. Has there been any recent, unexpected application registration in the OAuth server logs?<br>3. Are there instances of access tokens being used from unusual locations or times?<br>4. Have the access permissions associated with tokens suddenly increased without the user's action?<br>5. Does the user recognize and validate all recent OAuth consent grant events for applications? |
| Decision for Escalation | Escalate to Tier 2 if the following conditions are met:<br>1. Evidence suggests token usage originating from atypical geolocations and times.<br>2. New application registrations in the OAuth server that the user cannot verify.<br>3. Detection of multiple unusual API access requests using the same token.<br>4. Anomalies in token usage that align with known techniques for privilege escalation or lateral movement. |
| Additional Analysis Steps for L1 | 1. Correlate access token usage with known legitimate application use patterns for the user or service.<br>2. Verify if there have been any OAuth applications recently registered by the user.<br>3. Cross-check abnormal API calls with internal whitelists or known good behaviors.<br>4. Validate any recent authorization logs for possibility of social engineering related consent grants. |
| T2 Analyst Actions | 1. Conduct a detailed review of token issuance events against company policies and the user's historical behavior.<br>2. Assess any related compromise indicators, such as phishing emails, and correlate with suspected token theft.<br>3. Analyze potential lateral movement resulting from the token's permissions.<br>4. Engage with IT staff to authenticate suspicious OAuth application registrations. |
| Containment and Further Analysis | 1. Immediately revoke stolen or suspicious access tokens to prevent misuse.<br>2. Work with cloud service providers to monitor and block any unauthorized API calls.<br>3. Enforce MFA on accounts showing suspicious activity or token theft.<br>4. Conduct a broader incident review to identify any additional compromised accounts or applications.<br>5. Educate affected users on identifying phishing attempts related to OAuth consent grants. |
