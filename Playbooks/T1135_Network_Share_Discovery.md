# Network_Share_Discovery - T1135

| Column Name | Value |
|-------------|-------|
| MITRE Tactic | Discovery |
| MITRE TTP | T1135 |
| MITRE Sub-TTP | T1135 |
| Name | Network Share Discovery |
| Log Sources to Investigate | Monitor network logs, especially those related to SMB traffic (e.g., firewall logs, network intrusion detection systems such as Zeek or Snort, and endpoint logs). Look for commands executed on systems, specifically 'net view \\remotesystem' and 'net share' on Windows as well as 'sharing -l' on macOS. Additionally, inspect Windows Event Logs for event IDs related to network share enumeration and access (e.g., Event ID 5140: A network share object was accessed). |
| Key Indicators | Unusual frequency or timing of SMB-related commands like 'net view' or 'net share'. Command execution by unexpected or unauthorized users, particularly from external IP addresses or user accounts with no prior history of such activity. Network anomalies, such as repeated access attempts to multiple shares, especially after failed authentication attempts. |
| Questions for Analysis | 1. Is the user account associated with the command known and expected to perform network share discovery?<br>2. Do the source and destination IP addresses align with typical patterns for the user's behavior?<br>3. Is there any existing history of the observed activity pattern for this account or IP? 4. Are there any recorded incidents of failed authentication attempts followed by successful network share discovery? |
| Decision for Escalation | Escalate if the network share discovery activity is performed by unauthorized or unexpected user accounts, originates from a suspicious IP address, or if there is a pattern of unusual frequency and timing in the activity. Escalate if there is evidence of prior failed authentication attempts followed by successful discoveries, indicative of potential brute-force attacks. |
| Additional Analysis Steps for L1 | Correlate the detected network share discovery activity with other suspicious behaviors, such as attempts to access sensitive or privileged shares. Check for immediate historical activity from the same account or IP, focusing on deviations from standard operational patterns. Verify whether the file sharing commands align with any legitimate business processes. |
| T2 Analyst Actions | Perform deeper packet inspection on the network traffic related to the detected shares. Assess whether there is legitimate business justification for the access to these shares. Review the broader context of the detected activity, such as any associated malware detections or anomalies in user behavior analytics. Engage with asset owners to validate whether the access was authorized. |
| Containment and Further Analysis | Temporarily disable access for suspected compromised accounts and change credentials if necessary. Isolate affected systems from the network if suspicious activity persists. Conduct further investigations to ascertain whether the discovery attempts were part of a larger campaign, such as lateral movement or data exfiltration efforts, and take appropriate remediation steps like patching vulnerabilities or adjusting access controls. |
